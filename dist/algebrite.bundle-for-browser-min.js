(()=>{var Hx=Object.create;var Rf=Object.defineProperty;var Qx=Object.getOwnPropertyDescriptor;var Wx=Object.getOwnPropertyNames;var Jx=Object.getPrototypeOf,Kx=Object.prototype.hasOwnProperty;var e0=e=>Rf(e,"__esModule",{value:!0});var A=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var t0=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Wx(t))!Kx.call(e,n)&&n!=="default"&&Rf(e,n,{get:()=>t[n],enumerable:!(r=Qx(t,n))||r.enumerable});return e},r0=e=>t0(e0(Rf(e!=null?Hx(Jx(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Mi=A((X$,Ou)=>{var Ft=function(e){"use strict";var t=1e7,r=7,n=9007199254740992,i=T(n),o="0123456789abcdefghijklmnopqrstuvwxyz",s=typeof BigInt=="function";function u(d,m,b,q){return typeof d=="undefined"?u[0]:typeof m!="undefined"?+m==10&&!b?qe(d):Zx(d,m,b,q):qe(d)}function c(d,m){this.value=d,this.sign=m,this.isSmall=!1}c.prototype=Object.create(u.prototype);function f(d){this.value=d,this.sign=d<0,this.isSmall=!0}f.prototype=Object.create(u.prototype);function _(d){this.value=d}_.prototype=Object.create(u.prototype);function w(d){return-n<d&&d<n}function T(d){return d<1e7?[d]:d<1e14?[d%1e7,Math.floor(d/1e7)]:[d%1e7,Math.floor(d/1e7)%1e7,Math.floor(d/1e14)]}function k(d){V(d);var m=d.length;if(m<4&&Vn(d,i)<0)switch(m){case 0:return 0;case 1:return d[0];case 2:return d[0]+d[1]*t;default:return d[0]+(d[1]+d[2]*t)*t}return d}function V(d){for(var m=d.length;d[--m]===0;);d.length=m+1}function Y(d){for(var m=new Array(d),b=-1;++b<d;)m[b]=0;return m}function Ae(d){return d>0?Math.floor(d):Math.ceil(d)}function tt(d,m){var b=d.length,q=m.length,O=new Array(b),x=0,P=t,L,U;for(U=0;U<q;U++)L=d[U]+m[U]+x,x=L>=P?1:0,O[U]=L-x*P;for(;U<b;)L=d[U]+x,x=L===P?1:0,O[U++]=L-x*P;return x>0&&O.push(x),O}function Ve(d,m){return d.length>=m.length?tt(d,m):tt(m,d)}function ke(d,m){var b=d.length,q=new Array(b),O=t,x,P;for(P=0;P<b;P++)x=d[P]-O+m,m=Math.floor(x/O),q[P]=x-m*O,m+=1;for(;m>0;)q[P++]=m%O,m=Math.floor(m/O);return q}c.prototype.add=function(d){var m=qe(d);if(this.sign!==m.sign)return this.subtract(m.negate());var b=this.value,q=m.value;return m.isSmall?new c(ke(b,Math.abs(q)),this.sign):new c(Ve(b,q),this.sign)},c.prototype.plus=c.prototype.add,f.prototype.add=function(d){var m=qe(d),b=this.value;if(b<0!==m.sign)return this.subtract(m.negate());var q=m.value;if(m.isSmall){if(w(b+q))return new f(b+q);q=T(Math.abs(q))}return new c(ke(q,Math.abs(b)),b<0)},f.prototype.plus=f.prototype.add,_.prototype.add=function(d){return new _(this.value+qe(d).value)},_.prototype.plus=_.prototype.add;function st(d,m){var b=d.length,q=m.length,O=new Array(b),x=0,P=t,L,U;for(L=0;L<q;L++)U=d[L]-x-m[L],U<0?(U+=P,x=1):x=0,O[L]=U;for(L=q;L<b;L++){if(U=d[L]-x,U<0)U+=P;else{O[L++]=U;break}O[L]=U}for(;L<b;L++)O[L]=d[L];return V(O),O}function Oe(d,m,b){var q;return Vn(d,m)>=0?q=st(d,m):(q=st(m,d),b=!b),q=k(q),typeof q=="number"?(b&&(q=-q),new f(q)):new c(q,b)}function at(d,m,b){var q=d.length,O=new Array(q),x=-m,P=t,L,U;for(L=0;L<q;L++)U=d[L]+x,x=Math.floor(U/P),U%=P,O[L]=U<0?U+P:U;return O=k(O),typeof O=="number"?(b&&(O=-O),new f(O)):new c(O,b)}c.prototype.subtract=function(d){var m=qe(d);if(this.sign!==m.sign)return this.add(m.negate());var b=this.value,q=m.value;return m.isSmall?at(b,Math.abs(q),this.sign):Oe(b,q,this.sign)},c.prototype.minus=c.prototype.subtract,f.prototype.subtract=function(d){var m=qe(d),b=this.value;if(b<0!==m.sign)return this.add(m.negate());var q=m.value;return m.isSmall?new f(b-q):at(q,Math.abs(b),b>=0)},f.prototype.minus=f.prototype.subtract,_.prototype.subtract=function(d){return new _(this.value-qe(d).value)},_.prototype.minus=_.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},f.prototype.negate=function(){var d=this.sign,m=new f(-this.value);return m.sign=!d,m},_.prototype.negate=function(){return new _(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},f.prototype.abs=function(){return new f(Math.abs(this.value))},_.prototype.abs=function(){return new _(this.value>=0?this.value:-this.value)};function ir(d,m){var b=d.length,q=m.length,O=b+q,x=Y(O),P=t,L,U,xe,Fe,Me;for(xe=0;xe<b;++xe){Fe=d[xe];for(var nt=0;nt<q;++nt)Me=m[nt],L=Fe*Me+x[xe+nt],U=Math.floor(L/P),x[xe+nt]=L-U*P,x[xe+nt+1]+=U}return V(x),x}function Gt(d,m){var b=d.length,q=new Array(b),O=t,x=0,P,L;for(L=0;L<b;L++)P=d[L]*m+x,x=Math.floor(P/O),q[L]=P-x*O;for(;x>0;)q[L++]=x%O,x=Math.floor(x/O);return q}function qr(d,m){for(var b=[];m-- >0;)b.push(0);return b.concat(d)}function It(d,m){var b=Math.max(d.length,m.length);if(b<=30)return ir(d,m);b=Math.ceil(b/2);var q=d.slice(b),O=d.slice(0,b),x=m.slice(b),P=m.slice(0,b),L=It(O,P),U=It(q,x),xe=It(Ve(O,q),Ve(P,x)),Fe=Ve(Ve(L,qr(st(st(xe,L),U),b)),qr(U,2*b));return V(Fe),Fe}function uo(d,m){return-.012*d-.012*m+15e-6*d*m>0}c.prototype.multiply=function(d){var m=qe(d),b=this.value,q=m.value,O=this.sign!==m.sign,x;if(m.isSmall){if(q===0)return u[0];if(q===1)return this;if(q===-1)return this.negate();if(x=Math.abs(q),x<t)return new c(Gt(b,x),O);q=T(x)}return uo(b.length,q.length)?new c(It(b,q),O):new c(ir(b,q),O)},c.prototype.times=c.prototype.multiply;function Zn(d,m,b){return d<t?new c(Gt(m,d),b):new c(ir(m,T(d)),b)}f.prototype._multiplyBySmall=function(d){return w(d.value*this.value)?new f(d.value*this.value):Zn(Math.abs(d.value),T(Math.abs(this.value)),this.sign!==d.sign)},c.prototype._multiplyBySmall=function(d){return d.value===0?u[0]:d.value===1?this:d.value===-1?this.negate():Zn(Math.abs(d.value),this.value,this.sign!==d.sign)},f.prototype.multiply=function(d){return qe(d)._multiplyBySmall(this)},f.prototype.times=f.prototype.multiply,_.prototype.multiply=function(d){return new _(this.value*qe(d).value)},_.prototype.times=_.prototype.multiply;function Ka(d){var m=d.length,b=Y(m+m),q=t,O,x,P,L,U;for(P=0;P<m;P++){L=d[P],x=0-L*L;for(var xe=P;xe<m;xe++)U=d[xe],O=2*(L*U)+b[P+xe]+x,x=Math.floor(O/q),b[P+xe]=O-x*q;b[P+m]=x}return V(b),b}c.prototype.square=function(){return new c(Ka(this.value),!1)},f.prototype.square=function(){var d=this.value*this.value;return w(d)?new f(d):new c(Ka(T(Math.abs(this.value))),!1)},_.prototype.square=function(d){return new _(this.value*this.value)};function Eu(d,m){var b=d.length,q=m.length,O=t,x=Y(m.length),P=m[q-1],L=Math.ceil(O/(2*P)),U=Gt(d,L),xe=Gt(m,L),Fe,Me,nt,Rr,Ar,Sf,wf;for(U.length<=b&&U.push(0),xe.push(0),P=xe[q-1],Me=b-q;Me>=0;Me--){for(Fe=O-1,U[Me+q]!==P&&(Fe=Math.floor((U[Me+q]*O+U[Me+q-1])/P)),nt=0,Rr=0,Sf=xe.length,Ar=0;Ar<Sf;Ar++)nt+=Fe*xe[Ar],wf=Math.floor(nt/O),Rr+=U[Me+Ar]-(nt-wf*O),nt=wf,Rr<0?(U[Me+Ar]=Rr+O,Rr=-1):(U[Me+Ar]=Rr,Rr=0);for(;Rr!==0;){for(Fe-=1,nt=0,Ar=0;Ar<Sf;Ar++)nt+=U[Me+Ar]-O+xe[Ar],nt<0?(U[Me+Ar]=nt+O,nt=0):(U[Me+Ar]=nt,nt=1);Rr+=nt}x[Me]=Fe}return U=el(U,L)[0],[k(x),k(U)]}function xu(d,m){for(var b=d.length,q=m.length,O=[],x=[],P=t,L,U,xe,Fe,Me;b;){if(x.unshift(d[--b]),V(x),Vn(x,m)<0){O.push(0);continue}U=x.length,xe=x[U-1]*P+x[U-2],Fe=m[q-1]*P+m[q-2],U>q&&(xe=(xe+1)*P),L=Math.ceil(xe/Fe);do{if(Me=Gt(m,L),Vn(Me,x)<=0)break;L--}while(L);O.push(L),x=st(x,Me)}return O.reverse(),[k(O),k(x)]}function el(d,m){var b=d.length,q=Y(b),O=t,x,P,L,U;for(L=0,x=b-1;x>=0;--x)U=L*O+d[x],P=Ae(U/m),L=U-P*m,q[x]=P|0;return[q,L|0]}function nn(d,m){var b,q=qe(m);if(s)return[new _(d.value/q.value),new _(d.value%q.value)];var O=d.value,x=q.value,P;if(x===0)throw new Error("Cannot divide by zero");if(d.isSmall)return q.isSmall?[new f(Ae(O/x)),new f(O%x)]:[u[0],d];if(q.isSmall){if(x===1)return[d,u[0]];if(x==-1)return[d.negate(),u[0]];var L=Math.abs(x);if(L<t){b=el(O,L),P=k(b[0]);var U=b[1];return d.sign&&(U=-U),typeof P=="number"?(d.sign!==q.sign&&(P=-P),[new f(P),new f(U)]):[new c(P,d.sign!==q.sign),new f(U)]}x=T(L)}var xe=Vn(O,x);if(xe===-1)return[u[0],d];if(xe===0)return[u[d.sign===q.sign?1:-1],u[0]];O.length+x.length<=200?b=Eu(O,x):b=xu(O,x),P=b[0];var Fe=d.sign!==q.sign,Me=b[1],nt=d.sign;return typeof P=="number"?(Fe&&(P=-P),P=new f(P)):P=new c(P,Fe),typeof Me=="number"?(nt&&(Me=-Me),Me=new f(Me)):Me=new c(Me,nt),[P,Me]}c.prototype.divmod=function(d){var m=nn(this,d);return{quotient:m[0],remainder:m[1]}},_.prototype.divmod=f.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(d){return nn(this,d)[0]},_.prototype.over=_.prototype.divide=function(d){return new _(this.value/qe(d).value)},f.prototype.over=f.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(d){return nn(this,d)[1]},_.prototype.mod=_.prototype.remainder=function(d){return new _(this.value%qe(d).value)},f.prototype.remainder=f.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(d){var m=qe(d),b=this.value,q=m.value,O,x,P;if(q===0)return u[1];if(b===0)return u[0];if(b===1)return u[1];if(b===-1)return m.isEven()?u[1]:u[-1];if(m.sign)return u[0];if(!m.isSmall)throw new Error("The exponent "+m.toString()+" is too large.");if(this.isSmall&&w(O=Math.pow(b,q)))return new f(Ae(O));for(x=this,P=u[1];q&!0&&(P=P.times(x),--q),q!==0;)q/=2,x=x.square();return P},f.prototype.pow=c.prototype.pow,_.prototype.pow=function(d){var m=qe(d),b=this.value,q=m.value,O=BigInt(0),x=BigInt(1),P=BigInt(2);if(q===O)return u[1];if(b===O)return u[0];if(b===x)return u[1];if(b===BigInt(-1))return m.isEven()?u[1]:u[-1];if(m.isNegative())return new _(O);for(var L=this,U=u[1];(q&x)===x&&(U=U.times(L),--q),q!==O;)q/=P,L=L.square();return U},c.prototype.modPow=function(d,m){if(d=qe(d),m=qe(m),m.isZero())throw new Error("Cannot take modPow with modulus 0");var b=u[1],q=this.mod(m);for(d.isNegative()&&(d=d.multiply(u[-1]),q=q.modInv(m));d.isPositive();){if(q.isZero())return u[0];d.isOdd()&&(b=b.multiply(q).mod(m)),d=d.divide(2),q=q.square().mod(m)}return b},_.prototype.modPow=f.prototype.modPow=c.prototype.modPow;function Vn(d,m){if(d.length!==m.length)return d.length>m.length?1:-1;for(var b=d.length-1;b>=0;b--)if(d[b]!==m[b])return d[b]>m[b]?1:-1;return 0}c.prototype.compareAbs=function(d){var m=qe(d),b=this.value,q=m.value;return m.isSmall?1:Vn(b,q)},f.prototype.compareAbs=function(d){var m=qe(d),b=Math.abs(this.value),q=m.value;return m.isSmall?(q=Math.abs(q),b===q?0:b>q?1:-1):-1},_.prototype.compareAbs=function(d){var m=this.value,b=qe(d).value;return m=m>=0?m:-m,b=b>=0?b:-b,m===b?0:m>b?1:-1},c.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var m=qe(d),b=this.value,q=m.value;return this.sign!==m.sign?m.sign?1:-1:m.isSmall?this.sign?-1:1:Vn(b,q)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,f.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var m=qe(d),b=this.value,q=m.value;return m.isSmall?b==q?0:b>q?1:-1:b<0!==m.sign?b<0?-1:1:b<0?1:-1},f.prototype.compareTo=f.prototype.compare,_.prototype.compare=function(d){if(d===1/0)return-1;if(d===-1/0)return 1;var m=this.value,b=qe(d).value;return m===b?0:m>b?1:-1},_.prototype.compareTo=_.prototype.compare,c.prototype.equals=function(d){return this.compare(d)===0},_.prototype.eq=_.prototype.equals=f.prototype.eq=f.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(d){return this.compare(d)!==0},_.prototype.neq=_.prototype.notEquals=f.prototype.neq=f.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(d){return this.compare(d)>0},_.prototype.gt=_.prototype.greater=f.prototype.gt=f.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(d){return this.compare(d)<0},_.prototype.lt=_.prototype.lesser=f.prototype.lt=f.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(d){return this.compare(d)>=0},_.prototype.geq=_.prototype.greaterOrEquals=f.prototype.geq=f.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(d){return this.compare(d)<=0},_.prototype.leq=_.prototype.lesserOrEquals=f.prototype.leq=f.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return(this.value[0]&1)==0},f.prototype.isEven=function(){return(this.value&1)==0},_.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return(this.value[0]&1)==1},f.prototype.isOdd=function(){return(this.value&1)==1},_.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},f.prototype.isPositive=function(){return this.value>0},_.prototype.isPositive=f.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},f.prototype.isNegative=function(){return this.value<0},_.prototype.isNegative=f.prototype.isNegative,c.prototype.isUnit=function(){return!1},f.prototype.isUnit=function(){return Math.abs(this.value)===1},_.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},f.prototype.isZero=function(){return this.value===0},_.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(d){var m=qe(d);return m.isZero()?!1:m.isUnit()?!0:m.compareAbs(2)===0?this.isEven():this.mod(m).isZero()},_.prototype.isDivisibleBy=f.prototype.isDivisibleBy=c.prototype.isDivisibleBy;function pu(d){var m=d.abs();if(m.isUnit())return!1;if(m.equals(2)||m.equals(3)||m.equals(5))return!0;if(m.isEven()||m.isDivisibleBy(3)||m.isDivisibleBy(5))return!1;if(m.lesser(49))return!0}function tl(d,m){for(var b=d.prev(),q=b,O=0,x,P,L,U;q.isEven();)q=q.divide(2),O++;e:for(L=0;L<m.length;L++)if(!d.lesser(m[L])&&(U=Ft(m[L]).modPow(q,d),!(U.isUnit()||U.equals(b)))){for(x=O-1;x!=0;x--){if(U=U.square().mod(d),U.isUnit())return!1;if(U.equals(b))continue e}return!1}return!0}c.prototype.isPrime=function(d){var m=pu(this);if(m!==e)return m;var b=this.abs(),q=b.bitLength();if(q<=64)return tl(b,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var O=Math.log(2)*q.toJSNumber(),x=Math.ceil(d===!0?2*Math.pow(O,2):O),P=[],L=0;L<x;L++)P.push(Ft(L+2));return tl(b,P)},_.prototype.isPrime=f.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(d,m){var b=pu(this);if(b!==e)return b;for(var q=this.abs(),O=d===e?5:d,x=[],P=0;P<O;P++)x.push(Ft.randBetween(2,q.minus(2),m));return tl(q,x)},_.prototype.isProbablePrime=f.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(d){for(var m=Ft.zero,b=Ft.one,q=qe(d),O=this.abs(),x,P,L;!O.isZero();)x=q.divide(O),P=m,L=q,m=b,q=O,b=P.subtract(x.multiply(b)),O=L.subtract(x.multiply(O));if(!q.isUnit())throw new Error(this.toString()+" and "+d.toString()+" are not co-prime");return m.compare(0)===-1&&(m=m.add(d)),this.isNegative()?m.negate():m},_.prototype.modInv=f.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var d=this.value;return this.sign?at(d,1,this.sign):new c(ke(d,1),this.sign)},f.prototype.next=function(){var d=this.value;return d+1<n?new f(d+1):new c(i,!1)},_.prototype.next=function(){return new _(this.value+BigInt(1))},c.prototype.prev=function(){var d=this.value;return this.sign?new c(ke(d,1),!0):at(d,1,this.sign)},f.prototype.prev=function(){var d=this.value;return d-1>-n?new f(d-1):new c(i,!0)},_.prototype.prev=function(){return new _(this.value-BigInt(1))};for(var on=[1];2*on[on.length-1]<=t;)on.push(2*on[on.length-1]);var co=on.length,Xn=on[co-1];function hu(d){return Math.abs(d)<=t}c.prototype.shiftLeft=function(d){var m=qe(d).toJSNumber();if(!hu(m))throw new Error(String(m)+" is too large for shifting.");if(m<0)return this.shiftRight(-m);var b=this;if(b.isZero())return b;for(;m>=co;)b=b.multiply(Xn),m-=co-1;return b.multiply(on[m])},_.prototype.shiftLeft=f.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(d){var m,b=qe(d).toJSNumber();if(!hu(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftLeft(-b);for(var q=this;b>=co;){if(q.isZero()||q.isNegative()&&q.isUnit())return q;m=nn(q,Xn),q=m[1].isNegative()?m[0].prev():m[0],b-=co-1}return m=nn(q,on[b]),m[1].isNegative()?m[0].prev():m[0]},_.prototype.shiftRight=f.prototype.shiftRight=c.prototype.shiftRight;function rl(d,m,b){m=qe(m);for(var q=d.isNegative(),O=m.isNegative(),x=q?d.not():d,P=O?m.not():m,L=0,U=0,xe=null,Fe=null,Me=[];!x.isZero()||!P.isZero();)xe=nn(x,Xn),L=xe[1].toJSNumber(),q&&(L=Xn-1-L),Fe=nn(P,Xn),U=Fe[1].toJSNumber(),O&&(U=Xn-1-U),x=xe[0],P=Fe[0],Me.push(b(L,U));for(var nt=b(q?1:0,O?1:0)!==0?Ft(-1):Ft(0),Rr=Me.length-1;Rr>=0;Rr-=1)nt=nt.multiply(Xn).add(Ft(Me[Rr]));return nt}c.prototype.not=function(){return this.negate().prev()},_.prototype.not=f.prototype.not=c.prototype.not,c.prototype.and=function(d){return rl(this,d,function(m,b){return m&b})},_.prototype.and=f.prototype.and=c.prototype.and,c.prototype.or=function(d){return rl(this,d,function(m,b){return m|b})},_.prototype.or=f.prototype.or=c.prototype.or,c.prototype.xor=function(d){return rl(this,d,function(m,b){return m^b})},_.prototype.xor=f.prototype.xor=c.prototype.xor;var nl=1<<30,If=(t&-t)*(t&-t)|nl;function ns(d){var m=d.value,b=typeof m=="number"?m|nl:typeof m=="bigint"?m|BigInt(nl):m[0]+m[1]*t|If;return b&-b}function Au(d,m){if(m.compareTo(d)<=0){var b=Au(d,m.square(m)),q=b.p,O=b.e,x=q.multiply(m);return x.compareTo(d)<=0?{p:x,e:O*2+1}:{p:q,e:O*2}}return{p:Ft(1),e:0}}c.prototype.bitLength=function(){var d=this;return d.compareTo(Ft(0))<0&&(d=d.negate().subtract(Ft(1))),d.compareTo(Ft(0))===0?Ft(0):Ft(Au(d,Ft(2)).e).add(Ft(1))},_.prototype.bitLength=f.prototype.bitLength=c.prototype.bitLength;function il(d,m){return d=qe(d),m=qe(m),d.greater(m)?d:m}function is(d,m){return d=qe(d),m=qe(m),d.lesser(m)?d:m}function jb(d,m){if(d=qe(d).abs(),m=qe(m).abs(),d.equals(m))return d;if(d.isZero())return m;if(m.isZero())return d;for(var b=u[1],q,O;d.isEven()&&m.isEven();)q=is(ns(d),ns(m)),d=d.divide(q),m=m.divide(q),b=b.multiply(q);for(;d.isEven();)d=d.divide(ns(d));do{for(;m.isEven();)m=m.divide(ns(m));d.greater(m)&&(O=m,m=d,d=O),m=m.subtract(d)}while(!m.isZero());return b.isUnit()?d:d.multiply(b)}function zx(d,m){return d=qe(d).abs(),m=qe(m).abs(),d.divide(jb(d,m)).multiply(m)}function Yx(d,m,b){d=qe(d),m=qe(m);var q=b||Math.random,O=is(d,m),x=il(d,m),P=x.subtract(O).add(1);if(P.isSmall)return O.add(Math.floor(q()*P));for(var L=ol(P,t).value,U=[],xe=!0,Fe=0;Fe<L.length;Fe++){var Me=xe?L[Fe]+(Fe+1<L.length?L[Fe+1]/t:0):t,nt=Ae(q()*Me);U.push(nt),nt<L[Fe]&&(xe=!1)}return O.add(u.fromArray(U,t,!1))}var Zx=function(d,m,b,q){b=b||o,d=String(d),q||(d=d.toLowerCase(),b=b.toLowerCase());var O=d.length,x,P=Math.abs(m),L={};for(x=0;x<b.length;x++)L[b[x]]=x;for(x=0;x<O;x++){var U=d[x];if(U!=="-"&&U in L&&L[U]>=P){if(U==="1"&&P===1)continue;throw new Error(U+" is not a valid digit in base "+m+".")}}m=qe(m);var xe=[],Fe=d[0]==="-";for(x=Fe?1:0;x<d.length;x++){var U=d[x];if(U in L)xe.push(qe(L[U]));else if(U==="<"){var Me=x;do x++;while(d[x]!==">"&&x<d.length);xe.push(qe(d.slice(Me+1,x)))}else throw new Error(U+" is not a valid character")}return zb(xe,m,Fe)};function zb(d,m,b){var q=u[0],O=u[1],x;for(x=d.length-1;x>=0;x--)q=q.add(d[x].times(O)),O=O.times(m);return b?q.negate():q}function Vx(d,m){return m=m||o,d<m.length?m[d]:"<"+d+">"}function ol(d,m){if(m=Ft(m),m.isZero()){if(d.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(m.equals(-1)){if(d.isZero())return{value:[0],isNegative:!1};if(d.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-d.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var b=Array.apply(null,Array(d.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return b.unshift([1]),{value:[].concat.apply([],b),isNegative:!1}}var q=!1;if(d.isNegative()&&m.isPositive()&&(q=!0,d=d.abs()),m.isUnit())return d.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(d.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:q};for(var O=[],x=d,P;x.isNegative()||x.compareAbs(m)>=0;){P=x.divmod(m),x=P.quotient;var L=P.remainder;L.isNegative()&&(L=m.minus(L).abs(),x=x.next()),O.push(L.toJSNumber())}return O.push(x.toJSNumber()),{value:O.reverse(),isNegative:q}}function Yb(d,m,b){var q=ol(d,m);return(q.isNegative?"-":"")+q.value.map(function(O){return Vx(O,b)}).join("")}c.prototype.toArray=function(d){return ol(this,d)},f.prototype.toArray=function(d){return ol(this,d)},_.prototype.toArray=function(d){return ol(this,d)},c.prototype.toString=function(d,m){if(d===e&&(d=10),d!==10)return Yb(this,d,m);for(var b=this.value,q=b.length,O=String(b[--q]),x="0000000",P;--q>=0;)P=String(b[q]),O+=x.slice(P.length)+P;var L=this.sign?"-":"";return L+O},f.prototype.toString=function(d,m){return d===e&&(d=10),d!=10?Yb(this,d,m):String(this.value)},_.prototype.toString=f.prototype.toString,_.prototype.toJSON=c.prototype.toJSON=f.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,f.prototype.valueOf=function(){return this.value},f.prototype.toJSNumber=f.prototype.valueOf,_.prototype.valueOf=_.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function Zb(d){if(w(+d)){var m=+d;if(m===Ae(m))return s?new _(BigInt(m)):new f(m);throw new Error("Invalid integer: "+d)}var b=d[0]==="-";b&&(d=d.slice(1));var q=d.split(/e/i);if(q.length>2)throw new Error("Invalid integer: "+q.join("e"));if(q.length===2){var O=q[1];if(O[0]==="+"&&(O=O.slice(1)),O=+O,O!==Ae(O)||!w(O))throw new Error("Invalid integer: "+O+" is not a valid exponent.");var x=q[0],P=x.indexOf(".");if(P>=0&&(O-=x.length-P-1,x=x.slice(0,P)+x.slice(P+1)),O<0)throw new Error("Cannot include negative exponent part for integers");x+=new Array(O+1).join("0"),d=x}var L=/^([0-9][0-9]*)$/.test(d);if(!L)throw new Error("Invalid integer: "+d);if(s)return new _(BigInt(b?"-"+d:d));for(var U=[],xe=d.length,Fe=r,Me=xe-Fe;xe>0;)U.push(+d.slice(Me,xe)),Me-=Fe,Me<0&&(Me=0),xe-=Fe;return V(U),new c(U,b)}function Xx(d){if(s)return new _(BigInt(d));if(w(d)){if(d!==Ae(d))throw new Error(d+" is not an integer.");return new f(d)}return Zb(d.toString())}function qe(d){return typeof d=="number"?Xx(d):typeof d=="string"?Zb(d):typeof d=="bigint"?new _(d):d}for(var fo=0;fo<1e3;fo++)u[fo]=qe(fo),fo>0&&(u[-fo]=qe(-fo));return u.one=u[1],u.zero=u[0],u.minusOne=u[-1],u.max=il,u.min=is,u.gcd=jb,u.lcm=zx,u.isInstance=function(d){return d instanceof c||d instanceof f||d instanceof _},u.randBetween=Yx,u.fromArray=function(d,m,b){return zb(d.map(qe),qe(m||10),b)},u}();typeof Ou!="undefined"&&Ou.hasOwnProperty("exports")&&(Ou.exports=Ft);typeof define=="function"&&define.amd&&define(function(){return Ft})});var Mu=A(os=>{"use strict";var n0=os&&os.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(os,"__esModule",{value:!0});os.mcmp=void 0;var H$=n0(Mi());function i0(e,t){return e.compare(t)}os.mcmp=i0});var or=A(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.findPossibleExponentialForm=Ti.findPossibleClockForm=Ti.Find=void 0;var Tu=Q(),o0=Ie(),Ht=N(),s0=$();function sl(e,t){if(o0.equal(e,t))return!0;if(Ht.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(sl(e.tensor.elem[r],t))return!0;return!1}return Ht.iscons(e)?[...e].some(r=>sl(r,t)):!1}Ti.Find=sl;function Lf(e,t){if(Tu.isimaginaryunit(e))return!1;if(Ht.ispower(e)&&!Tu.isinteger(Ht.caddr(t))&&sl(Ht.cadr(e),Ht.Constants.imaginaryunit)||Ht.ispower(e)&&Tu.equaln(Ht.cadr(e),-1)&&!Tu.isinteger(Ht.caddr(t)))return!0;if(Ht.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)if(Lf(e.tensor.elem[r],t))return!0;return!1}return Ht.iscons(e)?[...e].some(r=>Lf(r,t)):!1}Ti.findPossibleClockForm=Lf;function Cf(e){if(Ht.ispower(e)&&Ht.cadr(e)===s0.symbol(Ht.E))return sl(Ht.caddr(e),Ht.Constants.imaginaryunit);if(Ht.istensor(e)){for(let t=0;t<e.tensor.nelem;t++)if(Cf(e.tensor.elem[t]))return!0;return!1}return Ht.iscons(e)?[...e].some(Cf):!1}Ti.findPossibleExponentialForm=Cf});var Hb=A(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.set_component=ss.index_function=void 0;var Vb=St(),Pf=N(),xn=Ee(),Xb=j(),mo=qt();function a0(e,t){let{ndim:r}=e.tensor,n=t.length;n>r&&xn.stop("too many indices for tensor");let i=0;for(let u=0;u<n;u++){let c=Xb.nativeInt(t[u]);(c<1||c>e.tensor.dim[u])&&xn.stop("index out of range"),i=i*e.tensor.dim[u]+c-1}if(r===n)return e.tensor.elem[i];i=e.tensor.dim.slice(n).reduce((u,c)=>u*c,i);let o=e.tensor.dim.slice(n).reduce((u,c)=>u*c,1),s=Vb.alloc_tensor(o);s.tensor.ndim=r-n,s.tensor.dim=e.tensor.dim.slice(n);for(let u=0;u<o;u++)s.tensor.elem[u]=e.tensor.elem[i+u];return mo.check_tensor_dimensions(e),mo.check_tensor_dimensions(s),s}ss.index_function=a0;function l0(e,...t){t.length<2&&xn.stop("error in indexed assign");let[r,...n]=t;Pf.istensor(r)||xn.stop("error in indexed assign: assigning to something that is not a tensor");let{ndim:i}=r.tensor,o=n.length;o>i&&xn.stop("error in indexed assign");let s=0;for(let c=0;c<o;c++){let f=Xb.nativeInt(n[c]);(f<1||f>r.tensor.dim[c])&&xn.stop(`error in indexed assign
`),s=s*r.tensor.dim[c]+f-1}for(let c=o;c<i;c++)s=s*r.tensor.dim[c]+0;let u=Vb.alloc_tensor(r.tensor.nelem);if(u.tensor.ndim=r.tensor.ndim,u.tensor.dim=Array.from(r.tensor.dim),u.tensor.elem=Array.from(r.tensor.elem),mo.check_tensor_dimensions(r),mo.check_tensor_dimensions(u),r=u,i===o)return Pf.istensor(e)&&xn.stop("error in indexed assign"),r.tensor.elem[s]=e,mo.check_tensor_dimensions(r),r;Pf.istensor(e)||xn.stop("error in indexed assign"),i-o!==e.tensor.ndim&&xn.stop("error in indexed assign");for(let c=0;c<e.tensor.ndim;c++)r.tensor.dim[o+c]!==e.tensor.dim[c]&&xn.stop("error in indexed assign");for(let c=0;c<e.tensor.nelem;c++)r.tensor.elem[s+c]=e.tensor.elem[c];return mo.check_tensor_dimensions(r),mo.check_tensor_dimensions(e),r}ss.set_component=l0});var ee=A(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.makeList=void 0;var Qb=N(),u0=$();function c0(...e){let t=u0.symbol(Qb.NIL);for(let r=e.length-1;r>=0;r--)t=new Qb.Cons(e[r],t);return t}Nu.makeList=c0});var Df=A(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.Eval_function_reference=as.define_user_function=void 0;var Hn=N(),d0=Ee(),Iu=$(),f0=G(),m0=ee();function _0(e){let t=Hn.caadr(e),r=Hn.cdadr(e),n=Hn.caddr(e);return Hn.issymbol(t)||d0.stop("function name?"),Hn.car(n)===Iu.symbol(Hn.EVAL)&&(n=f0.Eval(Hn.cadr(n))),n=m0.makeList(Iu.symbol(Hn.FUNCTION),n,r),Iu.set_binding(t,n),Iu.symbol(Hn.NIL)}as.define_user_function=_0;function b0(e){return e}as.Eval_function_reference=b0});var Uf=A(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.lcm=ls.Eval_lcm=void 0;var Su=N(),Wb=G(),g0=_o(),kf=X();function y0(e){e=Su.cdr(e);let t=Wb.Eval(Su.car(e));return Su.iscons(e)&&(t=e.tail().reduce((r,n)=>Jb(r,Wb.Eval(n)),t)),t}ls.Eval_lcm=y0;function Jb(e,t){return Su.doexpand(v0,e,t)}ls.lcm=Jb;function v0(e,t){return kf.inverse(kf.divide(kf.divide(g0.gcd(e,t),e),t))}});var al=A(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.filter=us.Eval_filter=void 0;var q0=St(),Qn=N(),E0=or(),x0=ce(),Kb=G();function p0(e){e=Qn.cdr(e);let t=Kb.Eval(Qn.car(e));return Qn.iscons(e)&&(t=e.tail().reduce((r,n)=>wu(r,Kb.Eval(n)),t)),t}us.Eval_filter=p0;function wu(e,t){return h0(e,t)}us.filter=wu;function h0(e,t){return Qn.isadd(e)?A0(e,t):Qn.istensor(e)?O0(e,t):E0.Find(e,t)?Qn.Constants.zero:e}function A0(e,t){return Qn.iscons(e)?e.tail().reduce((r,n)=>x0.add(r,wu(n,t)),Qn.Constants.zero):Qn.Constants.zero}function O0(e,t){let r=e.tensor.nelem,n=q0.alloc_tensor(r);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(i=>wu(i,t)),n}});var Zr=A(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.subst=void 0;var M0=St(),bo=N(),T0=Ie(),N0=qt(),eg=$();function Ru(e,t,r){if(t===eg.symbol(bo.NIL)||r===eg.symbol(bo.NIL))return e;if(bo.istensor(e)){let n=M0.alloc_tensor(e.tensor.nelem);return n.tensor.ndim=e.tensor.ndim,n.tensor.dim=Array.from(e.tensor.dim),n.tensor.elem=e.tensor.elem.map(i=>{let o=Ru(i,t,r);return N0.check_tensor_dimensions(n),o}),n}return T0.equal(e,t)?r:bo.iscons(e)?new bo.Cons(Ru(bo.car(e),t,r),Ru(bo.cdr(e),t,r)):e}Lu.subst=Ru});var go=A(cs=>{"use strict";Object.defineProperty(cs,"__esModule",{value:!0});cs.coeff=cs.Eval_coeff=void 0;var Ni=N(),tg=$(),I0=Ie(),S0=ce(),Cu=G(),w0=al(),rg=X(),R0=Et(),L0=Zr();function C0(e){let t=Cu.Eval(Ni.cadddr(e)),r=Cu.Eval(Ni.caddr(e)),n=Cu.Eval(Ni.cadr(e));return t===tg.symbol(Ni.NIL)&&(t=r,r=tg.symbol(Ni.SYMBOL_X)),w0.filter(rg.divide(n,R0.power(r,t)),r)}cs.Eval_coeff=C0;function P0(e,t){let r=[];for(;;){let n=Cu.Eval(L0.subst(e,t,Ni.Constants.zero));if(r.push(n),e=S0.subtract(e,n),I0.equal(e,Ni.Constants.zero))return r;e=Ni.doexpand(rg.divide,e,t)}}cs.coeff=P0});var Pu=A(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.clockform=ds.Eval_clock=void 0;var ll=N(),D0=$(),ng=sn(),$f=fs(),k0=G(),U0=ee(),Bf=X(),$0=!1;function B0(e){return ig(k0.Eval(ll.cadr(e)))}ds.Eval_clock=B0;function ig(e){let t=U0.makeList(D0.symbol(ll.POWER),ll.Constants.negOne,Bf.divide($f.arg(e),ll.Constants.Pi())),r=Bf.multiply(ng.abs(e),t);return $0&&(console.log(`clockform: abs of ${e} : ${ng.abs(e)}`),console.log(`clockform: arg of ${e} : ${$f.arg(e)}`),console.log(`clockform: divide : ${Bf.divide($f.arg(e),ll.Constants.Pi())}`),console.log(`clockform: power : ${t}`),console.log(`clockform: multiply : ${r}`)),r}ds.clockform=ig});var Du=A(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.polar=ms.Eval_polar=void 0;var Gf=N(),G0=Ie(),F0=sn(),j0=fs(),z0=G(),og=X();function Y0(e){return sg(z0.Eval(Gf.cadr(e)))}ms.Eval_polar=Y0;function sg(e){return Gf.evalPolar(()=>og.multiply(F0.abs(e),G0.exponential(og.multiply(Gf.Constants.imaginaryunit,j0.arg(e)))))}ms.polar=sg});var yo=A(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.conjugate=_s.Eval_conj=void 0;var ku=N(),Z0=or(),V0=Pu(),ag=G(),X0=X(),H0=Du(),Q0=Zr();function W0(e){return e=ag.Eval(ku.cadr(e)),Z0.Find(e,ku.Constants.imaginaryunit)?Ff(e):V0.clockform(Ff(H0.polar(e)))}_s.Eval_conj=W0;function Ff(e){return ag.Eval(Q0.subst(e,ku.Constants.imaginaryunit,X0.negate(ku.Constants.imaginaryunit)))}_s.conjugate=Ff});var Vr=A(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.guess=void 0;var an=N(),ul=or(),ln=$();function J0(e){return ul.Find(e,ln.symbol(an.SYMBOL_X))?ln.symbol(an.SYMBOL_X):ul.Find(e,ln.symbol(an.SYMBOL_Y))?ln.symbol(an.SYMBOL_Y):ul.Find(e,ln.symbol(an.SYMBOL_Z))?ln.symbol(an.SYMBOL_Z):ul.Find(e,ln.symbol(an.SYMBOL_T))?ln.symbol(an.SYMBOL_T):ul.Find(e,ln.symbol(an.SYMBOL_S))?ln.symbol(an.SYMBOL_S):ln.symbol(an.SYMBOL_X)}Uu.guess=J0});var jf=A(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.msub=bs.madd=void 0;function K0(e,t){return e.add(t)}bs.madd=K0;function ep(e,t){return e.subtract(t)}bs.msub=ep});var ys=A(gs=>{"use strict";var tp=gs&&gs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gs,"__esModule",{value:!0});gs.mgcd=void 0;var rp=tp(Mi());function np(e,t){return rp.default.gcd(e,t)}gs.mgcd=np});var un=A(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.mdivrem=pn.mmod=pn.mdiv=pn.mmul=void 0;function ip(e,t){return e.multiply(t)}pn.mmul=ip;function op(e,t){return e.divide(t)}pn.mdiv=op;function sp(e,t){return e.mod(t)}pn.mmod=sp;function ap(e,t){let r=e.divmod(t);return[r.quotient,r.remainder]}pn.mdivrem=ap});var zf=A($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0});$u.mprime=void 0;function lp(e){return e.isProbablePrime()}$u.mprime=lp});var fg=A(qs=>{"use strict";var up=qs&&qs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qs,"__esModule",{value:!0});qs.factor_number=void 0;var cp=up(Mi()),Ii=N(),lg=Mu(),dp=Ee(),ug=$(),Si=j(),Yf=Q(),cg=ee(),dg=jf(),fp=ys(),vs=un(),mp=zf(),jt=cp.default(0);function _p(e){if(Yf.equaln(e,0)||Yf.equaln(e,1)||Yf.equaln(e,-1))return e;jt=e.q.a;let t=bp();return t.length==1?t[0]:cg.makeList(ug.symbol(Ii.MULTIPLY),...t)}qs.factor_number=_p;function bp(){let e=[];jt.isNegative()&&(jt=Si.setSignTo(jt,1),e.push(Ii.Constants.negOne));for(let t=0;t<1e4;t++)if(e.push(...gp(t)),jt.compare(1)===0)return e;return e.push(...yp()),e}function gp(e){let t=[],r,n=Si.mint(Ii.primetab[e]),i=0;for(;;){if(jt.compare(1)===0)return i&&t.push(cl(n,i)),t;let o;if([r,o]=Array.from(vs.mdivrem(jt,n)),o.isZero())i++,jt=r;else break}return i&&t.push(cl(n,i)),lg.mcmp(r,n)===-1&&(t.push(cl(jt,1)),jt=Si.mint(1)),t}function yp(){let e=[],t=Si.mint(1),r=Si.mint(5),n=Si.mint(2),i=1,o=1;for(;;){if(mp.mprime(jt))return e.push(cl(jt,1)),e;for(;;){Ii.defs.esc_flag&&dp.stop("esc");let s=dg.msub(n,r);s=Si.setSignTo(s,1);let u=fp.mgcd(s,jt);if(Ii.MEQUAL(u,1)){--i==0&&(n=r,o*=2,i=o),s=vs.mmul(r,r),r=dg.madd(s,t),s=vs.mmod(r,jt),r=s;continue}if(e.push(cl(u,1)),lg.mcmp(u,jt)===0)return e;s=vs.mdiv(jt,u),jt=s,s=vs.mmod(r,jt),r=s,s=vs.mmod(n,jt),n=s;break}}}function cl(e,t){let r=new Ii.Num(e);return t>1&&(r=cg.makeList(ug.symbol(Ii.POWER),r,new Ii.Num(Si.mint(t)))),r}});var dl=A(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.factor_small_number=wi.factor=wi.Eval_factor=void 0;var hn=N(),vp=Ee(),qp=$(),Zf=j(),Vf=G(),mg=Es(),Ep=Vr(),xp=Q(),pp=X(),hp=fg();function Ap(e){let t=Vf.Eval(hn.cadr(e)),r=Vf.Eval(hn.caddr(e)),n=r===qp.symbol(hn.NIL)?Ep.guess(t):r,i=bg(t,n);return e=hn.cdddr(e),hn.iscons(e)&&(i=[...e].reduce((o,s)=>Op(o,Vf.Eval(s)),i)),i}wi.Eval_factor=Ap;function Op(e,t){if(hn.ismultiply(e)){let n=[];return e.tail().forEach(i=>_g(n,i,t)),pp.multiply_all_noexpand(n)}let r=[];return _g(r,e,t),r[0]}function _g(e,t,r){let n=mg.factorpoly(t,r);if(hn.ismultiply(n)){e.push(...n.tail());return}e.push(n)}function bg(e,t){return xp.isinteger(e)?hp.factor_number(e):mg.factorpoly(e,t)}wi.factor=bg;function Mp(e){isNaN(e)&&vp.stop("number too big to factor");let t=[];e<0&&(e=-e);for(let r=0;r<hn.MAXPRIMETAB;r++){let n=hn.primetab[r];if(n>e/n)break;let i=0;for(;e%n==0;)e/=n,i++;i&&(t.push(Zf.integer(n)),t.push(Zf.integer(i)))}return e>1&&(t.push(Zf.integer(e)),t.push(hn.Constants.one)),t}wi.factor_small_number=Mp});var Hf=A(ps=>{"use strict";Object.defineProperty(ps,"__esModule",{value:!0});ps.ydivisors=ps.divisors=void 0;var Tp=_o(),Np=St(),Ue=N(),gg=Ie(),Ip=ce(),xs=j(),Bu=dl(),Sp=Q(),Xf=X(),wp=Et();function Rp(e){let t=yg(e),r=t.length;t.sort(gg.cmp_expr);let n=Np.alloc_tensor(r);return n.tensor.ndim=1,n.tensor.dim[0]=r,n.tensor.elem=t,n}ps.divisors=Rp;var Lp=e=>[].concat(...e);function yg(e){let t=[];if(Ue.isNumericAtom(e))t.push(...Bu.factor_small_number(xs.nativeInt(e)));else if(Ue.isadd(e))t.push(...Cp(e));else if(Ue.ismultiply(e)){if(e=Ue.cdr(e),Ue.isNumericAtom(Ue.car(e))&&(t.push(...Bu.factor_small_number(xs.nativeInt(Ue.car(e)))),e=Ue.cdr(e)),Ue.iscons(e)){let n=[...e].map(i=>Ue.ispower(i)?[Ue.cadr(i),Ue.caddr(i)]:[i,Ue.Constants.one]);t.push(...Lp(n))}}else Ue.ispower(e)?t.push(Ue.cadr(e),Ue.caddr(e)):t.push(e,Ue.Constants.one);let r=t.length;return t.push(Ue.Constants.one),vg(t,0,r),t.slice(r)}ps.ydivisors=yg;function vg(e,t,r){let n=e.pop();if(t===r){e.push(n);return}let i=e[t+0],o=e[t+1],s=xs.nativeInt(o);if(!isNaN(s))for(let u=0;u<=Math.abs(s);u++)e.push(Xf.multiply(n,wp.power(i,xs.integer(gg.sign(s)*u)))),vg(e,t+2,r)}function Cp(e){let t=Ue.iscons(e)?e.tail().reduce(Tp.gcd):Ue.car(e),r=[],n=t;if(Sp.isplusone(n))return r.push(e,Ue.Constants.one),r;if(Ue.isNumericAtom(n))r.push(...Bu.factor_small_number(xs.nativeInt(n)));else if(Ue.ismultiply(n)){let o=Ue.cdr(n);Ue.isNumericAtom(Ue.car(o))?r.push(...Bu.factor_small_number(xs.nativeInt(Ue.car(o)))):r.push(Ue.car(o),Ue.Constants.one),Ue.iscons(o)&&o.tail().forEach(s=>r.push(s,Ue.Constants.one))}else r.push(n,Ue.Constants.one);n=Xf.inverse(n);let i=Ue.iscons(e)?e.tail().reduce((o,s)=>Ip.add(o,Xf.multiply(n,s)),Ue.Constants.zero):Ue.cdr(e);return r.push(i,Ue.Constants.one),r}});var Gu=A(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.divpoly=As.Eval_quotient=void 0;var hs=N(),qg=$(),Eg=ce(),Pp=j(),xg=go(),Qf=G(),Wf=X(),Dp=Et();function kp(e){let t=Qf.Eval(hs.cadr(e)),r=Qf.Eval(hs.caddr(e)),n=Qf.Eval(hs.cadddr(e));return n===qg.symbol(hs.NIL)&&(n=qg.symbol(hs.SYMBOL_X)),pg(t,r,n)}As.Eval_quotient=kp;function pg(e,t,r){let n=xg.coeff(e,r),i=n.length-1,o=xg.coeff(t,r),s=o.length-1,u=i-s,c=hs.Constants.zero;for(;u>=0;){let f=Wf.divide(n[i],o[s]);for(let _=0;_<=s;_++)n[u+_]=Eg.subtract(n[u+_],Wf.multiply(o[_],f));c=Eg.add(c,Wf.multiply(f,Dp.power(r,Pp.integer(u)))),i--,u--}return c}As.divpoly=pg});var Wn=A(Ms=>{"use strict";Object.defineProperty(Ms,"__esModule",{value:!0});Ms.sine=Ms.Eval_sin=void 0;var Pt=N(),Fu=$(),Jf=ce(),zt=j(),hg=Ri(),Up=G(),Ag=Q(),Og=ee(),cn=X(),Os=Et();function $p(e){return fl(Up.Eval(Pt.cadr(e)))}Ms.Eval_sin=$p;function fl(e){return Pt.isadd(e)?Bp(e):Mg(e)}Ms.sine=fl;function Bp(e){let t=Pt.cdr(e);for(;Pt.iscons(t);){let r=Pt.car(t);if(Ag.isnpi(r)){let n=Jf.subtract(e,r);return Jf.add(cn.multiply(fl(n),hg.cosine(r)),cn.multiply(hg.cosine(n),fl(r)))}t=Pt.cdr(t)}return Mg(e)}function Mg(e){if(Pt.car(e)===Fu.symbol(Pt.ARCSIN))return Pt.cadr(e);if(Pt.isdouble(e)){let r=Math.sin(e.d);return Math.abs(r)<1e-10&&(r=0),zt.double(r)}if(Ag.isnegative(e))return cn.negate(fl(cn.negate(e)));if(Pt.car(e)===Fu.symbol(Pt.ARCTAN))return cn.multiply(Pt.cadr(e),Os.power(Jf.add(Pt.Constants.one,Os.power(Pt.cadr(e),zt.integer(2))),zt.rational(-1,2)));let t=zt.nativeInt(cn.divide(cn.multiply(e,zt.integer(180)),Pt.Constants.Pi()));if(t<0||isNaN(t))return Og.makeList(Fu.symbol(Pt.SIN),e);switch(t%360){case 0:case 180:return Pt.Constants.zero;case 30:case 150:return zt.rational(1,2);case 210:case 330:return zt.rational(-1,2);case 45:case 135:return cn.multiply(zt.rational(1,2),Os.power(zt.integer(2),zt.rational(1,2)));case 225:case 315:return cn.multiply(zt.rational(-1,2),Os.power(zt.integer(2),zt.rational(1,2)));case 60:case 120:return cn.multiply(zt.rational(1,2),Os.power(zt.integer(3),zt.rational(1,2)));case 240:case 300:return cn.multiply(zt.rational(-1,2),Os.power(zt.integer(3),zt.rational(1,2)));case 90:return Pt.Constants.one;case 270:return Pt.Constants.negOne;default:return Og.makeList(Fu.symbol(Pt.SIN),e)}}});var Ri=A(Ns=>{"use strict";Object.defineProperty(Ns,"__esModule",{value:!0});Ns.cosine=Ns.Eval_cos=void 0;var sr=N(),ju=$(),Kf=ce(),Yt=j(),Gp=G(),Tg=Q(),Ng=ee(),Jn=X(),Ts=Et(),Ig=Wn();function Fp(e){return zu(Gp.Eval(sr.cadr(e)))}Ns.Eval_cos=Fp;function zu(e){return sr.isadd(e)?jp(e):Sg(e)}Ns.cosine=zu;function jp(e){if(sr.iscons(e)){for(let t of e.tail())if(Tg.isnpi(t)){let r=Kf.subtract(e,t);return Kf.subtract(Jn.multiply(zu(r),zu(t)),Jn.multiply(Ig.sine(r),Ig.sine(t)))}}return Sg(e)}function Sg(e){if(sr.car(e)===ju.symbol(sr.ARCCOS))return sr.cadr(e);if(sr.isdouble(e)){let r=Math.cos(e.d);return Math.abs(r)<1e-10&&(r=0),Yt.double(r)}if(Tg.isnegative(e)&&(e=Jn.negate(e)),sr.car(e)===ju.symbol(sr.ARCTAN)){let r=Kf.add(sr.Constants.one,Ts.power(sr.cadr(e),Yt.integer(2)));return Ts.power(r,Yt.rational(-1,2))}let t=Yt.nativeInt(Jn.divide(Jn.multiply(e,Yt.integer(180)),sr.Constants.Pi()));if(t<0||isNaN(t))return Ng.makeList(ju.symbol(sr.COS),e);switch(t%360){case 90:case 270:return sr.Constants.zero;case 60:case 300:return Yt.rational(1,2);case 120:case 240:return Yt.rational(-1,2);case 45:case 315:return Jn.multiply(Yt.rational(1,2),Ts.power(Yt.integer(2),Yt.rational(1,2)));case 135:case 225:return Jn.multiply(Yt.rational(-1,2),Ts.power(Yt.integer(2),Yt.rational(1,2)));case 30:case 330:return Jn.multiply(Yt.rational(1,2),Ts.power(Yt.integer(3),Yt.rational(1,2)));case 150:case 210:return Jn.multiply(Yt.rational(-1,2),Ts.power(Yt.integer(3),Yt.rational(1,2)));case 0:return sr.Constants.one;case 180:return sr.Constants.negOne;default:return Ng.makeList(ju.symbol(sr.COS),e)}}});var ei=A(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.rect=Ss.Eval_rect=void 0;var _r=N(),Is=or(),Kn=$(),wg=sn(),em=ce(),vo=fs(),tm=Ri(),zp=G(),Yu=Q(),Yp=ee(),Zu=X(),Vu=Wn(),ml=!1;function Zp(e){return rm(zp.Eval(_r.cadr(e)))}Ss.Eval_rect=Zp;function rm(e){let t=e;if(ml&&(console.log(`RECT of ${t}`),console.log(`any clock forms in : ${t} ? ${Is.findPossibleClockForm(t,e)}`)),_r.issymbol(e))return ml&&console.log(` rect: simple symbol: ${t}`),Yu.isZeroAtomOrTensor(Kn.get_binding(Kn.symbol(_r.ASSUME_REAL_VARIABLES)))?Yp.makeList(Kn.symbol(_r.YYRECT),e):e;if(!Yu.isZeroAtomOrTensor(Kn.get_binding(Kn.symbol(_r.ASSUME_REAL_VARIABLES)))&&!Is.findPossibleExponentialForm(e)&&!Is.findPossibleClockForm(e,e)&&!(Is.Find(e,Kn.symbol(_r.SIN))&&Is.Find(e,Kn.symbol(_r.COS))&&Is.Find(e,_r.Constants.imaginaryunit)))return ml&&console.log(` rect: simple symbol: ${t}`),e;if(_r.ismultiply(e)&&Yu.isimaginaryunit(_r.cadr(e))&&!Yu.isZeroAtomOrTensor(Kn.get_binding(Kn.symbol(_r.ASSUME_REAL_VARIABLES))))return e;if(_r.isadd(e))return ml&&console.log(` rect - ${t} is a sum `),e.tail().reduce((n,i)=>em.add(n,rm(i)),_r.Constants.zero);let r=Zu.multiply(wg.abs(e),em.add(tm.cosine(vo.arg(e)),Zu.multiply(_r.Constants.imaginaryunit,Vu.sine(vo.arg(e)))));return ml&&(console.log(` rect - ${t} is NOT a sum `),console.log(` rect - ${t} abs: ${wg.abs(e)}`),console.log(` rect - ${t} arg of ${e} : ${e}`),console.log(` rect - ${t} cosine: ${tm.cosine(vo.arg(e))}`),console.log(` rect - ${t} sine: ${Vu.sine(vo.arg(e))}`),console.log(` rect - ${t} i * sine: ${Zu.multiply(_r.Constants.imaginaryunit,Vu.sine(vo.arg(e)))}`),console.log(` rect - ${t} cos + i * sine: ${em.add(tm.cosine(vo.arg(e)),Zu.multiply(_r.Constants.imaginaryunit,Vu.sine(vo.arg(e))))}`),console.log(`rect of ${t} : ${r}`)),r}Ss.rect=rm});var Es=A(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});Xu.factorpoly=void 0;var Vp=Uf(),we=N(),Xp=or(),Hp=Ee(),Qp=Ie(),An=ce(),Li=j(),Rg=go(),Lg=bl(),Wp=yo(),Jp=Mn(),Cg=Hf(),On=Q(),Mt=X(),ws=Et(),Kp=ti(),eh=Gu(),nm=ei();function th(e,t){return!Xp.Find(e,t)||!On.ispolyexpandedform(e,t)||!we.issymbol(t)?e:rh(e,t)}Xu.factorpoly=th;function rh(e,t){let r,n,i,o;On.isfloating(e)&&Hp.stop("floating point numbers in polynomial");let s=Rg.coeff(e,t),u=s.length-1,c=nh(s),f="real",_=null;for(;u>0;){var w,T;if(On.isZeroAtomOrTensor(s[0])?(r=we.Constants.one,n=we.Constants.zero):f==="real"?[T,r,n]=ih(s,u,t,r,n):f==="complex"&&([w,r]=oh(_,s,u)),f==="real")if(T===!1){f="complex";continue}else{for(i=An.add(Mt.multiply(r,t),n),we.DEBUG&&console.log(`success
FACTOR=${i}`),c=Mt.multiply_noexpand(c,i),sh(r,n,s,u);u&&On.isZeroAtomOrTensor(s[u]);)u--;let V=we.Constants.zero;for(let Y=0;Y<=u;Y++)V=An.add(V,Mt.multiply(s[Y],ws.power(t,Li.integer(Y))));_=V}else if(f==="complex"){if(w===!1)break;{let V=An.subtract(r,t),Y=An.subtract(Wp.conjugate(r),t);i=Mt.multiply(V,Y),we.DEBUG&&console.log(`success
FACTOR=${i}`);let Ae=c;if(c=Mt.multiply_noexpand(c,i),_==null){let Oe=we.Constants.zero;for(let at=0;at<=u;at++)Oe=An.add(Oe,Mt.multiply(s[at],ws.power(t,Li.integer(at))));_=Oe}let tt=t,Ve=i,ke=_;_=eh.divpoly(ke,Ve,tt);let st=Mt.multiply(_,i);if(!Qp.equal(st,ke))return we.DEBUG&&(console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),console.log(`so just returning previousFactorisation times dividend: ${Ae} * ${ke}`)),Mt.multiply_noexpand(Ae,we.noexpand(Lg.yycondense,ke));for(let Oe=0;Oe<=u;Oe++)s.pop();s.push(...Rg.coeff(_,t)),u-=2}}}let k=we.Constants.zero;for(let V=0;V<=u;V++)k=An.add(k,Mt.multiply(s[V],ws.power(t,Li.integer(V))));return e=k,we.DEBUG&&console.log(`POLY=${e}`),e=we.noexpand(Lg.yycondense,e),u>0&&On.isnegativeterm(s[u])&&(e=Mt.negate(e),c=Mt.negate_noexpand(c)),c=Mt.multiply_noexpand(c,e),we.DEBUG&&console.log(`RESULT=${c}`),c}function nh(e){let t=we.Constants.one;for(let r of e)t=Vp.lcm(Jp.denominator(r),t);for(let r=0;r<e.length;r++)e[r]=Mt.multiply(t,e[r]);return t=Mt.reciprocate(t),we.DEBUG&&console.log("rationalize_coefficients result"),t}function ih(e,t,r,n,i){let o,s,u;if(we.DEBUG){let _=we.Constants.zero;for(let w=0;w<=t;w++)_=An.add(_,Mt.multiply(e[w],ws.power(r,Li.integer(w))));o=_,console.log(`POLY=${o}`)}let c=Cg.ydivisors(e[t]),f=Cg.ydivisors(e[0]);if(we.DEBUG){console.log("divisors of base term");for(let _=0;_<f.length;_++)console.log(`, ${f[_]}`);console.log("divisors of leading term");for(let _=0;_<c.length;_++)console.log(`, ${c[_]}`)}for(let _=0;_<c.length;_++)for(let w=0;w<f.length;w++){if(n=c[_],i=f[w],s=Mt.negate(Mt.divide(i,n)),u=_l(s,e,t),we.DEBUG&&console.log(`try A=${n}
, B=${i}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),On.isZeroAtomOrTensor(u))return we.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,i];if(i=Mt.negate(i),s=Mt.negate(s),u=_l(s,e,t),we.DEBUG&&console.log(`try A=${n}
, B=${i}
, root ${r}
=-B/A=${s}
, POLY(${s}
)=${u}`),On.isZeroAtomOrTensor(u))return we.DEBUG&&console.log("get_factor_from_real_root returning true"),[!0,n,i]}return we.DEBUG&&console.log("get_factor_from_real_root returning false"),[!1,n,i]}function oh(e,t,r){let n,i,o,s;if(r<=2)return we.DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[!1,i];if(n=e,we.DEBUG&&console.log(`complex root finding for POLY=${n}`),i=nm.rect(ws.power(we.Constants.negOne,Li.rational(2,3))),we.DEBUG&&console.log(`complex root finding: trying with ${i}`),o=i,s=_l(o,t,r),we.DEBUG&&console.log(`complex root finding result: ${s}`),On.isZeroAtomOrTensor(s))return we.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,i];if(i=nm.rect(ws.power(we.Constants.one,Li.rational(2,3))),we.DEBUG&&console.log(`complex root finding: trying with ${i}`),o=i,s=_l(o,t,r),we.DEBUG&&console.log(`complex root finding result: ${s}`),On.isZeroAtomOrTensor(s))return we.DEBUG&&console.log("get_factor_from_complex_root returning true"),[!0,i];for(let u=-10;u<=10;u++)for(let c=1;c<=5;c++){i=nm.rect(An.add(Li.integer(u),Mt.multiply(Li.integer(c),we.Constants.imaginaryunit)));let _=_l(i,t,r);if(On.isZeroAtomOrTensor(_))return we.DEBUG&&console.log(`found complex root: ${_}`),[!0,i]}return we.DEBUG&&console.log("get_factor_from_complex_root returning false"),[!1,i]}function sh(e,t,r,n){let i=we.Constants.zero;for(let o=n;o>0;o--){let s=Mt.divide(r[o],e);r[o]=i,i=s,r[o-1]=An.subtract(r[o-1],Mt.multiply(i,t))}r[0]=i,we.DEBUG&&console.log("yydivpoly Q:")}function _l(e,t,r){let n=we.Constants.zero;for(let i=r;i>=0;i--)we.DEBUG&&(console.log("Evalpoly top of stack:"),console.log(Kp.print_list(n))),n=An.add(Mt.multiply(n,e),t[i]);return n}});var _o=A(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.areunivarpolysfactoredorexpandedform=Pi.gcd=Pi.Eval_gcd=void 0;var H=N(),Pg=$(),qo=Ie(),ah=ce(),lh=j(),Dg=G(),kg=Es(),im=Q(),Ug=ee(),Ci=X(),om=Et();function uh(e){e=H.cdr(e);let t=Dg.Eval(H.car(e));return H.iscons(e)&&(t=e.tail().reduce((r,n)=>ri(r,Dg.Eval(n)),t)),t}Pi.Eval_gcd=uh;function ri(e,t){return H.doexpand(ch,e,t)}Pi.gcd=ri;function ch(e,t){let r;return qo.equal(e,t)?e:H.isrational(e)&&H.isrational(t)?lh.gcd_numbers(e,t):(r=$g(e,t))?dh(e,t,r):H.isadd(e)&&H.isadd(t)?fh(e,t):(H.isadd(e)&&(e=Fg(e)),H.isadd(t)&&(t=Fg(t)),H.ismultiply(e)?mh(e,t):H.ismultiply(t)?_h(e,t):H.ismultiply(e)&&H.ismultiply(t)?Bg(e,t):Gg(e,t))}function $g(e,t){let r;if((r=im.isunivarpolyfactoredorexpandedform(e))&&im.isunivarpolyfactoredorexpandedform(t,r))return r}Pi.areunivarpolysfactoredorexpandedform=$g;function dh(e,t,r){return e=kg.factorpoly(e,r),t=kg.factorpoly(t,r),(H.ismultiply(e)||H.ismultiply(t))&&(H.ismultiply(e)||(e=Ug.makeList(Pg.symbol(H.MULTIPLY),e,H.Constants.one)),H.ismultiply(t)||(t=Ug.makeList(Pg.symbol(H.MULTIPLY),t,H.Constants.one))),H.ismultiply(e)&&H.ismultiply(t)?Bg(e,t):Gg(e,t)}function Bg(e,t){let r=H.cdr(e),n=H.cdr(t);if(H.iscons(r))return[...r].reduce((i,o)=>{if(H.iscons(n))return Ci.multiply(i,[...n].reduce((s,u)=>Ci.multiply(s,ri(o,u)),H.Constants.one))},H.Constants.one)}function Gg(e,t){let r,n,i;if(H.ispower(e)?(r=H.caddr(e),e=H.cadr(e)):r=H.Constants.one,H.ispower(t)?(n=H.caddr(t),t=H.cadr(t)):n=H.Constants.one,!qo.equal(e,t))return H.Constants.one;if(H.isNumericAtom(r)&&H.isNumericAtom(n)){let u=qo.lessp(r,n)?r:n;return om.power(e,u)}let o=Ci.divide(r,n);if(H.isNumericAtom(o)){o=H.ismultiply(r)&&H.isNumericAtom(H.cadr(r))?H.cadr(r):H.Constants.one,i=H.ismultiply(n)&&H.isNumericAtom(H.cadr(n))?H.cadr(n):H.Constants.one;let u=qo.lessp(o,i)?r:n;return om.power(e,u)}if(o=ah.subtract(r,n),!H.isNumericAtom(o))return H.Constants.one;let s=im.isnegativenumber(o)?r:n;return om.power(e,s)}function fh(e,t){let r,n,i,o;return qo.length(e)!==qo.length(t)?H.Constants.one:(r=H.iscons(e)?e.tail().reduce(ri):H.car(H.cdr(e)),n=H.iscons(t)?t.tail().reduce(ri):H.car(H.cdr(t)),i=Ci.divide(e,r),o=Ci.divide(t,n),qo.equal(i,o)?Ci.multiply(i,ri(r,n)):H.Constants.one)}function Fg(e){return H.iscons(e)?e.tail().reduce(ri):H.car(H.cdr(e))}function mh(e,t){return H.iscons(e)?e.tail().reduce((r,n)=>Ci.multiply(r,ri(n,t)),H.Constants.one):H.Constants.one}function _h(e,t){return H.iscons(t)?t.tail().reduce((r,n)=>Ci.multiply(r,ri(e,n)),H.Constants.one):H.Constants.one}});var bl=A(Di=>{"use strict";Object.defineProperty(Di,"__esModule",{value:!0});Di.yycondense=Di.Condense=Di.Eval_condense=void 0;var Hu=N(),bh=Ie(),gh=ce(),yh=G(),vh=_o(),sm=X();function qh(e){return jg(yh.Eval(Hu.cadr(e)))}Di.Eval_condense=qh;function jg(e){return Hu.noexpand(zg,e)}Di.Condense=jg;function zg(e){if(!Hu.isadd(e))return e;let t=e.tail().reduce(vh.gcd),r=sm.inverse(t),n=e.tail().reduce((o,s)=>gh.add(o,sm.multiply_noexpand(r,s)),Hu.Constants.zero),i=bh.yyexpand(n);return sm.divide(i,r)}Di.yycondense=zg});var gl=A(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});Ls.rationalize=Ls.Eval_rationalize=void 0;var ar=N(),Eh=ce(),xh=bl(),Yg=G(),ph=_o(),Zg=Q(),Rs=X(),hh=qt();function Ah(e){return am(Yg.Eval(ar.cadr(e)))}Ls.Eval_rationalize=Ah;function am(e){let t=ar.defs.expanding,r=Oh(e);return ar.defs.expanding=t,r}Ls.rationalize=am;function Oh(e){if(ar.istensor(e))return Th(e);if(ar.defs.expanding=!1,!ar.isadd(e))return e;let t=Mh(e),r=ar.Constants.zero;return ar.iscons(e)&&(r=e.tail().reduce((n,i)=>Eh.add(n,Rs.multiply(t,i)),r)),Rs.divide(xh.Condense(r),t)}function Mh(e){return ar.isadd(e)?e.tail().reduce((t,r)=>Vg(r,t),ar.Constants.one):Vg(e,ar.Constants.one)}function Vg(e,t){return ar.ismultiply(e)?e.tail().reduce((r,n)=>Xg(n,r),t):Xg(e,t)}function Xg(e,t){if(!ar.ispower(e))return t;let r=e;return e=ar.caddr(e),Zg.isnegativenumber(e)||ar.ismultiply(e)&&Zg.isnegativenumber(ar.cadr(e))?Hg(t,Rs.inverse(r)):t}function Th(e){return e=Yg.Eval(e),ar.istensor(e)&&(e.tensor.elem=e.tensor.elem.map(am),hh.check_tensor_dimensions(e)),e}function Hg(e,t){return Rs.divide(Rs.multiply(e,t),ph.gcd(e,t))}});var Mn=A(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.denominator=Cs.Eval_denominator=void 0;var ni=N(),Nh=j(),Ih=G(),Qg=Q(),Wg=X(),Sh=gl();function wh(e){return lm(Ih.Eval(ni.cadr(e)))}Cs.Eval_denominator=wh;function lm(e){return ni.isadd(e)&&(e=Sh.rationalize(e)),ni.ismultiply(e)&&!Qg.isplusone(ni.car(ni.cdr(e)))?Wg.multiply_all(e.tail().map(lm)):ni.isrational(e)?Nh.mp_denominator(e):ni.ispower(e)&&Qg.isnegativeterm(ni.caddr(e))?Wg.reciprocate(e):ni.Constants.one}Cs.denominator=lm});var oi=A(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.numerator=Ps.Eval_numerator=void 0;var ii=N(),Rh=j(),Lh=G(),Jg=Q(),Ch=X(),Ph=gl();function Dh(e){return um(Lh.Eval(ii.cadr(e)))}Ps.Eval_numerator=Dh;function um(e){return ii.isadd(e)&&(e=Ph.rationalize(e)),ii.ismultiply(e)&&!Jg.isplusone(ii.car(ii.cdr(e)))?Ch.multiply_all(e.tail().map(um)):ii.isrational(e)?Rh.mp_numerator(e):ii.ispower(e)&&Jg.isnegativeterm(ii.caddr(e))?ii.Constants.one:e}Ps.numerator=um});var dm=A(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.arctan=Ds.Eval_arctan=void 0;var pe=N(),Kg=or(),Eo=$(),kh=Ie(),Qu=j(),Uh=Mn(),$h=G(),Tn=Q(),Bh=ee(),yl=X(),Gh=oi();function Fh(e){return cm($h.Eval(pe.cadr(e)))}Ds.Eval_arctan=Fh;function cm(e){if(pe.car(e)===Eo.symbol(pe.TAN))return pe.cadr(e);if(pe.isdouble(e))return Qu.double(Math.atan(e.d));if(Tn.isZeroAtomOrTensor(e))return pe.Constants.zero;if(Tn.isnegative(e))return yl.negate(cm(yl.negate(e)));if(Kg.Find(e,Eo.symbol(pe.SIN))&&Kg.Find(e,Eo.symbol(pe.COS))){let t=Gh.numerator(e),r=Uh.denominator(e);if(pe.car(t)===Eo.symbol(pe.SIN)&&pe.car(r)===Eo.symbol(pe.COS)&&kh.equal(pe.cadr(t),pe.cadr(r)))return pe.cadr(t)}return pe.ispower(e)&&Tn.equaln(pe.cadr(e),3)&&Tn.equalq(pe.caddr(e),-1,2)||pe.ismultiply(e)&&Tn.equalq(pe.car(pe.cdr(e)),1,3)&&pe.car(pe.car(pe.cdr(pe.cdr(e))))===Eo.symbol(pe.POWER)&&Tn.equaln(pe.car(pe.cdr(pe.car(pe.cdr(pe.cdr(e))))),3)&&Tn.equalq(pe.car(pe.cdr(pe.cdr(pe.car(pe.cdr(pe.cdr(e)))))),1,2)?yl.multiply(Qu.rational(1,6),pe.Constants.Pi()):Tn.equaln(e,1)?yl.multiply(Qu.rational(1,4),pe.Constants.Pi()):pe.ispower(e)&&Tn.equaln(pe.cadr(e),3)&&Tn.equalq(pe.caddr(e),1,2)?yl.multiply(Qu.rational(1,3),pe.Constants.Pi()):Bh.makeList(Eo.symbol(pe.ARCTAN),e)}Ds.arctan=cm});var vl=A(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.imag=ks.Eval_imag=void 0;var ey=N(),jh=ce(),zh=j(),Yh=yo(),Zh=G(),ty=X(),Vh=ei(),Xh=!1;function Hh(e){return ry(Zh.Eval(ey.cadr(e)))}ks.Eval_imag=Hh;function ry(e){let t=Vh.rect(e),r=Yh.conjugate(t),n=ty.divide(jh.subtract(t,r),zh.integer(2)),i=ty.divide(n,ey.Constants.imaginaryunit);return Xh&&(console.log(`IMAGE of ${t}`),console.log(` image: conjugate result: ${r}`),console.log(` image: 1st divide result: ${n}`),console.log(` image: 2nd divide result: ${i}`)),i}ks.imag=ry});var $s=A(Us=>{"use strict";Object.defineProperty(Us,"__esModule",{value:!0});Us.real=Us.Eval_real=void 0;var Qh=N(),Wh=ce(),Jh=j(),Kh=yo(),e2=G(),t2=X(),r2=ei();function n2(e){return ny(e2.Eval(Qh.cadr(e)))}Us.Eval_real=n2;function ny(e){let t=r2.rect(e);return t2.divide(Wh.add(t,Kh.conjugate(t)),Jh.integer(2))}Us.real=ny});var fs=A(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.arg=Bs.Eval_arg=void 0;var je=N(),xo=$(),Wu=ce(),i2=dm(),o2=Mn(),s2=G(),iy=vl(),si=Q(),oy=ee(),ql=X(),a2=oi(),l2=$s(),u2=ei(),c2=!1;function d2(e){return Ju(s2.Eval(je.cadr(e)))}Bs.Eval_arg=d2;function Ju(e){return Wu.subtract(sy(a2.numerator(e)),sy(o2.denominator(e)))}Bs.arg=Ju;function sy(e){if(si.ispositivenumber(e)||e===xo.symbol(je.PI))return je.isdouble(e)||je.defs.evaluatingAsFloats?je.Constants.zeroAsDouble:je.Constants.zero;if(si.isnegativenumber(e)){let t=je.isdouble(e)||je.defs.evaluatingAsFloats?je.Constants.piAsDouble:xo.symbol(je.PI);return ql.negate(t)}if(je.issymbol(e))return oy.makeList(xo.symbol(je.ARG),e);if(je.ispower(e)&&si.equaln(je.cadr(e),-1))return ql.multiply(je.Constants.Pi(),je.caddr(e));if(je.ispower(e)&&je.cadr(e)===xo.symbol(je.E))return iy.imag(je.caddr(e));if(je.ispower(e)&&si.isoneovertwo(je.caddr(e))){let t=Ju(je.cadr(e));return c2&&(console.log(`arg of a sqrt: ${e}`),je.breakpoint,console.log(` = 1/2 * ${t}`)),ql.multiply(t,je.caddr(e))}if(je.ismultiply(e))return e.tail().map(Ju).reduce(Wu.add,je.Constants.zero);if(je.isadd(e)){e=u2.rect(e);let t=l2.real(e),r=iy.imag(e);if(si.isZeroAtomOrTensor(t))return si.isnegative(r)?ql.negate(je.Constants.Pi()):je.Constants.Pi();{let n=i2.arctan(ql.divide(r,t));return si.isnegative(t)?si.isnegative(r)?Wu.subtract(n,je.Constants.Pi()):Wu.add(n,je.Constants.Pi()):n}}return si.isZeroAtomOrTensor(xo.get_binding(xo.symbol(je.ASSUME_REAL_VARIABLES)))?oy.makeList(xo.symbol(je.ARG),e):je.Constants.zero}});var ay=A(Ku=>{"use strict";Object.defineProperty(Ku,"__esModule",{value:!0});Ku.dpow=void 0;var f2=N(),m2=Ee(),_2=ce(),fm=j(),b2=X();function g2(e,t){if(e===0&&t<0&&m2.stop("divide by zero"),e>=0||t%1==0)return fm.double(Math.pow(e,t));let r=Math.pow(Math.abs(e),t),n=Math.PI*t,i=0,o=0;return t%.5==0?(i=0,o=Math.sin(n)):(i=Math.cos(n),o=Math.sin(n)),_2.add(fm.double(i*r),b2.multiply(fm.double(o*r),f2.Constants.imaginaryunit))}Ku.dpow=g2});var po=A(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.factorial=void 0;var y2=N(),wB=Ie(),RB=ce(),ly=j(),v2=ee(),LB=X(),CB=Et(),q2=$();function E2(e){let t=ly.nativeInt(e);return t<0||isNaN(t)?v2.makeList(q2.symbol(y2.FACTORIAL),e):ly.bignum_factorial(t)}ec.factorial=E2});var rc=A(tc=>{"use strict";Object.defineProperty(tc,"__esModule",{value:!0});tc.mpow=void 0;function x2(e,t){return e.pow(t)}tc.mpow=x2});var uy=A(Gs=>{"use strict";var p2=Gs&&Gs.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.mroot=void 0;var nc=p2(Mi()),h2=Mu(),A2=Ee(),O2=j(),M2=rc();function T2(e,t){e=e.abs(),t===0&&A2.stop("root index is zero");let r=0;for(;e.shiftRight(r).toJSNumber()>0;)r++;if(r===0)return O2.mint(0);r=Math.floor((r-1)/t);let n=Math.floor(r/32+1),i=nc.default(n);for(let o=0;o<n;o++)i=i.and(nc.default(1).shiftLeft(o).not());for(;r>=0;){i=i.or(nc.default(1).shiftLeft(r));let o=M2.mpow(i,t);switch(h2.mcmp(o,e)){case 0:return i;case 1:i=i.and(nc.default(1).shiftLeft(r).not());break}r--}return 0}Gs.mroot=T2});var by=A(Fs=>{"use strict";Object.defineProperty(Fs,"__esModule",{value:!0});Fs.quickpower=Fs.quickfactor=void 0;var cy=N(),N2=ce(),ic=j(),I2=dl(),S2=Q(),dy=ee(),fy=X(),my=$();function w2(e,t){let r=I2.factor_small_number(ic.nativeInt(e)),n=r.length;for(let i=0;i<n;i+=2)r.push(..._y(r[i],fy.multiply(r[i+1],t)));return fy.multiply_all(r.slice(n))}Fs.quickfactor=w2;function _y(e,t){let r=ic.bignum_truncate(t),n=N2.subtract(t,r),i;S2.isZeroAtomOrTensor(n)||(i=dy.makeList(my.symbol(cy.POWER),e,n));let o=ic.nativeInt(r);if(isNaN(o)){let u=dy.makeList(my.symbol(cy.POWER),e,r);return i?[i,u]:[u]}if(o===0)return[i];let s=ic.bignum_power_number(e,o);return i?[i,s]:[s]}Fs.quickpower=_y});var yy=A(js=>{"use strict";var R2=js&&js.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(js,"__esModule",{value:!0});js.qpow=void 0;var L2=R2(Mi()),Er=N(),C2=Ee(),gy=ce(),ai=j(),Lr=Q(),oc=ee(),mm=rc(),P2=uy(),El=X(),D2=by(),sc=$();function xl(e,t){return k2(e,t)}js.qpow=xl;function k2(e,t){if(Lr.isplusone(e)||Lr.isZeroAtomOrTensor(t))return Er.Constants.one;if(Lr.isminusone(e)&&Lr.isoneovertwo(t))return Er.Constants.imaginaryunit;if(Lr.isZeroAtomOrTensor(e))return Lr.isnegativenumber(t)&&C2.stop("divide by zero"),Er.Constants.zero;if(Lr.isplusone(t))return e;let r=0,n,i;if(Lr.isinteger(t)){if(r=ai.nativeInt(t),isNaN(r))return oc.makeList(sc.symbol(Er.POWER),e,t);if(n=mm.mpow(e.q.a,Math.abs(r)),i=mm.mpow(e.q.b,Math.abs(r)),r<0){let u=n;n=i,i=u,n=ai.makeSignSameAs(n,i),i=ai.makePositive(i)}return new Er.Num(n,i)}if(Lr.isminusone(e))return U2(t);if(Lr.isnegativenumber(e))return El.multiply(xl(El.negate(e),t),xl(Er.Constants.negOne,t));if(!Lr.isinteger(e))return El.multiply(xl(ai.mp_numerator(e),t),xl(ai.mp_denominator(e),El.negate(t)));if($2(e))return D2.quickfactor(e,t);if(!ai.isSmall(t.q.a)||!ai.isSmall(t.q.b))return oc.makeList(sc.symbol(Er.POWER),e,t);let{a:o,b:s}=t.q;return n=P2.mroot(e.q.a,s.toJSNumber()),n===0?oc.makeList(sc.symbol(Er.POWER),e,t):(i=mm.mpow(n,o),t.q.a.isNegative()?new Er.Num(L2.default.one,i):new Er.Num(i))}function U2(e){if(Lr.isinteger(e))return e.q.a.isOdd()?Er.Constants.negOne:Er.Constants.one;let t=ai.bignum_truncate(e);Lr.isnegativenumber(e)&&(t=gy.add(t,Er.Constants.negOne));let r=gy.subtract(e,t),n=oc.makeList(sc.symbol(Er.POWER),Er.Constants.negOne,r);return t.q.a.isOdd()&&(n=El.negate(n)),n}function $2(e){return ai.isSmall(e.q.a)}});var Et=A(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.power=Ys.Eval_power=void 0;var B=N(),ac=or(),Zt=$(),pl=Ie(),vy=sn(),lc=ce(),B2=fs(),Or=j(),G2=yo(),F2=Ri(),j2=ay(),qy=G(),Ey=po(),pt=Q(),zs=ee(),Qt=X(),z2=yy(),xy=ei(),Y2=Wn(),Z2=qt(),Je=!1;function V2(e){Je&&B.breakpoint;let t=qy.Eval(B.cadr(e)),r=qy.Eval(B.caddr(e));return Mr(t,r)}Ys.Eval_power=V2;function Mr(e,t){return X2(e,t)}Ys.power=Mr;function X2(e,t){Je&&B.breakpoint;let r=t,n=e;if(Je&&console.log(`POWER: ${e} ^ ${t}`),pl.equal(e,B.Constants.one)||pt.isZeroAtomOrTensor(t)){let f=B.Constants.One();return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}if(pl.equal(t,B.Constants.one))return Je&&console.log(`   power of ${n} ^ ${r}: ${e}`),e;if(pt.isminusone(e)&&pt.isminusone(t)){let f=Qt.negate(B.Constants.One());return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}if(pt.isminusone(e)&&pt.isoneovertwo(t)){let f=B.Constants.imaginaryunit;return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}if(pt.isminusone(e)&&pt.isminusoneovertwo(t)){let f=Qt.negate(B.Constants.imaginaryunit);return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}let i;if(pt.isminusone(e)&&!B.isdouble(e)&&B.isrational(t)&&!pt.isinteger(t)&&pt.ispositivenumber(t)&&!B.defs.evaluatingAsFloats){Je&&(console.log("   power: -1 ^ rational"),console.log(` trick: exponent.q.a , exponent.q.b ${t.q.a} , ${t.q.b}`)),t.q.a<t.q.b?i=zs.makeList(Zt.symbol(B.POWER),e,t):(i=zs.makeList(Zt.symbol(B.MULTIPLY),e,zs.makeList(Zt.symbol(B.POWER),e,Or.rational(t.q.a.mod(t.q.b),t.q.b))),Je&&console.log(` trick applied : ${i}`));let f=xy.rect(i);return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}if(B.isrational(e)&&B.isrational(t)){Je&&console.log("   power: isrational(base) && isrational(exponent)");let f=z2.qpow(e,t);return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}if(B.isNumericAtom(e)&&B.isNumericAtom(t)){let f=j2.dpow(Or.nativeDouble(e),Or.nativeDouble(t));return Je&&(console.log("   power: both base and exponent are either rational or double "),console.log("POWER - isNumericAtom(base) && isNumericAtom(exponent)"),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(B.istensor(e)){let f=Z2.power_tensor(e,t);return Je&&(console.log("   power: istensor(base) "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(B.car(e)===Zt.symbol(B.ABS)&&pt.iseveninteger(t)&&!pt.isZeroAtomOrTensor(Zt.get_binding(Zt.symbol(B.ASSUME_REAL_VARIABLES)))){let f=Mr(B.cadr(e),t);return Je&&(console.log("   power: even power of absolute of real value "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(e===Zt.symbol(B.E)&&B.car(t)===Zt.symbol(B.LOG)){let f=B.cadr(t);return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}if(e===Zt.symbol(B.E)&&B.isdouble(t)){let f=Or.double(Math.exp(t.d));return Je&&(console.log("   power: base == symbol(E) && isdouble(exponent) "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(e===Zt.symbol(B.E)&&ac.Find(t,B.Constants.imaginaryunit)&&ac.Find(t,Zt.symbol(B.PI))&&!B.defs.evaluatingPolar){let f=zs.makeList(Zt.symbol(B.POWER),e,t);Je&&console.log(`   power: turning complex exponential to rect: ${f}`);let _=xy.rect(f);if(!ac.Find(_,Zt.symbol(B.PI)))return Je&&console.log(`   power: turned complex exponential to rect: ${_}`),_}if(B.ismultiply(e)&&pt.isinteger(t)){e=B.cdr(e);let f=Mr(B.car(e),t);return B.iscons(e)&&(f=e.tail().reduce((_,w)=>Qt.multiply(_,Mr(w,t)),f)),Je&&(console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}let o=!1;if(B.isNumericAtom(B.cadr(e))&&(o=pl.sign(Or.compare_numbers(B.cadr(e),B.Constants.zero))>0),B.ispower(e)&&(pt.isinteger(t)||o)){let f=Mr(B.cadr(e),Qt.multiply(B.caddr(e),t));return Je&&console.log(`   power of ${n} ^ ${r}: ${f}`),f}let s=!1;if(pt.iseveninteger(B.caddr(e))){let f=Qt.multiply(B.caddr(e),t);pt.isone(f)&&(s=!0)}if(B.ispower(e)&&s){let f=vy.abs(B.cadr(e));return Je&&(console.log("   power: car(base) == symbol(POWER) && b_isEven_and_c_isItsInverse "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(B.defs.expanding&&B.isadd(e)&&B.isNumericAtom(t)){let f=Or.nativeInt(t);if(f>1&&!isNaN(f)){Je&&console.log("   power: expanding && isadd(base) && isNumericAtom(exponent) ");let _=H2(f,e);return Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}if(B.defs.trigmode===1&&B.car(e)===Zt.symbol(B.SIN)&&pt.iseveninteger(t)){let f=Mr(lc.subtract(B.Constants.one,Mr(F2.cosine(B.cadr(e)),Or.integer(2))),Qt.multiply(t,Or.rational(1,2)));return Je&&(console.log("   power: trigmode == 1 && car(base) == symbol(SIN) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(B.defs.trigmode===2&&B.car(e)===Zt.symbol(B.COS)&&pt.iseveninteger(t)){let f=Mr(lc.subtract(B.Constants.one,Mr(Y2.sine(B.cadr(e)),Or.integer(2))),Qt.multiply(t,Or.rational(1,2)));return Je&&(console.log("   power: trigmode == 2 && car(base) == symbol(COS) && iseveninteger(exponent) "),console.log(`   power of ${n} ^ ${r}: ${f}`)),f}if(pt.iscomplexnumber(e)){if(Je&&console.log(" power - handling the case (a + ib) ^ n"),pt.isinteger(t)){let f=G2.conjugate(e),_=Qt.divide(f,Qt.multiply(f,e));return pt.isone(t)||(_=Mr(_,Qt.negate(t))),Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}if(B.isNumericAtom(t)){let f=B.defs.evaluatingAsFloats||pt.iscomplexnumberdouble(e)&&B.isdouble(t)?Or.double(Math.PI):Zt.symbol(B.PI),_=Qt.multiply(Mr(vy.abs(e),t),Mr(B.Constants.negOne,Qt.divide(Qt.multiply(B2.arg(e),t),f)));return B.avoidCalculatingPowersIntoArctans&&ac.Find(_,Zt.symbol(B.ARCTAN))&&(_=zs.makeList(Zt.symbol(B.POWER),e,t)),Je&&console.log(`   power of ${n} ^ ${r}: ${_}`),_}}let u=Q2(t);if(u!==void 0)return Je&&console.log("   power: using simplify_polar"),u;let c=zs.makeList(Zt.symbol(B.POWER),e,t);return Je&&(console.log("   power: nothing can be done "),console.log(`   power of ${n} ^ ${r}: ${c}`)),c}function H2(e,t){let r=[],n=pl.length(t)-1,i=[];t=B.cdr(t);for(let o=0;o<n;o++){for(let s=0;s<=e;s++)i[o*(e+1)+s]=Mr(B.car(t),Or.integer(s));t=B.cdr(t)}t=Ey.factorial(Or.integer(e));for(let o=0;o<n;o++)r[o]=0;return py(n,e,r,0,e,i,t,B.Constants.zero)}function py(e,t,r,n,i,o,s,u){if(n<e-1){for(let f=0;f<=i;f++)r[n]=f,u=py(e,t,r,n+1,i-f,o,s,u);return u}r[n]=i;let c=s;for(let f=0;f<e;f++)c=Qt.divide(c,Ey.factorial(Or.integer(r[f])));for(let f=0;f<e;f++)c=Qt.multiply(c,o[f*(t+1)+r[f]]);return lc.add(u,c)}function Q2(e){let t=pt.isquarterturn(e);switch(t){case 0:break;case 1:return B.Constants.one;case 2:return B.Constants.negOne;case 3:return B.Constants.imaginaryunit;case 4:return Qt.negate(B.Constants.imaginaryunit)}if(B.isadd(e)){let r=B.cdr(e);for(;B.iscons(r)&&(t=pt.isquarterturn(B.car(r)),!t);)r=B.cdr(r);let n;switch(t){case 0:return;case 1:n=B.Constants.one;break;case 2:n=B.Constants.negOne;break;case 3:n=B.Constants.imaginaryunit;break;case 4:n=Qt.negate(B.Constants.imaginaryunit);break}return Qt.multiply(n,pl.exponential(lc.subtract(e,B.car(r))))}}});var X=A(wt=>{"use strict";Object.defineProperty(wt,"__esModule",{value:!0});wt.negate_noexpand=wt.negate=wt.reciprocate=wt.inverse=wt.divide=wt.multiply_all_noexpand=wt.multiply_all=wt.multiply_noexpand=wt.multiply=wt.Eval_multiply=void 0;var D=N(),W2=ui(),hy=Ee(),ki=$(),J2=Ie(),hl=ce(),li=j(),Ay=G(),lr=Q(),Zs=ee(),Oy=Et(),My=qt();function K2(e){let t=Ay.Eval(D.cadr(e));return e=D.cddr(e),D.iscons(e)&&(t=[...e].reduce((r,n)=>Ui(r,Ay.Eval(n)),t)),t}wt.Eval_multiply=K2;function Ui(e,t){return D.defs.esc_flag&&hy.stop("escape key stop"),D.isNumericAtom(e)&&D.isNumericAtom(t)?li.multiply_numbers(e,t):eA(e,t)}wt.multiply=Ui;function eA(e,t){if(lr.isZeroAtom(e)||lr.isZeroAtom(t))return D.Constants.Zero();if(D.defs.expanding&&D.isadd(e))return e.tail().reduce((c,f)=>hl.add(c,Ui(f,t)),D.Constants.Zero());if(D.defs.expanding&&D.isadd(t))return t.tail().reduce((c,f)=>hl.add(c,Ui(e,f)),D.Constants.Zero());if(!D.istensor(e)&&D.istensor(t))return My.scalar_times_tensor(e,t);if(D.istensor(e)&&!D.istensor(t))return My.tensor_times_scalar(e,t);e=D.ismultiply(e)?D.cdr(e):Zs.makeList(e),t=D.ismultiply(t)?D.cdr(t):Zs.makeList(t);let r=[];if(D.isNumericAtom(D.car(e))&&D.isNumericAtom(D.car(t))){let c=D.car(e),f=D.car(t);r.push(li.multiply_numbers(c,f)),e=D.cdr(e),t=D.cdr(t)}else D.isNumericAtom(D.car(e))?(r.push(D.car(e)),e=D.cdr(e)):D.isNumericAtom(D.car(t))?(r.push(D.car(t)),t=D.cdr(t)):r.push(D.Constants.One());let[n,i]=uc(e),[o,s]=cc(t);for(;D.iscons(e)&&D.iscons(t);){if(D.caar(e)===ki.symbol(D.OPERATOR)&&D.caar(t)===ki.symbol(D.OPERATOR)){r.push(new D.Cons(ki.symbol(D.OPERATOR),W2.append(D.cdar(e),D.cdar(t)))),e=D.cdr(e),t=D.cdr(t),[n,i]=uc(e),[o,s]=cc(t);continue}switch(J2.cmp_expr(n,o)){case-1:r.push(D.car(e)),e=D.cdr(e),[n,i]=uc(e);break;case 1:r.push(D.car(t)),t=D.cdr(t),[o,s]=cc(t);break;case 0:tA(r,o,i,s),e=D.cdr(e),t=D.cdr(t),[n,i]=uc(e),[o,s]=cc(t);break;default:hy.stop("internal error 2")}}if(D.iscons(e)&&r.push(...e),D.iscons(t)&&r.push(...t),sA(r),D.defs.expanding){for(let c=0;c<r.length;c++)if(D.isadd(r[c]))return _m(r)}let u=r.length;return u===1?r.pop():D.isrational(r[0])&&lr.equaln(r[0],1)?u===2?r.pop():(r[0]=ki.symbol(D.MULTIPLY),Zs.makeList(...r)):new D.Cons(ki.symbol(D.MULTIPLY),Zs.makeList(...r))}function uc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function cc(e){let t=D.car(e),r=D.Constants.One();return D.ispower(t)&&(r=D.caddr(t),t=D.cadr(t)),[t,r]}function tA(e,t,r,n){let i=Oy.power(t,hl.add(r,n));if(D.isNumericAtom(i))e[0]=li.multiply_numbers(e[0],i);else if(D.ismultiply(i))if(D.isNumericAtom(D.cadr(i))&&D.cdddr(i)===ki.symbol(D.NIL)){let o=e[0],s=D.cadr(i);e[0]=li.multiply_numbers(o,s),e.push(D.caddr(i))}else e.push(i);else e.push(i)}function rA(e,t){return D.noexpand(Ui,e,t)}wt.multiply_noexpand=rA;function _m(e){if(e.length===1)return e[0];if(e.length===0)return D.Constants.One();let t=e[0];for(let r=1;r<e.length;r++)t=Ui(t,e[r]);return t}wt.multiply_all=_m;function nA(e){return D.noexpand(_m,e)}wt.multiply_all_noexpand=nA;function Al(e,t){return D.isNumericAtom(e)&&D.isNumericAtom(t)?li.divide_numbers(e,t):Ui(e,bm(t))}wt.divide=Al;function bm(e){return D.isNumericAtom(e)?li.invert_number(e):Oy.power(e,D.Constants.negOne)}wt.inverse=bm;function iA(e){return bm(e)}wt.reciprocate=iA;function Ty(e){return D.isNumericAtom(e)?li.negate_number(e):Ui(e,D.Constants.NegOne())}wt.negate=Ty;function oA(e){return D.noexpand(Ty,e)}wt.negate_noexpand=oA;function sA(e){let t=0;if(lr.isplusone(e[0])||lr.isminusone(e[0])||D.isdouble(e[0]))return;for(t=1;t<e.length&&!gm(e[t]);t++);if(t===e.length)return;let r=li.mp_numerator(e[0]);for(let i=1;i<e.length&&!(lr.isplusone(r)||lr.isminusone(r));i++){if(!gm(e[i]))continue;let o=D.cadr(e[i]),s=D.caddr(e[i]);if(!lr.isnegativenumber(s))continue;let u=Al(r,o);!lr.isinteger(u)||(r=u,e[i]=Zs.makeList(ki.symbol(D.POWER),o,hl.add(D.Constants.One(),s)))}let n=li.mp_denominator(e[0]);for(let i=1;i<e.length&&!lr.isplusone(n);i++){if(!gm(e[i]))continue;let o=D.cadr(e[i]),s=D.caddr(e[i]);if(lr.isnegativenumber(s))continue;let u=Al(n,o);if(!lr.isinteger(u))continue;n=u;let c=hl.subtract(s,D.Constants.one);if(D.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&lr.isinteger(o)&&!lr.isinteger(c)&&lr.isnegativenumber(c)){r=Al(r,o);break}e[i]=Zs.makeList(ki.symbol(D.POWER),o,c)}e[0]=Al(r,n)}function gm(e){return D.ispower(e)&&D.isNumericAtom(D.cadr(e))&&lr.isfraction(D.caddr(e))&&!lr.isminusone(D.cadr(e))}});var fc=A(Vs=>{"use strict";Object.defineProperty(Vs,"__esModule",{value:!0});Vs.determinant=Vs.det=void 0;var $i=N(),Ny=Ie(),Iy=ce(),aA=j(),lA=ee(),ho=X(),uA=qt(),cA=$();function dA(e){if(!uA.is_square_matrix(e))return lA.makeList(cA.symbol($i.DET),e);let t=e.tensor.elem;return t.every(n=>$i.isNumericAtom(n))?fA(e):Sy(t,e.tensor.dim[0])}Vs.det=dA;function Sy(e,t){let r=0,n=[];for(let s=0;s<t;s++)n[s]=s,n[s+t]=0,n[s+t+t]=1;let i=1,o=$i.Constants.zero;for(;;){let s=aA.integer(i);for(let w=0;w<t;w++){let T=t*n[w]+w;s=ho.multiply(s,e[T])}o=Iy.add(o,s);let u=t-1,c=0,f=!1;for(;;){if(r=n[t+u]+n[t+t+u],r<0){n[t+t+u]=-n[t+t+u],u--;continue}if(r===u+1){if(u===0){f=!0;break}c++,n[t+t+u]=-n[t+t+u],u--;continue}break}if(f)break;let _=n[u-n[t+u]+c];n[u-n[t+u]+c]=n[u-r+c],n[u-r+c]=_,n[t+u]=r,i=i===1?-1:1}return o}Vs.determinant=Sy;function fA(e){let t=e.tensor.dim[0],r=[...e.tensor.elem];return mA(r,t)}function Nn(e,t,r,n){return e[t*r+n]}function dc(e,t,r,n,i){e[t*r+n]=i}function mA(e,t){let r=$i.Constants.one;for(let n=0;n<t-1;n++){if(Ny.equal(Nn(e,t,n,n),$i.Constants.zero)){let i=0;for(i=n+1;i<t&&Ny.equal(Nn(e,t,i,n),$i.Constants.zero);i++);if(i===t){r=$i.Constants.zero;break}for(let o=n;o<t;o++){let s=Nn(e,t,n,o);dc(e,t,n,o,Nn(e,t,i,o)),dc(e,t,i,o,s)}r=ho.negate(r)}r=ho.multiply(r,Nn(e,t,n,n));for(let i=n+1;i<t;i++){let o=ho.negate(ho.divide(Nn(e,t,i,n),Nn(e,t,n,n)));dc(e,t,i,n,$i.Constants.zero);for(let s=n+1;s<t;s++){let u=Iy.add(ho.multiply(Nn(e,t,n,s),o),Nn(e,t,i,s));dc(e,t,i,s,u)}}}return ho.multiply(r,Nn(e,t,t-1,t-1))}});var Em=A(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.hermite=void 0;var Xs=N(),ym=$(),_A=ce(),vm=j(),bA=G(),gA=ee(),qm=X(),yA=Zr();function vA(e,t){return qA(e,t)}mc.hermite=vA;function qA(e,t){let r=vm.nativeInt(t);return r<0||isNaN(r)?gA.makeList(ym.symbol(Xs.HERMITE),e,t):Xs.issymbol(e)?wy(r,e):bA.Eval(yA.subst(wy(r,ym.symbol(Xs.SECRETX)),ym.symbol(Xs.SECRETX),e))}function wy(e,t){let r=Xs.Constants.zero,n=Xs.Constants.one;for(let i=0;i<e;i++){let o=r;r=n,n=qm.multiply(_A.subtract(qm.multiply(t,r),qm.multiply(vm.integer(i),o)),vm.integer(2))}return n}});var Ly=A(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.hilbert=void 0;var EA=N(),xA=Ie(),Ry=j(),pA=ee(),hA=X(),AA=$();function OA(e){let t=Ry.nativeInt(e);if(t<2)return pA.makeList(AA.symbol(EA.HILBERT),e);let r=xA.zero_matrix(t,t);for(let n=0;n<t;n++)for(let i=0;i<t;i++)r.tensor.elem[n*t+i]=hA.inverse(Ry.integer(n+i+1));return r}_c.hilbert=OA});var Am=A(Hs=>{"use strict";Object.defineProperty(Hs,"__esModule",{value:!0});Hs.cofactor=Hs.Eval_cofactor=void 0;var xm=N(),pm=Ee(),MA=fc(),hm=G(),TA=X(),NA=qt();function IA(e){let t=hm.Eval(xm.cadr(e));NA.is_square_matrix(t)||pm.stop("cofactor: 1st arg: square matrix expected");let r=t.tensor.dim[0],n=hm.evaluate_integer(xm.caddr(e));(n<1||n>r)&&pm.stop("cofactor: 2nd arg: row index expected");let i=hm.evaluate_integer(xm.cadddr(e));return(i<1||i>r)&&pm.stop("cofactor: 3rd arg: column index expected"),Cy(t,r,n-1,i-1)}Hs.Eval_cofactor=IA;function Cy(e,t,r,n){let i=[];for(let s=0;s<t;s++)for(let u=0;u<t;u++)s!==r&&u!==n&&i.push(e.tensor.elem[t*s+u]);let o=MA.determinant(i,t-1);return(r+n)%2&&(o=TA.negate(o)),o}Hs.cofactor=Cy});var Om=A(Qs=>{"use strict";Object.defineProperty(Qs,"__esModule",{value:!0});Qs.adj=Qs.Eval_adj=void 0;var SA=St(),wA=N(),RA=Ee(),LA=Am(),CA=G(),PA=qt();function DA(e){return Py(CA.Eval(wA.cadr(e)))}Qs.Eval_adj=DA;function Py(e){PA.is_square_matrix(e)||RA.stop("adj: square matrix expected");let t=e.tensor.dim[0],r=SA.alloc_tensor(t*t);r.tensor.ndim=2,r.tensor.dim[0]=t,r.tensor.dim[1]=t;for(let n=0;n<t;n++)for(let i=0;i<t;i++)r.tensor.elem[t*i+n]=LA.cofactor(e,t,n,i);return r}Qs.adj=Py});var Bi=A(Ws=>{"use strict";Object.defineProperty(Ws,"__esModule",{value:!0});Ws.inner=Ws.Eval_inner=void 0;var kA=St(),de=N(),Mm=Ee(),Xr=$(),Ol=ce(),Tm=G(),Dy=Nl(),Ml=Q(),Nm=ee(),bc=X(),ky=qt();function Uy(e){let t=[];t.push(de.car(de.cdr(e))),de.car(de.cdr(de.cdr(e)))===Xr.symbol(de.NIL)&&Mm.stop("pattern needs at least a template and a transformed version");let n=de.cdr(de.cdr(e));for(;n!==Xr.symbol(de.NIL);)t.push(de.car(n)),n=de.cdr(n);if(t.length>2){let s=Nm.makeList(Xr.symbol(de.INNER),t[t.length-2],t[t.length-1]);for(let u=2;u<t.length;u++)s=Nm.makeList(Xr.symbol(de.INNER),t[t.length-u-1],s);return Uy(s)}let i=[];gc(e,i);let o=[];for(let s=0;s<i.length;s++)i[s]!==Xr.symbol(de.SYMBOL_IDENTITY_MATRIX)&&o.push(i[s]);if(i=o,o=[],i.length>1){let s=0;for(let u=0;u<i.length&&u+s+1<=i.length-1;u++){if(de.isNumericAtomOrTensor(i[u+s])||de.isNumericAtomOrTensor(i[u+s+1]))o.push(i[u+s]);else{let c=Dy.inv(Tm.Eval(i[u+s])),f=Tm.Eval(i[u+s+1]),_=Ol.subtract(c,f);Ml.isZeroAtomOrTensor(_)?s+=1:o.push(i[u+s])}if(u+s===i.length-2&&o.push(i[i.length-1]),u+s>=i.length-1)break}i=o}return i.length==0?Xr.symbol(de.SYMBOL_IDENTITY_MATRIX):(i=i.map(Tm.Eval),i.reduce(Tl))}Ws.Eval_inner=Uy;function Tl(e,t){if(Ml.isnegativeterm(t)&&Ml.isnegativeterm(e)&&(t=bc.negate(t),e=bc.negate(e)),de.isinnerordot(e)&&(t=Tl(de.car(de.cdr(de.cdr(e))),t),e=de.car(de.cdr(e))),e===Xr.symbol(de.SYMBOL_IDENTITY_MATRIX))return t;if(t===Xr.symbol(de.SYMBOL_IDENTITY_MATRIX))return e;if(de.istensor(e)&&de.istensor(t))return UA(e,t);if(!(de.isNumericAtomOrTensor(e)||de.isNumericAtomOrTensor(t))){let r=Ol.subtract(e,Dy.inv(t));if(Ml.isZeroAtomOrTensor(r))return Xr.symbol(de.SYMBOL_IDENTITY_MATRIX)}return de.defs.expanding&&de.isadd(e)?e.tail().reduce((r,n)=>Ol.add(r,Tl(n,t)),de.Constants.zero):de.defs.expanding&&de.isadd(t)?t.tail().reduce((r,n)=>Ol.add(r,Tl(e,n)),de.Constants.zero):de.istensor(e)&&de.isNumericAtom(t)?ky.tensor_times_scalar(e,t):de.isNumericAtom(e)&&de.istensor(t)?ky.scalar_times_tensor(e,t):de.isNumericAtom(e)||de.isNumericAtom(t)?bc.multiply(e,t):Nm.makeList(Xr.symbol(de.INNER),e,t)}Ws.inner=Tl;function UA(e,t){let r=e.tensor.dim[e.tensor.ndim-1];r!==t.tensor.dim[0]&&(de.breakpoint,Mm.stop("inner: tensor dimension check"));let n=e.tensor.ndim+t.tensor.ndim-2;n>de.MAXDIM&&Mm.stop("inner: rank of result exceeds maximum");let i=e.tensor.elem,o=t.tensor.elem,s=e.tensor.dim.slice(0,e.tensor.dim.length-1).reduce((_,w)=>_*w,1),u=t.tensor.dim.slice(1).reduce((_,w)=>_*w,1),c=kA.alloc_tensor(s*u),f=c.tensor.elem;for(let _=0;_<s;_++)for(let w=0;w<r;w++)if(!Ml.isZeroAtomOrTensor(i[_*r+w]))for(let T=0;T<u;T++)f[_*u+T]=Ol.add(bc.multiply(i[_*r+w],o[w*u+T]),f[_*u+T]);return n===0?c.tensor.elem[0]:(c.tensor.ndim=n,c.tensor.dim=[...e.tensor.dim.slice(0,e.tensor.ndim-1),...t.tensor.dim.slice(1,t.tensor.ndim)],c)}function gc(e,t){if(!de.iscons(e)){$y(e,t);return}if(de.cdr(e)===Xr.symbol(de.NIL)){gc(de.car(e),t);return}if(de.isinnerordot(e)){gc(de.car(de.cdr(e)),t),gc(de.cdr(de.cdr(e)),t);return}$y(e,t)}function $y(e,t){e!==Xr.symbol(de.NIL)&&t.push(e)}});var Nl=A(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.invg=Js.inv=void 0;var $A=St(),Tr=N(),By=Ee(),Gy=Ie(),Fy=ce(),BA=Om(),GA=fc(),FA=Bi(),jA=Q(),jy=ee(),Il=X(),zy=qt(),Yy=$();function Zy(e){if(Tr.isinv(e))return Tr.car(Tr.cdr(e));if(Tr.isidentitymatrix(e))return e;if(Tr.defs.expanding&&Tr.isinnerordot(e)){let n=(Tr.iscons(e)?e.tail():[]).map(Zy);for(let i=n.length-1;i>0;i--)n[i-1]=FA.inner(n[i],n[i-1]);return n[0]}if(!zy.is_square_matrix(e))return jy.makeList(Yy.symbol(Tr.INV),e);if(Tr.isNumericAtomOrTensor(e))return Vy(e);let t=GA.det(e);return jA.isZeroAtomOrTensor(t)&&By.stop("inverse of singular matrix"),Il.divide(BA.adj(e),t)}Js.inv=Zy;function zA(e){return zy.is_square_matrix(e)?Vy(e):jy.makeList(Yy.symbol(Tr.INVG),e)}Js.invg=zA;function Vy(e){let t=e.tensor.dim[0],r=new Array(t*t);r.fill(Tr.Constants.zero);for(let o=0;o<t;o++)r[o*t+o]=Tr.Constants.one;let n=YA(r,e.tensor.elem,t),i=$A.alloc_tensor(t*t);return i.tensor.ndim=2,i.tensor.dim[0]=t,i.tensor.dim[1]=t,i.tensor.elem=n,i}function YA(e,t,r){for(let n=0;n<r;n++){if(Gy.equal(t[r*n+n],Tr.Constants.zero)){let o=0;for(o=n+1;o<r&&Gy.equal(t[r*o+n],Tr.Constants.zero);o++);o===r&&By.stop("inverse of singular matrix");for(let s=0;s<r;s++){let u=t[r*n+s];t[r*n+s]=t[r*o+s],t[r*o+s]=u,u=e[r*n+s],e[r*n+s]=e[r*o+s],e[r*o+s]=u}}let i=t[r*n+n];for(let o=0;o<r;o++)o>n&&(t[r*n+o]=Il.divide(t[r*n+o],i)),e[r*n+o]=Il.divide(e[r*n+o],i);for(let o=0;o<r;o++){if(o===n)continue;let s=t[r*o+n];for(let u=0;u<r;u++)u>n&&(t[r*o+u]=Fy.subtract(t[r*o+u],Il.multiply(t[r*n+u],s))),e[r*o+u]=Fy.subtract(e[r*o+u],Il.multiply(e[r*n+u],s))}}return e}});var Sm=A(Ks=>{"use strict";Object.defineProperty(Ks,"__esModule",{value:!0});Ks.besselj=Ks.Eval_besselj=void 0;var Wt=N(),ZA=ui(),Sl=$(),yc=ce(),dn=j(),VA=Ri(),Xy=G(),wl=Q(),Im=ee(),ur=X(),Rl=Et(),XA=Wn();function HA(e){return vc(Xy.Eval(Wt.cadr(e)),Xy.Eval(Wt.caddr(e)))}Ks.Eval_besselj=HA;function vc(e,t){return QA(e,t)}Ks.besselj=vc;function QA(e,t){let r=dn.nativeInt(t);if(Wt.isdouble(e)&&!isNaN(r)){let n=ZA.jn(r,e.d);return dn.double(n)}if(wl.isZeroAtomOrTensor(e)&&wl.isZeroAtomOrTensor(t))return Wt.Constants.one;if(wl.isZeroAtomOrTensor(e)&&!isNaN(r))return Wt.Constants.zero;if(t.k===Wt.NUM&&Wt.MEQUAL(t.q.b,2)){if(Wt.MEQUAL(t.q.a,1)){let i=Wt.defs.evaluatingAsFloats?dn.double(2/Math.PI):ur.divide(dn.integer(2),Sl.symbol(Wt.PI));return ur.multiply(Rl.power(ur.divide(i,e),dn.rational(1,2)),XA.sine(e))}if(Wt.MEQUAL(t.q.a,-1)){let i=Wt.defs.evaluatingAsFloats?dn.double(2/Math.PI):ur.divide(dn.integer(2),Sl.symbol(Wt.PI));return ur.multiply(Rl.power(ur.divide(i,e),dn.rational(1,2)),VA.cosine(e))}let n=dn.integer(Wt.MSIGN(t.q.a));return yc.subtract(ur.multiply(ur.multiply(ur.divide(dn.integer(2),e),yc.subtract(t,n)),vc(e,yc.subtract(t,n))),vc(e,yc.subtract(t,ur.multiply(dn.integer(2),n))))}return wl.isnegativeterm(e)?ur.multiply(ur.multiply(Rl.power(ur.negate(e),t),Rl.power(e,ur.negate(t))),Im.makeList(Sl.symbol(Wt.BESSELJ),ur.negate(e),t)):wl.isnegativeterm(t)?ur.multiply(Rl.power(Wt.Constants.negOne,t),Im.makeList(Sl.symbol(Wt.BESSELJ),e,ur.negate(t))):Im.makeList(Sl.symbol(Wt.BESSELJ),e,t)}});var wm=A(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.bessely=ta.Eval_bessely=void 0;var ea=N(),WA=ui(),Hy=$(),Qy=j(),Wy=G(),JA=Q(),Jy=ee(),Ky=X(),KA=Et();function eO(e){return ev(Wy.Eval(ea.cadr(e)),Wy.Eval(ea.caddr(e)))}ta.Eval_bessely=eO;function ev(e,t){return tO(e,t)}ta.bessely=ev;function tO(e,t){let r=Qy.nativeInt(t);if(ea.isdouble(e)&&!isNaN(r)){let n=WA.yn(r,e.d);return Qy.double(n)}return JA.isnegativeterm(t)?Ky.multiply(KA.power(ea.Constants.negOne,t),Jy.makeList(Hy.symbol(ea.BESSELY),e,Ky.negate(t))):Jy.makeList(Hy.symbol(ea.BESSELY),e,t)}});var Rm=A(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.ycosh=ra.Eval_cosh=void 0;var Ao=N(),tv=$(),rO=j(),nO=G(),iO=Q(),oO=ee();function sO(e){return rv(nO.Eval(Ao.cadr(e)))}ra.Eval_cosh=sO;function rv(e){if(Ao.car(e)===tv.symbol(Ao.ARCCOSH))return Ao.cadr(e);if(Ao.isdouble(e)){let t=Math.cosh(e.d);return Math.abs(t)<1e-10&&(t=0),rO.double(t)}return iO.isZeroAtomOrTensor(e)?Ao.Constants.one:oO.makeList(tv.symbol(Ao.COSH),e)}ra.ycosh=rv});var Dm=A(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.dirac=na.Eval_dirac=void 0;var xr=N(),Lm=$(),aO=G(),Cm=Q(),Pm=ee(),lO=un(),nv=X();function uO(e){return iv(aO.Eval(xr.cadr(e)))}na.Eval_dirac=uO;function iv(e){return cO(e)}na.dirac=iv;function cO(e){return xr.isdouble(e)?e.d===0?xr.Constants.one:xr.Constants.zero:xr.isrational(e)?xr.MZERO(lO.mmul(e.q.a,e.q.b))?xr.Constants.one:xr.Constants.zero:xr.ispower(e)?Pm.makeList(Lm.symbol(xr.DIRAC),xr.cadr(e)):Cm.isnegativeterm(e)?Pm.makeList(Lm.symbol(xr.DIRAC),nv.negate(e)):((Cm.isnegativeterm(e)||xr.isadd(e)&&Cm.isnegativeterm(xr.cadr(e)))&&(e=nv.negate(e)),Pm.makeList(Lm.symbol(xr.DIRAC),e))}});var sv=A(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.partition=void 0;var km=N(),dO=or(),ov=X();function fO(e,t){let r=km.Constants.one,n=r;if(e=km.cdr(e),!km.iscons(e))return[r,n];for(let i of e)dO.Find(i,t)?n=ov.multiply(n,i):r=ov.multiply(r,i);return[r,n]}qc.partition=fO});var zi=A(aa=>{"use strict";Object.defineProperty(aa,"__esModule",{value:!0});aa.scan_meta=aa.scan=void 0;var mO=St(),W=N(),Gi=ui(),_O=Ee(),dt=$(),av=j(),bO=Q(),Vt=ee(),Ec=X(),gO=qt(),Um=1001,$m=1002,xc=1003,Bm=1004,Gm=1006,Fm=1007,lv=1008,uv=1009,cv=1010,dv=1011,jm=1012,te="",Ll=0,zm=0,Hr=0,J=0,ia=0,ft="",pc=null,Xe=null,Cl=null,Fi=null,oa=null,Ke=null,ji=!1,Ym=null,ye="";function yO(e){W.DEBUG&&console.log(`#### scanning ${e}`),pc=null,Xe=[],Cl=[],Fi=!0,oa=[],Ke=[""],Ym=!1,ye=e,zm=0;let t=W.defs.expanding;if(W.defs.expanding=!0,Hr=0,J=0,Pe(),te==="")return W.defs.expanding=t,[0,dt.symbol(W.NIL)];let r=ci();return W.defs.expanding=t,Ym||(W.defs.symbolsInExpressionsWithoutAssignments=W.defs.symbolsInExpressionsWithoutAssignments.concat(Cl)),[ia-Hr,r]}aa.scan=yO;function vO(e){ye=e,zm=1;let t=W.defs.expanding;if(W.defs.expanding=!0,Hr=0,J=0,Pe(),te==="")return W.defs.expanding=t,dt.symbol(W.NIL);let r=ci();return W.defs.expanding=t,r}aa.scan_meta=vO;function ci(){let e=fv(),t=!1;if(te===jm&&(t=!0),te===jm||te==="="){let r=pc;W.DEBUG&&console.log("assignment!"),Ym=!0,Fi=!1,Pe();let n=fv();if(t&&(n=Vt.makeList(dt.symbol(W.QUOTE),n)),e=Vt.makeList(dt.symbol(W.SETQ),e,n),Fi=!0,W.defs.codeGen){let i=Xe.indexOf(r);if(i!==-1&&(Xe.splice(i,1),W.defs.symbolsHavingReassignments.push(r)),W.DEBUG){console.log(`locally, ${r} depends on: `);for(let s of Array.from(Xe))console.log(`  ${s}`)}W.defs.symbolsDependencies[r]==null&&(W.defs.symbolsDependencies[r]=[]);let o=W.defs.symbolsDependencies[r];for(let s of Array.from(Xe))o.indexOf(s)===-1&&o.push(s);Xe=[]}}return e}function fv(){let e=di(),t;switch(te){case cv:return Pe(),t=di(),Vt.makeList(dt.symbol(W.TESTEQ),e,t);case dv:return Pe(),t=di(),Vt.makeList(dt.symbol(W.NOT),Vt.makeList(dt.symbol(W.TESTEQ),e,t));case uv:return Pe(),t=di(),Vt.makeList(dt.symbol(W.TESTLE),e,t);case lv:return Pe(),t=di(),Vt.makeList(dt.symbol(W.TESTGE),e,t);case"<":return Pe(),t=di(),Vt.makeList(dt.symbol(W.TESTLT),e,t);case">":return Pe(),t=di(),Vt.makeList(dt.symbol(W.TESTGT),e,t)}return e}function di(){let e=[dt.symbol(W.ADD)];switch(te){case"+":Pe(),e.push(Pl());break;case"-":Pe(),e.push(Ec.negate(Pl()));break;default:e.push(Pl())}for(;Ll===0&&(te==="+"||te==="-");)te==="+"?(Pe(),e.push(Pl())):(Pe(),e.push(Ec.negate(Pl())));return e.length===2?e[1]:Vt.makeList(...e)}function Zm(){if(typeof te=="string")return te.charCodeAt(0)}function qO(){if(Zm()===W.dotprod_unicode)return!0;switch(te){case"*":case"/":return!0;case"(":case xc:case Bm:case Um:case $m:case Fm:return Ll?(J=ia,!1):!0}return!1}function Vm(e){e.length>0&&W.isrational(e[e.length-1])&&bO.equaln(e[e.length-1],1)&&e.pop()}function EO(e){if(e.length>1&&W.isNumericAtom(e[e.length-2])&&W.isNumericAtom(e[e.length-1])){let t=e.pop(),r=e.pop();e.push(Ec.multiply(r,t))}}function Pl(){let e=[sa()];for(W.parse_time_simplifications&&Vm(e);qO();)te==="*"?(Pe(),e.push(sa())):te==="/"?(Vm(e),Pe(),e.push(Ec.inverse(sa()))):Zm()===W.dotprod_unicode?(Pe(),e.push(Vt.makeList(dt.symbol(W.INNER),e.pop(),sa()))):e.push(sa()),W.parse_time_simplifications&&(EO(e),Vm(e));return e.length===0?W.Constants.one:e.length==1?e[0]:Vt.makeList(dt.symbol(W.MULTIPLY),...e)}function xO(e){return te==="^"?(Pe(),Vt.makeList(dt.symbol(W.POWER),e,sa())):e}function pO(e){Pe();let t=[dt.symbol(W.INDEX),e,di()];for(;te===",";)Pe(),t.push(di());return te!=="]"&&In("] expected"),Pe(),Vt.makeList(...t)}function sa(){let e=!1,t;for(te==="("?t=NO():te===xc?t=AO():te===Bm?t=MO():te==="["?t=IO():te===Um?(e=!0,t=av.bignum_scan_integer(ft),te=Pe()):te===$m?(e=!0,t=av.bignum_scan_float(ft),te=Pe()):te===Fm?t=OO():In("syntax error");te==="["||te==="("&&Ll===0&&!e;)te==="["?t=pO(t):te==="("&&(t=TO(t));for(;te==="!";)Pe(),t=Vt.makeList(dt.symbol(W.FACTORIAL),t);for(;Zm()===W.transpose_unicode;)Pe(),t=Vt.makeList(dt.symbol(W.TRANSPOSE),t);return xO(t)}function Xm(e){if(W.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Xe.indexOf(e)===-1&&Xe.indexOf("'"+e)===-1&&!ji){W.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols right of assignment`);let t="";for(let r=1;r<Ke.length;r++)Ke[r]!==""&&(t+=Ke[r]+"_"+r+"_");e=t+e,Xe.push(e)}}function hO(e){if(W.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&Cl.indexOf(e)===-1&&Cl.indexOf("'"+e)===-1&&!ji){W.DEBUG&&console.log(`... adding symbol: ${e} to the set of the symbols left of assignment`);let t="";for(let r=1;r<Ke.length;r++)Ke[r]!==""&&(t+=Ke[r]+"_"+r+"_");e=t+e,Cl.push(e)}}function AO(){te!==xc&&In("symbol expected");let e;if(zm&&typeof ft=="string"&&ft.length===1)switch(ft[0]){case"a":e=dt.symbol(W.METAA);break;case"b":e=dt.symbol(W.METAB);break;case"x":e=dt.symbol(W.METAX);break;default:e=dt.usr_symbol(ft)}else e=dt.usr_symbol(ft);return oa.length===0?(W.DEBUG&&console.log(`out of scanning parameters, processing ${ft}`),pc=ft,Fi&&hO(ft)):(W.DEBUG&&console.log(`still scanning parameters, skipping ${ft}`),Fi&&Xm("'"+ft)),W.DEBUG&&console.log(`found symbol: ${ft} left of assignment: ${Fi}`),Fi||Xm(ft),Pe(),e}function OO(){let e=new W.Str(ft);return Pe(),e}function MO(){W.DEBUG&&console.log("-- scan_function_call_with_function_name start");let e=1,r=[dt.usr_symbol(ft)],n=ft;if((n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Ke.push(ft),pc=ft,Fi||Xm(ft),Pe(),Pe(),oa.push(!0),te!==")"){for(r.push(ci()),e++;te===",";)Pe(),e===2&&Ke[Ke.length-1].indexOf("roots")!==-1&&(Xe=Xe.filter(i=>!new RegExp("roots_"+(Ke.length-1)+"_"+ft).test(i)),ji=!0),e===2&&Ke[Ke.length-1].indexOf("sum")!==-1&&(Xe=Xe.filter(i=>!new RegExp("sum_"+(Ke.length-1)+"_"+ft).test(i)),ji=!0),e===2&&Ke[Ke.length-1].indexOf("product")!==-1&&(Xe=Xe.filter(i=>!new RegExp("product_"+(Ke.length-1)+"_"+ft).test(i)),ji=!0),e===2&&Ke[Ke.length-1].indexOf("for")!==-1&&(Xe=Xe.filter(i=>!new RegExp("for_"+(Ke.length-1)+"_"+ft).test(i)),ji=!0),Ke[Ke.length-1].indexOf("defint")!==-1&&(e===2||e>2&&(e-2)%3==0)&&(Xe=Xe.filter(i=>!new RegExp("defint_"+(Ke.length-1)+"_"+ft).test(i)),ji=!0),r.push(ci()),ji=!1,e++;e===2&&Ke[Ke.length-1].indexOf("roots")!==-1&&(Xe=Xe.filter(i=>!new RegExp("roots_"+(Ke.length-1)+"_x").test(i)))}oa.pop();for(let i=0;i<=Xe.length;i++)Xe[i]!=null&&(n==="roots"&&(Xe[i]=Xe[i].replace(new RegExp("roots_"+(Ke.length-1)+"_"),"")),n==="defint"&&(Xe[i]=Xe[i].replace(new RegExp("defint_"+(Ke.length-1)+"_"),"")),n==="sum"&&(Xe[i]=Xe[i].replace(new RegExp("sum_"+(Ke.length-1)+"_"),"")),n==="product"&&(Xe[i]=Xe[i].replace(new RegExp("product_"+(Ke.length-1)+"_"),"")),n==="for"&&(Xe[i]=Xe[i].replace(new RegExp("for_"+(Ke.length-1)+"_"),"")));return te!==")"&&In(") expected"),Pe(),(n==="roots"||n==="defint"||n==="sum"||n==="product"||n==="for")&&Ke.pop(),n===dt.symbol(W.PATTERN).printname&&(W.defs.patternHasBeenFound=!0),W.DEBUG&&console.log("-- scan_function_call_with_function_name end"),Vt.makeList(...r)}function TO(e){W.DEBUG&&console.log("-- scan_function_call_without_function_name start");let r=[Vt.makeList(dt.symbol(W.EVAL),e)];if(Pe(),oa.push(!0),te!==")")for(r.push(ci());te===",";)Pe(),r.push(ci());return oa.pop(),te!==")"&&In(") expected"),Pe(),W.DEBUG&&console.log(`-- scan_function_call_without_function_name end: ${r[r.length-1]}`),Vt.makeList(...r)}function NO(){let e=0;te!=="("&&In("( expected"),te=Pe();let t=ci();return te!==")"&&In(") expected"),Pe(),t}function IO(){te!=="["&&In("[ expected"),Pe();let e=[ci()];for(;te===",";)te=Pe(),e.push(ci());let t=SO(e);return te!=="]"&&In("] expected"),Pe(),t}function In(e){for(W.defs.errorMessage="";Hr!==J&&!((ye[Hr]===`
`||ye[Hr]==="\r")&&Hr+1===J);)W.defs.errorMessage+=ye[Hr++];for(W.defs.errorMessage+=" ? ";ye[Hr]&&ye[Hr]!==`
`&&ye[Hr]!=="\r";)W.defs.errorMessage+=ye[Hr++];W.defs.errorMessage+=`
`,_O.stop(e)}function SO(e){let t=mO.alloc_tensor(e.length);t.tensor.ndim=1,t.tensor.dim[0]=e.length;for(let r=0;r<e.length;r++)t.tensor.elem[r]=e[r];return gO.check_tensor_dimensions(t),t}function Pe(){for(Ll=0;wO(),te===Gm;)Ll=1;return W.DEBUG&&console.log(`get_next_token token: ${te}`),te}function wO(){for(;Gi.isspace(ye[J]);){if(ye[J]===`
`||ye[J]==="\r"){te=Gm,J++;return}J++}if(ia=J,J===ye.length){te="";return}if(Gi.isdigit(ye[J])||ye[J]==="."){for(;Gi.isdigit(ye[J]);)J++;if(ye[J]==="."){for(J++;Gi.isdigit(ye[J]);)J++;if(ye[J]==="e"&&(ye[J+1]==="+"||ye[J+1]==="-"||Gi.isdigit(ye[J+1])))for(J+=2;Gi.isdigit(ye[J]);)J++;te=$m}else te=Um;Hm(ia,J);return}if(Gi.isalpha(ye[J])){for(;Gi.isalnumorunderscore(ye[J]);)J++;ye[J]==="("?te=Bm:te=xc,Hm(ia,J);return}if(ye[J]==='"'){for(J++;ye[J]!=='"';)J===ye.length-1&&(J++,In("runaway string"),J--),J++;J++,te=Fm,Hm(ia+1,J-1);return}if(ye[J]==="#"||ye[J]==="-"&&ye[J+1]==="-"){for(;ye[J]&&ye[J]!==`
`&&ye[J]!=="\r";)J++;ye[J]&&J++,te=Gm;return}if(ye[J]===":"&&ye[J+1]==="="){J+=2,te=jm;return}if(ye[J]==="="&&ye[J+1]==="="){J+=2,te=cv;return}if(ye[J]==="!"&&ye[J+1]==="="){J+=2,te=dv;return}if(ye[J]==="<"&&ye[J+1]==="="){J+=2,te=uv;return}if(ye[J]===">"&&ye[J+1]==="="){J+=2,te=lv;return}te=ye[J++]}function Hm(e,t){ft=ye.substring(e,t)}});var wn=A(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.yyfloat=Yi.zzfloat=Yi.Eval_float=void 0;var t4=Ac(),Sn=N(),r4=Ee(),mv=$(),_v=j(),hc=G(),RO=ee(),LO=qt();function CO(e){return Sn.evalFloats(()=>hc.Eval(Qm(hc.Eval(Sn.cadr(e)))))}Yi.Eval_float=CO;function PO(e){return Sn.evalFloats(()=>{e=hc.Eval(e),e=Qm(e),e=hc.Eval(e)}),e}Yi.zzfloat=PO;function Qm(e){return Sn.evalFloats(Wm,e)}Yi.yyfloat=Qm;function Wm(e){return Sn.iscons(e)?RO.makeList(...e.map(Wm)):Sn.istensor(e)?(e=LO.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(Wm),e):Sn.isrational(e)?_v.bignum_float(e):e===mv.symbol(Sn.PI)?Sn.Constants.piAsDouble:e===mv.symbol(Sn.E)?_v.double(Math.E):e}});var Jm=A(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.roots=ua.Eval_roots=void 0;var DO=St(),Le=N(),bv=Ee(),cr=$(),kO=Ie(),Oc=sn(),he=ce(),z=j(),UO=go(),la=G(),$O=Es(),BO=Vr(),br=Q(),M=X(),He=Et(),Jt=Zi(),it={debug:e=>{Le.DEBUG&&console.log(e)}},GO=e=>[].concat(...e);function FO(e){let t=Le.cadr(e),r;Le.car(t)===cr.symbol(Le.SETQ)||Le.car(t)===cr.symbol(Le.TESTEQ)?r=he.subtract(la.Eval(Le.cadr(t)),la.Eval(Le.caddr(t))):(t=la.Eval(t),Le.car(t)===cr.symbol(Le.SETQ)||Le.car(t)===cr.symbol(Le.TESTEQ)?r=he.subtract(la.Eval(Le.cadr(t)),la.Eval(Le.caddr(t))):r=t),t=la.Eval(Le.caddr(e));let n=t===cr.symbol(Le.NIL)?BO.guess(r):t;return br.ispolyexpandedform(r,n)||bv.stop("roots: 1st argument is not a polynomial in the variable "+n),Dl(r,n)}ua.Eval_roots=FO;function jO(e){return e.some(t=>br.iscomplexnumber(t))}function zO(e){return e.length<=2||br.isZeroAtomOrTensor(e[0])?!1:e.slice(1,e.length-1).every(t=>br.isZeroAtomOrTensor(t))}function Mc(e,t){let r=UO.coeff(e,t),n=r[r.length-1];return r.map(i=>M.divide(i,n))}function Dl(e,t){if(Le.defs.recursionLevelNestedRadicalsRemoval>1)return cr.symbol(Le.NIL);it.debug(`checking if ${e} is a case of simple roots`);let r=Mc(e,t),n=[];if(zO(r)){it.debug(`yes, ${r[r.length-1]} is a case of simple roots`);let s=r.length,u=r[0],c=r.pop(),f=YO(s,c,u);n.push(...f)}else{let s=ZO(e,t);n.push(...s)}let i=n.length;if(i===0&&bv.stop("roots: the polynomial is not factorable, try nroots"),i===1)return n[0];kO.sort(n);let o=DO.alloc_tensor(i);o.tensor.ndim=1,o.tensor.dim[0]=i;for(let s=0;s<i;s++)o.tensor.elem[s]=n[s];return console.log(`roots returning ${o}`),o}ua.roots=Dl;function YO(e,t,r){it.debug("getSimpleRoots"),e=e-1;let n=M.divide(He.power(r,z.rational(1,e)),He.power(t,z.rational(1,e))),i=[];if(e%2==0){for(let o=1;o<=e;o+=2){let s=M.multiply(n,He.power(Le.Constants.negOne,z.rational(o,e)));i.push(s),i.push(M.negate(s))}return i}for(let o=1;o<=e;o++){let s=M.multiply(n,He.power(Le.Constants.negOne,z.rational(o,e)));o%2==0&&(s=M.negate(s)),i.push(s)}return i}function ZO(e,t){let r=Mc(e,t);if(jO(r)||(e=$O.factorpoly(e,t)),Le.ismultiply(e)){let n=e.tail().map(i=>gv(i,t));return GO(n)}return gv(e,t)}function gv(e,t){if(Le.ispower(e)&&br.ispolyexpandedform(Le.cadr(e),t)&&br.isposint(Le.caddr(e))){let r=Mc(Le.cadr(e),t);return yv(r)}if(br.ispolyexpandedform(e,t)){let r=Mc(e,t);return yv(r)}return[]}function yv(e){let t=e.length;if(t===2){let r=e.pop(),n=e.pop();return VO(r,n)}if(t===3){let r=e.pop(),n=e.pop(),i=e.pop();return XO(r,n,i)}if(t===4){let r=e.pop(),n=e.pop(),i=e.pop(),o=e.pop();return HO(r,n,i,o)}if(t===5){let r=e.pop(),n=e.pop(),i=e.pop(),o=e.pop(),s=e.pop();return WO(r,n,i,o,s)}return[]}function VO(e,t){return[M.negate(M.divide(t,e))]}function XO(e,t,r){let n=He.power(he.subtract(He.power(t,z.integer(2)),M.multiply(M.multiply(z.integer(4),e),r)),z.rational(1,2)),i=M.divide(he.subtract(n,t),M.multiply(e,z.integer(2))),o=M.multiply(M.divide(M.negate(he.add(n,t)),e),z.rational(1,2));return[i,o]}function HO(e,t,r,n){let i=M.multiply(M.multiply(r,r),r),o=M.multiply(t,t),s=M.multiply(o,t),u=M.multiply(M.multiply(s,n),z.integer(-4)),c=M.multiply(s,z.integer(2)),f=M.multiply(z.integer(3),e),_=M.multiply(M.multiply(e,e),n),w=M.multiply(_,z.integer(27)),T=M.multiply(M.multiply(_,n),z.integer(-27)),k=M.multiply(M.multiply(e,r),t),V=M.multiply(M.multiply(e,r),z.integer(3)),Y=M.multiply(z.integer(-4),M.multiply(e,i)),Ae=M.negate(M.multiply(k,z.integer(9))),tt=M.multiply(M.multiply(k,n),z.integer(18)),Ve=he.subtract(o,V),ke=M.multiply(o,M.multiply(r,r)),st=M.divide(M.negate(t),f),Oe=M.multiply(He.power(Ve,z.integer(3)),z.integer(4)),at=Oc.absValFloat(Jt.simplify(Ve)),ir=Oc.absValFloat(Jt.simplify(he.add_all([tt,u,ke,Y,T]))),Gt=he.add_all([c,Ae,w]),qr=Jt.simplify(He.power(he.subtract(He.power(Gt,z.integer(2)),Oe),z.rational(1,2)));if(it.debug(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),it.debug(`cubic: D0: ${Ve}`),it.debug(`cubic: D0 as float: ${at}`),it.debug(`cubic: DETERMINANT: ${ir}`),it.debug(`cubic: D1: ${Gt}`),br.isZeroAtomOrTensor(ir))return QO(e,t,r,n,{R_DELTA0_toBeCheckedIfZero:at,R_m_b_over_3a:st,R_DELTA0:Ve,R_b3:s,R_a_b_c:k});let It=!1,uo=!1,Zn;for(;!It;){let il=uo?M.negate(qr):qr;Zn=Jt.simplify(He.power(M.multiply(he.add(il,Gt),z.rational(1,2)),z.rational(1,3)));let is=Oc.absValFloat(Jt.simplify(Zn));it.debug(`cubic: C: ${Zn}`),it.debug(`cubic: C as absval and float: ${is}`),br.isZeroAtomOrTensor(is)?(it.debug(" cubic: C IS ZERO flipping the sign"),uo=!0):It=!0}let Ka=M.multiply(M.multiply(Zn,f),z.integer(2)),Eu=M.multiply(Le.Constants.imaginaryunit,He.power(z.integer(3),z.rational(1,2))),xu=he.add(Le.Constants.one,Eu),el=he.subtract(Le.Constants.one,Eu),nn=M.divide(Zn,f),Vn=st,pu=M.negate(nn),tl=M.negate(M.divide(Ve,M.multiply(Zn,f))),on=Jt.simplify(he.add_all([Vn,pu,tl])),co=st,Xn=M.divide(M.multiply(nn,xu),z.integer(2)),hu=M.divide(M.multiply(el,Ve),Ka),rl=Jt.simplify(he.add_all([co,Xn,hu])),nl=st,If=M.divide(M.multiply(nn,el),z.integer(2)),ns=M.divide(M.multiply(xu,Ve),Ka),Au=Jt.simplify(he.add_all([nl,If,ns]));return[on,rl,Au]}function QO(e,t,r,n,i){let{R_DELTA0_toBeCheckedIfZero:o,R_m_b_over_3a:s,R_DELTA0:u,R_b3:c,R_a_b_c:f}=i;if(br.isZeroAtomOrTensor(o))return it.debug(" cubic: DETERMINANT IS ZERO and delta0 is zero"),[s];it.debug(" cubic: DETERMINANT IS ZERO and delta0 is not zero");let _=M.divide(he.subtract(M.multiply(e,M.multiply(n,z.integer(9))),M.multiply(t,r)),M.multiply(u,z.integer(2))),w=M.negate(c),T=M.negate(M.multiply(e,M.multiply(e,M.multiply(n,z.integer(9))))),k=M.multiply(f,z.integer(4)),V=M.divide(he.add_all([k,T,w]),M.multiply(e,u));return[_,_,V]}function WO(e,t,r,n,i){return it.debug(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),br.isZeroAtomOrTensor(t)&&br.isZeroAtomOrTensor(n)&&!br.isZeroAtomOrTensor(r)&&!br.isZeroAtomOrTensor(i)?JO(e,t,r,n,i):br.isZeroAtomOrTensor(t)?KO(e,t,r,n,i):eM(e,t,r,n,i)}function JO(e,t,r,n,i){it.debug("biquadratic case");let o=Dl(he.add(M.multiply(e,He.power(cr.symbol(Le.SECRETX),z.integer(2))),he.add(M.multiply(r,cr.symbol(Le.SECRETX)),i)),cr.symbol(Le.SECRETX)),s=[];for(let u of o.tensor.elem)s.push(Jt.simplify(He.power(u,z.rational(1,2)))),s.push(Jt.simplify(M.negate(He.power(u,z.rational(1,2)))));return s}function KO(e,t,r,n,i){let o=r,s=n,u=i,c=M.multiply(z.rational(5,2),o),f=he.subtract(M.multiply(z.integer(2),He.power(o,z.integer(2))),u),_=he.add(M.multiply(z.rational(-1,2),M.multiply(o,u)),he.add(M.divide(He.power(o,z.integer(3)),z.integer(2)),M.multiply(z.rational(-1,8),He.power(s,z.integer(2))))),w=he.add(He.power(cr.symbol(Le.SECRETX),z.integer(3)),he.add(M.multiply(c,He.power(cr.symbol(Le.SECRETX),z.integer(2))),he.add(M.multiply(f,cr.symbol(Le.SECRETX)),_)));it.debug(`resolventCubic: ${w}`);let T=Dl(w,cr.symbol(Le.SECRETX));it.debug(`resolventCubicSolutions: ${T}`);let k=null;for(let qr of T.tensor.elem){it.debug(`examining solution: ${qr}`);let It=Oc.absValFloat(he.add(M.multiply(qr,z.integer(2)),o));if(it.debug(`abs value is: ${qr}`),!br.isZeroAtomOrTensor(It)){k=qr;break}}it.debug(`chosen solution: ${k}`);let V=Jt.simplify(He.power(he.add(M.multiply(k,z.integer(2)),o),z.rational(1,2))),Y=Jt.simplify(M.divide(M.multiply(s,z.integer(2)),V)),Ae=he.add(M.multiply(o,z.integer(3)),M.multiply(k,z.integer(2))),tt=Jt.simplify(He.power(M.negate(he.add(Ae,Y)),z.rational(1,2))),Ve=M.divide(he.add(V,tt),z.integer(2)),ke=Jt.simplify(He.power(M.negate(he.add(Ae,Y)),z.rational(1,2))),st=M.divide(he.subtract(V,ke),z.integer(2)),Oe=Jt.simplify(He.power(M.negate(he.subtract(Ae,Y)),z.rational(1,2))),at=M.divide(he.add(M.negate(V),Oe),z.integer(2)),ir=Jt.simplify(He.power(M.negate(he.subtract(Ae,Y)),z.rational(1,2))),Gt=M.divide(he.subtract(M.negate(V),ir),z.integer(2));return[Ve,st,at,Gt]}function eM(e,t,r,n,i){let o=M.divide(he.add(M.multiply(z.integer(8),M.multiply(r,e)),M.multiply(z.integer(-3),He.power(t,z.integer(2)))),M.multiply(z.integer(8),He.power(e,z.integer(2)))),s=M.divide(he.add(He.power(t,z.integer(3)),he.add(M.multiply(z.integer(-4),M.multiply(e,M.multiply(t,r))),M.multiply(z.integer(8),M.multiply(n,He.power(e,z.integer(2)))))),M.multiply(z.integer(8),He.power(e,z.integer(3)))),u=M.multiply(M.multiply(e,e),e),c=M.multiply(t,t),f=M.multiply(M.multiply(e,e),n),_=M.divide(he.add(M.multiply(He.power(t,z.integer(4)),z.integer(-3)),he.add(M.multiply(z.integer(256),M.multiply(u,i)),he.add(M.multiply(z.integer(-64),M.multiply(f,t)),M.multiply(z.integer(16),M.multiply(c,M.multiply(e,r)))))),M.multiply(z.integer(256),He.power(e,z.integer(4)))),w=He.power(cr.symbol(Le.SECRETX),z.integer(4)),T=M.multiply(o,He.power(cr.symbol(Le.SECRETX),z.integer(2))),k=M.multiply(s,cr.symbol(Le.SECRETX)),V=Jt.simplify(he.add_all([w,T,k,_])),Y=Dl(V,cr.symbol(Le.SECRETX));return it.debug(`p for depressed quartic: ${o}`),it.debug(`q for depressed quartic: ${s}`),it.debug(`r for depressed quartic: ${_}`),it.debug(`4 * x^4: ${w}`),it.debug(`R_p * x^2: ${T}`),it.debug(`R_q * x: ${k}`),it.debug(`R_r: ${_}`),it.debug(`solving depressed quartic: ${V}`),it.debug(`depressedSolutions: ${Y}`),Y.tensor.elem.map(Ae=>{let tt=Jt.simplify(he.subtract(Ae,M.divide(t,M.multiply(z.integer(4),e))));return it.debug(`solution from depressed: ${tt}`),tt})}});var Ev=A(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.simfac=void 0;var be=N(),Km=$(),vv=Ie(),Vi=ce(),o4=G(),Tc=po(),fn=Q(),ca=X();function tM(e){if(be.isadd(e)){let t=e.tail().map(qv);return Vi.add_all(t)}return qv(e)}Nc.simfac=tM;function qv(e){if(!be.ismultiply(e))return e;let t=e.tail();for(;rM(t););return ca.multiply_all_noexpand(t)}function rM(e){for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<e.length;n++){if(t===n)continue;let i=e[n];if(be.isfactorial(r)&&be.ispower(i)&&fn.isminusone(be.caddr(i))&&vv.equal(be.cadr(r),be.cadr(i)))return e[t]=Tc.factorial(Vi.subtract(be.cadr(r),be.Constants.one)),e[n]=be.Constants.one,!0;if(be.ispower(i)&&fn.isminusone(be.caddr(i))&&be.caadr(i)===Km.symbol(be.FACTORIAL)&&vv.equal(r,be.cadadr(i)))return e[t]=ca.reciprocate(Tc.factorial(Vi.add(r,be.Constants.negOne))),e[n]=be.Constants.one,!0;if(be.isfactorial(i)){let o=Vi.subtract(r,be.cadr(i));if(fn.isplusone(o))return e[t]=Tc.factorial(r),e[n]=be.Constants.one,!0}if(be.ispower(r)&&fn.isminusone(be.caddr(r))&&be.ispower(i)&&fn.isminusone(be.caddr(i))&&be.caadr(i)===Km.symbol(be.FACTORIAL)){let o=Vi.subtract(be.cadr(r),be.cadr(be.cadr(i)));if(fn.isplusone(o))return e[t]=ca.reciprocate(Tc.factorial(be.cadr(r))),e[n]=be.Constants.one,!0}if(be.isfactorial(r)&&be.ispower(i)&&fn.isminusone(be.caddr(i))&&be.caadr(i)===Km.symbol(be.FACTORIAL)){let o=Vi.subtract(be.cadr(r),be.cadr(be.cadr(i)));if(fn.isplusone(o))return e[t]=be.cadr(r),e[n]=be.Constants.one,!0;if(fn.isminusone(o))return e[t]=ca.reciprocate(be.cadr(be.cadr(i))),e[n]=be.Constants.one,!0;if(fn.equaln(o,2))return e[t]=be.cadr(r),e[n]=Vi.add(be.cadr(r),be.Constants.negOne),!0;if(fn.equaln(o,-2))return e[t]=ca.reciprocate(be.cadr(be.cadr(i))),e[n]=ca.reciprocate(Vi.add(be.cadr(be.cadr(i)),be.Constants.negOne)),!0}}}return!1}});var e_=A(da=>{"use strict";Object.defineProperty(da,"__esModule",{value:!0});da.decomp=da.Eval_decomp=void 0;var ze=N(),kl=or(),xv=$(),pv=Ie(),nM=ce(),hv=G(),iM=Vr(),oM=ee(),Av=X();function sM(e){console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!");let t=hv.Eval(ze.cadr(e));e=hv.Eval(ze.caddr(e));let r=e===xv.symbol(ze.NIL)?iM.guess(t):e,n=Ul(!1,t,r);return oM.makeList(xv.symbol(ze.NIL),...n)}da.Eval_decomp=sM;function aM(e,t){return e.length>0&&pv.equal(t,e[e.length-1])?!1:(e.push(t),!0)}function Ul(e,t,r){if(ze.DEBUG&&console.log(`DECOMPOSING ${t}`),e){if(!ze.iscons(t))return ze.DEBUG&&console.log(` ground thing: ${t}`),[t]}else if(!kl.Find(t,r))return ze.DEBUG&&console.log(" entire expression is constant"),[t];if(ze.isadd(t))return lM(e,t,r);if(ze.ismultiply(t))return uM(e,t,r);let n=ze.cdr(t);ze.DEBUG&&(console.log(" naive decomp"),console.log(`startig p3: ${n}`));let i=[];for(;ze.iscons(n);)e&&i.push(ze.car(n)),ze.DEBUG&&(console.log("recursive decomposition"),console.log(`car(p3): ${ze.car(n)}`),console.log(`p2: ${r}`)),i.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);return i}da.decomp=Ul;function lM(e,t,r){ze.DEBUG&&console.log(" decomposing the sum ");let n=ze.cdr(t),i=[];for(;ze.iscons(n);)(kl.Find(ze.car(n),r)||e)&&i.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);n=ze.cdr(t);let o=[...n].filter(s=>!kl.Find(s,r));return o.length&&(n=nM.add_all(o),aM(i,n),i.push(Av.negate(n))),i}function uM(e,t,r){ze.DEBUG&&console.log(" decomposing the product ");let n=ze.cdr(t),i=[];for(;ze.iscons(n);)(kl.Find(ze.car(n),r)||e)&&i.push(...Ul(e,ze.car(n),r)),n=ze.cdr(n);n=ze.cdr(t);let o=[];for(;ze.iscons(n);){let s=ze.car(n);kl.Find(s,r)||(o.length<1||!pv.equal(s,o[o.length-1]))&&o.push(s),n=ze.cdr(n)}return o.length>0&&i.push(Av.multiply_all(o)),i}});var r_=A(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.transform=void 0;var ie=N(),Te=$(),cM=ce(),dM=n_(),fM=e_(),Ic=G(),Ov=Q(),mM=ee(),_M=zi(),t_=Zr();function Mv(e,t,r,n){ie.DEBUG&&console.log(`         !!!!!!!!!   transform on: ${e}`);let i=bM();Te.set_binding(Te.symbol(ie.METAX),t);let o=dM.polyform(e,t),s=fM.decomp(n,o,t);if(ie.DEBUG){console.log(`  ${s.length} decomposed elements ====== `);for(let _=0;_<s.length;_++)console.log(`  decomposition element ${_}: ${s[_]}`)}let u=!1,c;if(n){if(!ie.isNumericAtom(e)){let _=r;ie.DEBUG&&(console.log(`applying transform: ${_}`),console.log(`scanning table entry ${_}`));let w=t_.subst(_,Te.symbol(ie.SYMBOL_A_UNDERSCORE),Te.symbol(ie.METAA));w=t_.subst(w,Te.symbol(ie.SYMBOL_B_UNDERSCORE),Te.symbol(ie.METAB));let T=t_.subst(w,Te.symbol(ie.SYMBOL_X_UNDERSCORE),Te.symbol(ie.METAX)),k=ie.car(T);ie.DEBUG&&console.log(`template expression: ${k}`),c=ie.cadr(T);let V=ie.cddr(T);if(Tv([ie.Constants.one,...s],n,e,k,V))u=!0;else{ie.DEBUG&&(console.log(`p3 at this point: ${e}`),console.log(`car(p3): ${ie.car(e)}`));let Y=[],Ae=e;for(ie.iscons(Ae)&&(Y.push(ie.car(e)),Ae=ie.cdr(e));ie.iscons(Ae);){let tt=ie.car(Ae);Ae=ie.cdr(Ae),ie.DEBUG&&(console.log(`testing: ${tt}`),console.log(`about to try to simplify other term: ${tt}`));let[Ve,ke]=Mv(tt,Te.symbol(ie.NIL),r,n);u=u||ke,Y.push(Ve),ie.DEBUG&&console.log(`tried to simplify other term: ${tt} ...successful?: ${ke} ...transformed: ${Y[Y.length-1]}`)}Y.length!==0&&(c=mM.makeList(...Y))}}}else for(let _ of Array.from(r))if(ie.DEBUG&&(console.log(`scanning table entry ${_}`),(_+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1&&ie.breakpoint),_){let w=_M.scan_meta(_),T=ie.cadr(w);c=ie.caddr(w);let k=ie.cdddr(w);if(Tv([ie.Constants.one,...s],n,e,T,k)){u=!0;break}}let f=u?Ic.Eval(c):n?e:Te.symbol(ie.NIL);return gM(i),[f,u]}Sc.transform=Mv;function bM(){return{METAA:Te.get_binding(Te.symbol(ie.METAA)),METAB:Te.get_binding(Te.symbol(ie.METAB)),METAX:Te.get_binding(Te.symbol(ie.METAX))}}function gM(e){Te.set_binding(Te.symbol(ie.METAX),e.METAX),Te.set_binding(Te.symbol(ie.METAB),e.METAB),Te.set_binding(Te.symbol(ie.METAA),e.METAA)}function Tv(e,t,r,n,i){for(let o of e){Te.set_binding(Te.symbol(ie.METAA),o),ie.DEBUG&&console.log(`  binding METAA to ${Te.get_binding(Te.symbol(ie.METAA))}`);for(let s of e){Te.set_binding(Te.symbol(ie.METAB),s),ie.DEBUG&&console.log(`  binding METAB to ${Te.get_binding(Te.symbol(ie.METAB))}`);let u=i;for(;ie.iscons(u);){let f=Ic.Eval(ie.car(u));if(Ov.isZeroAtomOrTensor(f))break;u=ie.cdr(u)}if(ie.iscons(u))continue;let c=t?ie.noexpand(Ic.Eval,n):Ic.Eval(n);if(ie.DEBUG&&(console.log(`about to evaluate template expression: ${n} binding METAA to ${Te.get_binding(Te.symbol(ie.METAA))} and binding METAB to ${Te.get_binding(Te.symbol(ie.METAB))} and binding METAX to ${Te.get_binding(Te.symbol(ie.METAX))}`),console.log(`  comparing ${c} to: ${r}`)),Ov.isZeroAtomOrTensor(cM.subtract(r,c)))return ie.DEBUG&&(console.log(`binding METAA to ${Te.get_binding(Te.symbol(ie.METAA))}`),console.log(`binding METAB to ${Te.get_binding(Te.symbol(ie.METAB))}`),console.log(`binding METAX to ${Te.get_binding(Te.symbol(ie.METAX))}`),console.log(`comparing ${r} to: ${n}`)),!0}}return!1}});var s_=A(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.transpose=_a.Eval_transpose=void 0;var yM=St(),$e=N(),vM=Ee(),fa=$(),ma=Ie(),qM=ce(),i_=j(),o_=G(),EM=Bi(),Cr=Q(),Nv=ee(),xM=X();function pM(e){let t=o_.Eval($e.cadr(e)),r=$e.Constants.one,n=i_.integer(2);return $e.cddr(e)!==fa.symbol($e.NIL)&&(r=o_.Eval($e.caddr(e)),n=o_.Eval($e.cadddr(e))),$l(t,r,n)}_a.Eval_transpose=pM;function $l(e,t,r){let n=0,i=Array($e.MAXDIM).fill(0),o=Array($e.MAXDIM).fill(0);if($e.isNumericAtom(e)||(Cr.isplusone(t)&&Cr.isplustwo(r)||Cr.isplusone(r)&&Cr.isplustwo(t))&&$e.isidentitymatrix(e))return e;if($e.istranspose(e)){let T=$e.car($e.cdr($e.cdr(e))),k=$e.car($e.cdr($e.cdr($e.cdr(e))));if(ma.equal(T,r)&&ma.equal(k,t)||ma.equal(k,r)&&ma.equal(T,t)||ma.equal(T,fa.symbol($e.NIL))&&ma.equal(k,fa.symbol($e.NIL))&&(Cr.isplusone(r)&&Cr.isplustwo(t)||Cr.isplusone(t)&&Cr.isplustwo(r)))return $e.car($e.cdr(e))}if($e.defs.expanding&&$e.isadd(e))return e.tail().reduce((T,k)=>qM.add(T,$l(k,t,r)),$e.Constants.zero);if($e.defs.expanding&&$e.ismultiply(e))return e.tail().reduce((T,k)=>xM.multiply(T,$l(k,t,r)),$e.Constants.one);if($e.defs.expanding&&$e.isinnerordot(e)){let T=[];return $e.iscons(e)&&T.push(...e.tail().map(k=>[k,t,r])),T.reverse(),T.reduce((k,V)=>EM.inner(k,$l(V[0],V[1],V[2])),fa.symbol($e.SYMBOL_IDENTITY_MATRIX))}if(!$e.istensor(e))return Cr.isZeroAtomOrTensor(e)?$e.Constants.zero:(!Cr.isplusone(t)||!Cr.isplustwo(r))&&(!Cr.isplusone(r)||!Cr.isplustwo(t))?Nv.makeList(fa.symbol($e.TRANSPOSE),e,t,r):Nv.makeList(fa.symbol($e.TRANSPOSE),e);let{ndim:s,nelem:u}=e.tensor;if(s===1)return e;let c=i_.nativeInt(t),f=i_.nativeInt(r);(c<1||c>s||f<1||f>s)&&vM.stop("transpose: index out of range"),c--,f--,t=yM.alloc_tensor(u),t.tensor.ndim=s,t.tensor.dim=[...e.tensor.dim],t.tensor.dim[c]=e.tensor.dim[f],t.tensor.dim[f]=e.tensor.dim[c];let _=e.tensor.elem,w=t.tensor.elem;for(let T=0;T<s;T++)i[T]=0,o[T]=e.tensor.dim[T];for(let T=0;T<u;T++){n=i[c],i[c]=i[f],i[f]=n,n=o[c],o[c]=o[f],o[f]=n;let k=0;for(let V=0;V<s;V++)k=k*o[V]+i[V];n=i[c],i[c]=i[f],i[f]=n,n=o[c],o[c]=o[f],o[f]=n,w[k]=_[T];for(let V=s-1;V>=0&&!(++i[V]<o[V]);V--)i[V]=0}return t}_a.transpose=$l});var Zi=A(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.simplify_trig=Rn.simplify=Rn.simplifyForCodeGeneration=Rn.Eval_simplify=void 0;var hM=St(),mt=Ac(),I=N(),Oo=or(),a_=Ee(),Qe=$(),fi=ce(),Dt=j(),AM=Pu(),l_=bl(),Mo=G(),To=wn(),OM=Bi(),$t=Q(),Iv=ee(),ba=Ie(),Be=X(),MM=Du(),mn=Et(),Xi=gl(),No=$s(),TM=ei(),NM=Jm(),Sv=Ev(),IM=qt(),SM=r_(),wM=s_(),RM=Mn(),wv=_o(),u_=dl(),LM=oi();function CM(e){let t=Rv(I.cadr(e));return Qr(Mo.Eval(t))}Rn.Eval_simplify=CM;function Rv(e){if(I.defs.userSimplificationsInListForm.length===0||Oo.Find(e,Qe.symbol(I.INTEGRAL)))return e;I.DEBUG&&console.log(`runUserDefinedSimplifications passed: ${e}`);let t=I.noexpand(Mo.Eval,e);if(I.DEBUG){console.log(`runUserDefinedSimplifications after eval no expanding: ${t}`),console.log("patterns to be checked: ");for(let i of Array.from(I.defs.userSimplificationsInListForm))console.log(`...${i}`)}let r=!0,n=0;for(;r&&n<I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;){r=!1,n++;for(let i of Array.from(I.defs.userSimplificationsInListForm)){let o=!0,s=0;for(;o&&s<I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)s++,I.DEBUG&&console.log(`simplify - checking pattern: ${i} on: ${t}`),[t,o]=SM.transform(t,Qe.symbol(I.NIL),i,!0),o&&(r=!0),I.DEBUG&&console.log(`p1 at this stage of simplification: ${t}`);s===I.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&a_.stop(`maximum application of single transformation rule exceeded: ${i}`)}}return n===I.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&a_.stop("maximum application of all transformation rules exceeded "),I.DEBUG&&(console.log(`METAX = ${Qe.get_binding(Qe.symbol(I.METAX))}`),console.log(`METAA = ${Qe.get_binding(Qe.symbol(I.METAA))}`),console.log(`METAB = ${Qe.get_binding(Qe.symbol(I.METAB))}`)),t}function PM(e){let t=Rv(e);I.defs.codeGen=!0;let r=Qr(t);return I.defs.codeGen=!1,r}Rn.simplifyForCodeGeneration=PM;function Qr(e){if(I.defs.codeGen&&I.car(e)===Qe.symbol(I.FUNCTION)){let t=I.cadr(e),r=Qr(Mo.Eval(t)),n=I.caddr(e);e=Iv.makeList(Qe.symbol(I.FUNCTION),r,n)}if(I.istensor(e))return DM(e);if(Oo.Find(e,Qe.symbol(I.FACTORIAL))){let t=Sv.simfac(e),r=Sv.simfac(Xi.rationalize(e));e=mt.count(t)<mt.count(r)?t:r}if(e=BM(e),e=kM(e),e=UM(e),e=$M(e),e=GM(e),e=Lv(e),e=jM(e),e=YM(e),I.do_simplify_nested_radicals){let t;if([t,e]=ZM(e),t)return I.DEBUG&&console.log("de-nesting successful into: "+e.toString()),Qr(e)}return e=zM(e),e=Cv(e),e}Rn.simplify=Qr;function DM(e){let t=hM.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=e.tensor.elem.map(Qr),IM.check_tensor_dimensions(t),$t.isZeroAtomOrTensor(t)&&(t=I.Constants.zero),t}function kM(e){if(!I.isadd(e))return e;let t=Xi.rationalize(e);return mt.count(t)<mt.count(e)&&(e=t),e}function UM(e){if(!I.isadd(e))return e;let t=l_.Condense(e);return mt.count(t)<=mt.count(e)&&(e=t),e}function $M(e){let t=Xi.rationalize(Be.negate(Xi.rationalize(Be.negate(Xi.rationalize(e)))));return mt.count(t)<mt.count(e)&&(e=t),e}function BM(e){let t=I.car(e);if((t===Qe.symbol(I.MULTIPLY)||I.isinnerordot(e))&&I.car(I.car(I.cdr(e)))===Qe.symbol(I.TRANSPOSE)&&I.car(I.car(I.cdr(I.cdr(e))))===Qe.symbol(I.TRANSPOSE)){I.DEBUG&&console.log(`maybe collecting a transpose ${e}`);let r=I.cadr(I.car(I.cdr(e))),n=I.cadr(I.car(I.cdr(I.cdr(e)))),i;t===Qe.symbol(I.MULTIPLY)?i=Be.multiply(r,n):I.isinnerordot(e)?i=OM.inner(n,r):i=a_.stop("f10: nothing to pop.");let o=I.noexpand(()=>wM.transpose(i,I.Constants.one,Dt.integer(2)));mt.count(o)<mt.count(e)&&(e=o),I.DEBUG&&console.log(`collecting a transpose ${o}`)}return e}function GM(e){if($t.isZeroAtomOrTensor(e))return e;let t=Xi.rationalize(Be.inverse(Xi.rationalize(Be.inverse(Xi.rationalize(e)))));return mt.count(t)<mt.count(e)&&(e=t),e}function FM(e){return Lv(e)}Rn.simplify_trig=FM;function Lv(e){if(!Oo.Find(e,Qe.symbol(I.SIN))&&!Oo.Find(e,Qe.symbol(I.COS)))return e;let t=e;I.defs.trigmode=1;let r=Mo.Eval(t);I.defs.trigmode=2;let n=Mo.Eval(t);return I.defs.trigmode=0,(mt.count(n)<mt.count(r)||wc(n)<wc(r))&&(r=n),(mt.count(r)<mt.count(e)||wc(r)<wc(e))&&(e=r),e}function jM(e){if(!I.isadd(e))return e;let t=I.cdr(e);return I.iscons(t)&&(t=[...t].reduce((r,n)=>Cv(fi.add(r,Qr(n))),I.Constants.zero)),mt.count(t)<mt.count(e)&&(e=t),e}function Cv(e){var t,r,n,i,o;if(t=RM.denominator(e),$t.isone(t)||(r=LM.numerator(e),$t.isone(r))||!(i=wv.areunivarpolysfactoredorexpandedform(r,t))||(o=u_.factor(wv.gcd(r,t),i),$t.isone(o)))return e;let s=u_.factor(r,i),u=Be.inverse(o),c=Be.multiply_noexpand(s,u),f=Qr(c),_=u_.factor(t,i),w=Be.multiply_noexpand(_,u),T=Qr(w),k=Be.divide(f,T);return n=l_.Condense(k),mt.count(n)<mt.count(e)?n:e}function zM(e){let t;return!Oo.Find(e,Qe.symbol(I.SIN))&&!Oo.Find(e,Qe.symbol(I.COS))||(t=AM.clockform(Mo.Eval(e)),I.DEBUG&&console.log(`before simplification clockform: ${e} after: ${t}`),mt.count(t)<mt.count(e)&&(e=t)),e}function YM(e){let t=c_(e),r=Mo.Eval(t);return mt.count(r)<mt.count(e)&&(e=r),e}function c_(e){if($t.isimaginaryunit(e))return e;if(ba.equal(I.car(e),Qe.symbol(I.POWER))&&$t.isminusone(I.cadr(e))){let t=Be.negate(I.Constants.one),r=c_(I.caddr(e));return TM.rect(MM.polar(mn.power(t,r)))}else return I.iscons(e)?e.map(c_):e}function wc(e){return I.isadd(e)?ba.length(e)-1:1}function ZM(e){if(I.defs.recursionLevelNestedRadicalsRemoval>0)return I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[!1,e];let[t,r]=Rc(e),n=I.noexpand(l_.yycondense,t);return e=mt.countOccurrencesOfSymbol(Qe.symbol(I.POWER),t)<mt.countOccurrencesOfSymbol(Qe.symbol(I.POWER),n)?t:n,[r,e]}function Rc(e){return I.defs.recursionLevelNestedRadicalsRemoval>0?(I.DEBUG&&console.log("denesting bailing out because of too much recursion"),[e,!1]):ba.equal(I.car(e),Qe.symbol(I.POWER))?VM(e):I.iscons(e)?HM(e):[e,!1]}function VM(e){let t=I.cadr(e),r=I.caddr(e);if($t.isminusone(r)||!ba.equal(I.car(t),Qe.symbol(I.ADD))||!$t.isfraction(r)||!$t.equalq(r,1,3)&&!$t.equalq(r,1,2))return[e,!1];let n=I.cadr(t);Rc(n);let i=I.caddr(t);Rc(i);let o=0,s=t;for(;I.cdr(s)!==Qe.symbol(I.NIL);)o++,s=I.cdr(s);if(o>2)return[e,!1];let{commonBases:u,termsThatAreNotPowers:c}=XM(i);if(u.length===0)return[e,!1];let f=n,_=u.reduce(Be.multiply,I.Constants.one),w=c.reduce(Be.multiply,I.Constants.one),T;if($t.equalq(r,1,3)){let ke=Be.divide(Be.multiply(Be.negate(f),_),w),st=Dt.nativeDouble(To.yyfloat(No.real(ke)));if(Math.abs(st)>Math.pow(2,32))return[e,!1];let Oe=Be.multiply(Dt.integer(3),_),at=Dt.nativeDouble(To.yyfloat(No.real(Oe)));if(Math.abs(at)>Math.pow(2,32))return[e,!1];let ir=Be.multiply(Oe,Qe.symbol(I.SECRETX)),Gt=Be.divide(Be.multiply(Dt.integer(-3),f),w),qr=Dt.nativeDouble(To.yyfloat(No.real(Gt)));if(Math.abs(qr)>Math.pow(2,32))return[e,!1];T=fi.add_all([ke,ir,Be.multiply(Gt,mn.power(Qe.symbol(I.SECRETX),Dt.integer(2))),Be.multiply(I.Constants.one,mn.power(Qe.symbol(I.SECRETX),Dt.integer(3)))])}else if($t.equalq(r,1,2)){let ke=Dt.nativeDouble(To.yyfloat(No.real(_)));if(Math.abs(ke)>Math.pow(2,32))return[e,!1];let st=Be.divide(Be.multiply(Dt.integer(-2),f),w),Oe=Dt.nativeDouble(To.yyfloat(No.real(st)));if(Math.abs(Oe)>Math.pow(2,32))return[e,!1];T=fi.add(_,fi.add(Be.multiply(st,Qe.symbol(I.SECRETX)),Be.multiply(I.Constants.one,mn.power(Qe.symbol(I.SECRETX),Dt.integer(2)))))}I.defs.recursionLevelNestedRadicalsRemoval++;let k=NM.roots(T,Qe.symbol(I.SECRETX));if(I.defs.recursionLevelNestedRadicalsRemoval--,ba.equal(k,Qe.symbol(I.NIL)))return I.DEBUG&&console.log("roots bailed out because of too much recursion"),[e,!1];let V=k.elem.filter(ke=>!Oo.Find(ke,Qe.symbol(I.POWER)));if(V.length===0)return[e,!1];let Y=[],Ae=[];for(let ke of Array.from(V)){let st=Dt.nativeDouble(To.yyfloat(No.real(ke)));Y.push(ke),Ae.push(st)}let tt=Ae.indexOf(Math.max.apply(Math,Ae)),Ve=Y[tt];if(!$t.equalq(r,1,3)&&!$t.equalq(r,1,2))return[e,!1];if($t.equalq(r,1,3)){let ke=mn.power(Be.divide(f,fi.add(mn.power(Ve,Dt.integer(3)),Be.multiply(Be.multiply(Dt.integer(3),_),Ve))),Dt.rational(1,3)),st=Be.multiply(ke,Ve);return[Qr(fi.add(Be.multiply(ke,mn.power(_,Dt.rational(1,2))),st)),!0]}if($t.equalq(r,1,2)){let ke=mn.power(Be.divide(f,fi.add(mn.power(Ve,Dt.integer(2)),_)),Dt.rational(1,2)),st=Be.multiply(ke,Ve),Oe=Qr(fi.add(Be.multiply(ke,mn.power(_,Dt.rational(1,2))),st)),at=To.yyfloat(No.real(Oe));return $t.isnegativenumber(at)?[Qr(fi.add(Be.multiply(Be.negate(ke),mn.power(_,Dt.rational(1,2))),Be.negate(st))),!0]:[Oe,!0]}return[null,!0]}function XM(e){let t=null,r=[],n=[];if(I.ismultiply(e)){let i=I.cdr(e);if(I.iscons(i))for(;I.iscons(i);){let o=I.car(i);if(I.ispower(o)){let s=I.cadr(o),u=I.caddr(o);$t.equalq(u,1,2)&&(t==null?(t=u,r.push(s)):ba.equal(u,t)&&r.push(s))}else n.push(o);i=I.cdr(i)}}else if(I.ispower(e)){let i=I.cadr(e),o=I.caddr(e);t==null&&$t.equalq(o,1,2)&&(t=o,r.push(i))}return{commonBases:r,termsThatAreNotPowers:n}}function HM(e){let t=!1,r=[];if(I.iscons(e)){let n=Array.from(e).map(i=>{if(!t){let o;return[o,t]=Rc(i),o}return i});r.push(...n)}return[Iv.makeList(...r),t]}});var Gl=A(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.make_hashed_itab=Hi.integral=Hi.Eval_integral=void 0;var me=N(),ga=or(),Pv=Ee(),Ln=$(),QM=Ie(),WM=ce(),Dv=j(),JM=wo(),Io=G(),kv=Vr(),Bl=Q(),Uv=ee(),KM=X(),eT=sv(),tT=zi(),rT=Zi(),nT=r_(),iT=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"];function oT(e){let t=0;e=me.cdr(e);let r=Io.Eval(me.car(e));e=me.cdr(e);let n=Io.Eval(me.car(e)),i,o;for(n===Ln.symbol(me.NIL)?(o=kv.guess(r),i=Ln.symbol(me.NIL)):me.isNumericAtom(n)?(o=kv.guess(r),i=n):(o=n,e=me.cdr(e),i=Io.Eval(me.car(e)));;){me.isNumericAtom(i)?(t=Dv.nativeInt(i),isNaN(t)&&Pv.stop("nth integral: check n")):t=1;let s=r;if(t>=0)for(let u=0;u<t;u++)s=Lc(s,o);else{t=-t;for(let u=0;u<t;u++)s=JM.derivative(s,o)}if(r=s,i===Ln.symbol(me.NIL))break;if(me.isNumericAtom(i)){if(e=me.cdr(e),i=Io.Eval(me.car(e)),i===Ln.symbol(me.NIL))break;me.isNumericAtom(i)||(o=i,e=me.cdr(e),i=Io.Eval(me.car(e)))}else o=i,e=me.cdr(e),i=Io.Eval(me.car(e))}return r}Hi.Eval_integral=oT;function Lc(e,t){let r;return me.isadd(e)?r=sT(e,t):me.ismultiply(e)?r=aT(e,t):r=$v(e,t),ga.Find(r,Ln.symbol(me.INTEGRAL))&&Pv.stop("integral: sorry, could not find a solution"),Io.Eval(rT.simplify(r))}Hi.integral=Lc;function sT(e,t){e=me.cdr(e);let r=Lc(me.car(e),t);return me.iscons(e)&&(r=e.tail().reduce((n,i)=>WM.add(n,Lc(i,t)),r)),r}function aT(e,t){let[r,n]=eT.partition(e,t);return KM.multiply(r,$v(n,t))}function $v(e,t){let r=So(e,t).toFixed(6),n=fT[r];if(!n)return Uv.makeList(Ln.symbol(me.INTEGRAL),e,t);let[i,o]=nT.transform(e,t,n,!1);return i===Ln.symbol(me.NIL)?Uv.makeList(Ln.symbol(me.INTEGRAL),e,t):i}var Cn={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916};function So(e,t){if(me.issymbol(e))return QM.equal(e,t)?Cn.x:Cn.constant;if(me.iscons(e)){let n=me.car(e);switch(me.issymbol(n)&&n.printname){case me.ADD:return uT(me.cdr(e),t);case me.MULTIPLY:return cT(me.cdr(e),t);case me.POWER:return d_(me.cadr(e),me.caddr(e),t);case me.EXP:return d_(Ln.symbol(me.E),me.cadr(e),t);case me.SQRT:var r=Dv.double(.5);return d_(me.cadr(e),r,t);default:return lT(e,t)}}return Cn.constant}function lT(e,t){if(!ga.Find(me.cadr(e),t))return Cn.constant;let r=me.car(e),n=So(me.cadr(e),t),i=Cn[r.printname];if(!i)throw new Error("Unsupported function "+r.printname);return Math.pow(i,n)}function uT(e,t){let r={};for(;me.iscons(e);){let i=me.car(e);e=me.cdr(e);let o=0;ga.Find(i,t)?o=So(i,t):o=Cn.constant,r[o.toFixed(6)]=!0}let n=0;for(let i of Object.keys(r||{})){let o=r[i];n=n+Number(i)}return n}function cT(e,t){let r=1;return me.iscons(e)&&[...e].forEach(n=>{ga.Find(n,t)&&(r=r*So(n,t))}),r}function d_(e,t,r){let n=Cn.constant,i=Cn.constexp;if(ga.Find(e,r)&&(n=So(e,r)),ga.Find(t,r))i=So(t,r);else{if(n===Cn.constant)return Cn.constant;Bl.isminusone(t)?i=-1:Bl.isoneovertwo(t)?i=.5:Bl.isminusoneovertwo(t)?i=-.5:Bl.equalq(t,2,1)?i=2:Bl.equalq(t,-2,1)&&(i=-2)}return Math.pow(n,i)}function dT(){let e={};for(let t of Array.from(iT)){let r=tT.scan_meta(t),n=me.cadr(r),o=So(n,Ln.symbol(me.METAX)).toFixed(6);e[o]||(e[o]=[]),e[o].push(t)}return console.log(`hashed_itab = ${JSON.stringify(e,null,2)}`),e}Hi.make_hashed_itab=dT;var fT={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]}});var b_=A(ya=>{"use strict";Object.defineProperty(ya,"__esModule",{value:!0});ya.logarithm=ya.Eval_log=void 0;var Pr=N(),Bv=$(),f_=ce(),mT=j(),_T=Mn(),bT=G(),m_=Q(),gT=ee(),__=X(),yT=oi();function vT(e){return Ro(bT.Eval(Pr.cadr(e)))}ya.Eval_log=vT;function Ro(e){return e===Bv.symbol(Pr.E)?Pr.Constants.one:m_.equaln(e,1)?Pr.Constants.zero:m_.isnegativenumber(e)?f_.add(Ro(__.negate(e)),__.multiply(Pr.Constants.imaginaryunit,Pr.Constants.Pi())):Pr.isdouble(e)?mT.double(Math.log(e.d)):m_.isfraction(e)?f_.subtract(Ro(yT.numerator(e)),Ro(_T.denominator(e))):Pr.ispower(e)?__.multiply(Pr.caddr(e),Ro(Pr.cadr(e))):Pr.ismultiply(e)?e.tail().map(Ro).reduce(f_.add,Pr.Constants.zero):gT.makeList(Bv.symbol(Pr.LOG),e)}ya.logarithm=Ro});var y_=A(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.sgn=va.Eval_sgn=void 0;var pr=N(),Gv=$(),qT=sn(),ET=G(),Fv=Q(),jv=ee(),zv=un(),g_=X(),xT=Et();function pT(e){return Yv(ET.Eval(pr.cadr(e)))}va.Eval_sgn=pT;function Yv(e){return pr.isdouble(e)?e.d>0||e.d===0?pr.Constants.one:pr.Constants.negOne:pr.isrational(e)?pr.MSIGN(zv.mmul(e.q.a,e.q.b))===-1?pr.Constants.negOne:pr.MZERO(zv.mmul(e.q.a,e.q.b))?pr.Constants.zero:pr.Constants.one:Fv.iscomplexnumber(e)?g_.multiply(xT.power(pr.Constants.negOne,qT.absval(e)),e):Fv.isnegativeterm(e)?g_.multiply(jv.makeList(Gv.symbol(pr.SGN),g_.negate(e)),pr.Constants.negOne):jv.makeList(Gv.symbol(pr.SGN),e)}va.sgn=Yv});var v_=A(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});qa.ysinh=qa.Eval_sinh=void 0;var Lo=N(),Zv=$(),hT=j(),AT=G(),OT=Q(),MT=ee();function TT(e){return Vv(AT.Eval(Lo.cadr(e)))}qa.Eval_sinh=TT;function Vv(e){if(Lo.car(e)===Zv.symbol(Lo.ARCSINH))return Lo.cadr(e);if(Lo.isdouble(e)){let t=Math.sinh(e.d);return Math.abs(t)<1e-10&&(t=0),hT.double(t)}return OT.isZeroAtomOrTensor(e)?Lo.Constants.zero:MT.makeList(Zv.symbol(Lo.SINH),e)}qa.ysinh=Vv});var wo=A(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.derivative=xa.Eval_derivative=void 0;var E=N(),NT=or(),Xv=Ee(),De=$(),Fl=Ie(),Nr=ce(),Cc=Sm(),Hv=wm(),kt=j(),Qv=Ri(),Wv=Rm(),IT=Dm(),Ea=G(),Jv=Vr(),ST=Em(),wT=Gl(),Kv=Q(),jl=ee(),RT=b_(),ve=X(),gr=Et(),LT=y_(),CT=Zi(),PT=Wn(),DT=v_(),e1=Zr(),q_=qt();function kT(e){e=E.cdr(e);let t=Ea.Eval(E.car(e));e=E.cdr(e);let r,n,i=Ea.Eval(E.car(e));for(i===De.symbol(E.NIL)?(r=Jv.guess(t),n=De.symbol(E.NIL)):E.isNumericAtom(i)?(r=Jv.guess(t),n=i):(r=i,e=E.cdr(e),n=Ea.Eval(E.car(e)));;){let o;E.isNumericAtom(n)?(o=kt.nativeInt(n),isNaN(o)&&Xv.stop("nth derivative: check n")):o=1;let s=t;if(o>=0)for(let u=0;u<o;u++)s=rt(s,r);else{o=-o;for(let u=0;u<o;u++)s=wT.integral(s,r)}if(t=s,n===De.symbol(E.NIL))break;if(E.isNumericAtom(n)){if(e=E.cdr(e),n=Ea.Eval(E.car(e)),n===De.symbol(E.NIL))break;E.isNumericAtom(n)||(r=n,e=E.cdr(e),n=Ea.Eval(E.car(e)))}else r=n,e=E.cdr(e),n=Ea.Eval(E.car(e))}return t}xa.Eval_derivative=kT;function rt(e,t){return E.isNumericAtom(t)&&Xv.stop("undefined function"),E.istensor(e)?E.istensor(t)?q_.d_tensor_tensor(e,t):q_.d_tensor_scalar(e,t):E.istensor(t)?q_.d_scalar_tensor(e,t):UT(e,t)}xa.derivative=rt;function UT(e,t){if(E.issymbol(t))return $T(e,t);let r=e1.subst(e,t,De.symbol(E.SECRETX));return e1.subst(rt(r,De.symbol(E.SECRETX)),De.symbol(E.SECRETX),t)}function $T(e,t){if(Fl.equal(e,t))return E.Constants.one;if(!E.iscons(e))return E.Constants.zero;if(E.isadd(e))return BT(e,t);switch(E.car(e)){case De.symbol(E.MULTIPLY):return GT(e,t);case De.symbol(E.POWER):return FT(e,t);case De.symbol(E.DERIVATIVE):return zT(e,t);case De.symbol(E.LOG):return jT(e,t);case De.symbol(E.SIN):return ZT(e,t);case De.symbol(E.COS):return VT(e,t);case De.symbol(E.TAN):return XT(e,t);case De.symbol(E.ARCSIN):return HT(e,t);case De.symbol(E.ARCCOS):return QT(e,t);case De.symbol(E.ARCTAN):return WT(e,t);case De.symbol(E.SINH):return JT(e,t);case De.symbol(E.COSH):return KT(e,t);case De.symbol(E.TANH):return eN(e,t);case De.symbol(E.ARCSINH):return tN(e,t);case De.symbol(E.ARCCOSH):return rN(e,t);case De.symbol(E.ARCTANH):return nN(e,t);case De.symbol(E.ABS):return iN(e,t);case De.symbol(E.SGN):return oN(e,t);case De.symbol(E.HERMITE):return sN(e,t);case De.symbol(E.ERF):return aN(e,t);case De.symbol(E.ERFC):return lN(e,t);case De.symbol(E.BESSELJ):return uN(e,t);case De.symbol(E.BESSELY):return fN(e,t);default:}return E.car(e)===De.symbol(E.INTEGRAL)&&E.caddr(e)===t?bN(e):YT(e,t)}function BT(e,t){let r=E.iscons(e)?e.tail().map(n=>rt(n,t)):[];return Nr.add_all(r)}function GT(e,t){let r=Fl.length(e)-1,n=[];for(let i=0;i<r;i++){let o=[],s=E.cdr(e);for(let u=0;u<r;u++){let c=E.car(s);i===u&&(c=rt(c,t)),o.push(c),s=E.cdr(s)}n.push(ve.multiply_all(o))}return Nr.add_all(n)}function FT(e,t){let r=ve.divide(E.caddr(e),E.cadr(e)),n=rt(E.cadr(e),t),i=RT.logarithm(E.cadr(e)),o=rt(E.caddr(e),t);return ve.multiply(Nr.add(ve.multiply(r,n),ve.multiply(i,o)),e)}function jT(e,t){let r=rt(E.cadr(e),t);return ve.divide(r,E.cadr(e))}function zT(e,t){let r=rt(E.cadr(e),t);return E.car(r)===De.symbol(E.DERIVATIVE)?Fl.lessp(E.caddr(r),E.caddr(e))?jl.makeList(De.symbol(E.DERIVATIVE),jl.makeList(De.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(r)),E.caddr(e)):jl.makeList(De.symbol(E.DERIVATIVE),jl.makeList(De.symbol(E.DERIVATIVE),E.cadr(r),E.caddr(e)),E.caddr(r)):rt(r,E.caddr(e))}function YT(e,t){let r=E.cdr(e);return r===De.symbol(E.NIL)||NT.Find(r,t)?jl.makeList(De.symbol(E.DERIVATIVE),e,t):E.Constants.zero}function ZT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Qv.cosine(E.cadr(e)))}function VT(e,t){let r=rt(E.cadr(e),t);return ve.negate(ve.multiply(r,PT.sine(E.cadr(e))))}function XT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Qv.cosine(E.cadr(e)),kt.integer(-2)))}function HT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))),kt.rational(-1,2)))}function QT(e,t){let r=rt(E.cadr(e),t);return ve.negate(ve.multiply(r,gr.power(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))),kt.rational(-1,2))))}function WT(e,t){let r=rt(E.cadr(e),t);return CT.simplify(ve.multiply(r,ve.inverse(Nr.add(E.Constants.one,gr.power(E.cadr(e),kt.integer(2))))))}function JT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Wv.ycosh(E.cadr(e)))}function KT(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,DT.ysinh(E.cadr(e)))}function eN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Wv.ycosh(E.cadr(e)),kt.integer(-2)))}function tN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.add(gr.power(E.cadr(e),kt.integer(2)),E.Constants.one),kt.rational(-1,2)))}function rN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,gr.power(Nr.add(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne),kt.rational(-1,2)))}function nN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,ve.inverse(Nr.subtract(E.Constants.one,gr.power(E.cadr(e),kt.integer(2)))))}function iN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,LT.sgn(E.cadr(e)))}function oN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,IT.dirac(E.cadr(e))),kt.integer(2))}function sN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,ve.multiply(kt.integer(2),E.caddr(e))),ST.hermite(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)))}function aN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(ve.multiply(Fl.exponential(ve.multiply(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne)),gr.power(E.Constants.Pi(),kt.rational(-1,2))),kt.integer(2)),r)}function lN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(ve.multiply(Fl.exponential(ve.multiply(gr.power(E.cadr(e),kt.integer(2)),E.Constants.negOne)),gr.power(E.Constants.Pi(),kt.rational(-1,2))),kt.integer(-2)),r)}function uN(e,t){return Kv.isZeroAtomOrTensor(E.caddr(e))?cN(e,t):dN(e,t)}function cN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,Cc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function dN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Nr.add(Cc.besselj(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)),ve.multiply(ve.divide(ve.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Cc.besselj(E.cadr(e),E.caddr(e)))))}function fN(e,t){return Kv.isZeroAtomOrTensor(E.caddr(e))?mN(e,t):_N(e,t)}function mN(e,t){let r=rt(E.cadr(e),t);return ve.multiply(ve.multiply(r,Cc.besselj(E.cadr(e),E.Constants.one)),E.Constants.negOne)}function _N(e,t){let r=rt(E.cadr(e),t);return ve.multiply(r,Nr.add(Hv.bessely(E.cadr(e),Nr.add(E.caddr(e),E.Constants.negOne)),ve.multiply(ve.divide(ve.multiply(E.caddr(e),E.Constants.negOne),E.cadr(e)),Hv.bessely(E.cadr(e),E.caddr(e)))))}function bN(e){return E.cadr(e)}});var r1=A(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.Eval_user_function=void 0;var Ye=N(),E_=Ee(),Co=$(),gN=wo(),x_=G(),p_=ee(),t1=qt();function yN(e){if(Ye.DEBUG&&console.log(`Eval_user_function evaluating: ${Ye.car(e)}`),Ye.car(e)===Co.symbol(Ye.SYMBOL_D)&&Co.get_binding(Co.symbol(Ye.SYMBOL_D))===Co.symbol(Ye.SYMBOL_D))return gN.Eval_derivative(e);let t=x_.Eval(Ye.car(e));Ye.isNumericAtom(t)?E_.stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):Ye.istensor(t)?E_.stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):Ye.isstr(t)&&E_.stop("expected function, found string instead.");let r=Ye.car(Ye.cdr(t)),n=Ye.car(Ye.cdr(Ye.cdr(t))),i=Ye.cdr(e);if(Ye.car(t)!==Co.symbol(Ye.FUNCTION)||t===Ye.car(e))return p_.makeList(t,...x_.evalList(i));e=n;let o=i,s=[];for(;Ye.iscons(e)&&Ye.iscons(o);)s.push(Ye.car(e)),s.push(Ye.car(o)),e=Ye.cdr(e),o=Ye.cdr(o);return s.length&&(r=Pc(r,s)),x_.Eval(r)}Dc.Eval_user_function=yN;function Pc(e,t){if(Ye.istensor(e))return vN(e,t);if(Ye.iscons(e)){let n=[];for(Ye.car(e)===t[0]?n.push(p_.makeList(Co.symbol(Ye.EVAL),t[1])):n.push(Ye.car(e)),e=Ye.cdr(e);Ye.iscons(e);)n.push(Pc(Ye.car(e),t)),e=Ye.cdr(e);return p_.makeList(...n)}if(!Ye.issymbol(e))return e;for(let n=0;n<t.length;n+=2)if(e===t[n])return t[n+1];let r=Co.get_binding(e);return e!==r&&Pc(r,t)===r?e:r}function vN(e,t){return e=t1.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>Pc(r,t)),t1.check_tensor_dimensions(e),e}});var G=A(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.evalList=K.Eval_predicate=K.Eval_unit=K.Eval_subst=K.Eval_stop=K.Eval_sqrt=K.Eval_setq=K.Eval_rank=K.Eval_quote=K.Eval_operator=K.Eval_number=K.Eval_isinteger=K.Eval_invg=K.Eval_inv=K.Eval_index=K.Eval_hilbert=K.Eval_hermite=K.Eval_factorpoly=K.Eval_factorial=K.Eval_exp=K.Eval_Eval=K.Eval_dsolve=K.Eval_do=K.Eval_divisors=K.Eval_dim=K.Eval_det=K.Eval_check=K.Eval_binding=K.Eval_cons=K.Eval_sym=K.Eval=K.evaluate_integer=void 0;var n1=Hb(),qN=St(),R=N(),mi=Ee(),hr=$(),Po=j(),EN=Df(),xN=fc(),pN=Hf(),hN=po(),i1=Es(),AN=Em(),ON=Ly(),o1=Nl(),kc=Q(),Uc=ee(),MN=Ie(),TN=Et(),s1=Zr(),a1=qt(),l1=r1();function h_(e){return Po.nativeInt(Re(e))}K.evaluate_integer=h_;function Re(e){let t;mi.check_esc_flag(),e==null&&R.breakpoint,!R.defs.evaluatingAsFloats&&kc.isfloating(e)&&(t=!0,R.defs.evaluatingAsFloats=!0);try{switch(e.k){case R.CONS:return c1(e);case R.NUM:return R.defs.evaluatingAsFloats?Po.double(Po.convert_rational_to_double(e)):e;case R.DOUBLE:case R.STR:return e;case R.TENSOR:return a1.Eval_tensor(e);case R.SYM:return u1(e);default:mi.stop("atom?")}}finally{t&&(R.defs.evaluatingAsFloats=!1)}}K.Eval=Re;function u1(e){if(hr.iskeyword(e))return Re(Uc.makeList(e,hr.symbol(R.LAST)));if(e===hr.symbol(R.PI)&&R.defs.evaluatingAsFloats)return R.Constants.piAsDouble;let t=hr.get_binding(e);if(R.DEBUG&&console.log(`looked up: ${e} which contains: ${t}`),e!==t){let r=R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(e);if(r!==-1){let n="";for(let i=r;i<R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length;i++)n+=R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated[i].printname+" -> ";n+=e.printname,mi.stop("recursive evaluation of symbols: "+n);return}R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.push(e),t=Re(t),R.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}return t}K.Eval_sym=u1;function c1(e){let t=R.car(e);return R.car(t)===hr.symbol(R.EVAL)?l1.Eval_user_function(e):(R.issymbol(t)||mi.stop("cons?"),t.keyword?t.keyword(e):l1.Eval_user_function(e))}K.Eval_cons=c1;function NN(e){return hr.get_binding(R.cadr(e))}K.Eval_binding=NN;function IN(e){let t=kc.isZeroLikeOrNonZeroLikeOrUndetermined(R.cadr(e));return t==null?e:Po.integer(Number(t))}K.Eval_check=IN;function SN(e){let t=Re(R.cadr(e));return xN.det(t)}K.Eval_det=SN;function wN(e){let t=Re(R.cadr(e)),r=R.iscons(R.cddr(e))?h_(R.caddr(e)):1;return R.istensor(t)?r<1||r>t.tensor.ndim?e:Po.integer(t.tensor.dim[r-1]):R.Constants.one}K.Eval_dim=wN;function RN(e){return pN.divisors(Re(R.cadr(e)))}K.Eval_divisors=RN;function LN(e){let t=R.car(e);for(e=R.cdr(e);R.iscons(e);)t=Re(R.car(e)),e=R.cdr(e);return t}K.Eval_do=LN;function CN(e){let t=Re(R.cadr(e)),r=Re(R.caddr(e)),n=Re(R.cadddr(e));mi.stop("dsolve")}K.Eval_dsolve=CN;function PN(e){let t=Re(R.cadr(e));for(e=R.cddr(e);R.iscons(e);)t=s1.subst(t,Re(R.car(e)),Re(R.cadr(e))),e=R.cddr(e);return Re(t)}K.Eval_Eval=PN;function DN(e){return MN.exponential(Re(R.cadr(e)))}K.Eval_exp=DN;function kN(e){return hN.factorial(Re(R.cadr(e)))}K.Eval_factorial=kN;function UN(e){e=R.cdr(e);let t=Re(R.car(e));e=R.cdr(e);let r=Re(R.car(e)),n=i1.factorpoly(t,r);return R.iscons(e)&&(n=e.tail().reduce((i,o)=>i1.factorpoly(i,Re(o)),n)),n}K.Eval_factorpoly=UN;function $N(e){let t=Re(R.caddr(e)),r=Re(R.cadr(e));return AN.hermite(r,t)}K.Eval_hermite=$N;function BN(e){return ON.hilbert(Re(R.cadr(e)))}K.Eval_hilbert=BN;function GN(e){let t=e;e=R.cdr(e);let r=Re(R.car(e));if(R.isNumericAtom(r)&&mi.stop("trying to access a scalar as a tensor"),!R.istensor(r))return t;let n=[];for(e=R.cdr(e);R.iscons(e);){if(n.push(Re(R.car(e))),!kc.isintegerorintegerfloat(n[n.length-1]))return t;e=R.cdr(e)}return n1.index_function(r,n)}K.Eval_index=GN;function FN(e){let t=Re(R.cadr(e));return o1.inv(t)}K.Eval_inv=FN;function jN(e){let t=Re(R.cadr(e));return o1.invg(t)}K.Eval_invg=jN;function zN(e){return e=Re(R.cadr(e)),R.isrational(e)?kc.isinteger(e)?R.Constants.one:R.Constants.zero:R.isdouble(e)?Math.floor(e.d)===e.d?R.Constants.one:R.Constants.zero:Uc.makeList(hr.symbol(R.ISINTEGER),e)}K.Eval_isinteger=zN;function YN(e){return e=Re(R.cadr(e)),e.k===R.NUM||e.k===R.DOUBLE?R.Constants.one:R.Constants.zero}K.Eval_number=YN;function ZN(e){return Uc.makeList(hr.symbol(R.OPERATOR),...d1(R.cdr(e)))}K.Eval_operator=ZN;function VN(e){return R.cadr(e)}K.Eval_quote=VN;function XN(e){return e=Re(R.cadr(e)),R.istensor(e)?Po.integer(e.tensor.ndim):R.Constants.zero}K.Eval_rank=XN;function HN(e){if(R.caadr(e)===hr.symbol(R.INDEX))return QN(e);if(R.iscons(R.cadr(e)))return EN.define_user_function(e);R.issymbol(R.cadr(e))||mi.stop("symbol assignment: error in symbol");let t=Re(R.caddr(e));return hr.set_binding(R.cadr(e),t),hr.symbol(R.NIL)}K.Eval_setq=HN;function QN(e){let t=R.cadadr(e);console.log(`p4: ${t}`),R.issymbol(t)||mi.stop("indexed assignment: expected a symbol name");let r=Re(R.caddr(e)),n=[],i=R.cdadr(e);R.iscons(i)&&(n=[...i].map(Re));let o=n1.set_component(r,...n);return hr.set_binding(t,o),hr.symbol(R.NIL)}function WN(e){let t=Re(R.cadr(e));return TN.power(t,Po.rational(1,2))}K.Eval_sqrt=WN;function JN(){mi.stop("user stop")}K.Eval_stop=JN;function KN(e){let t=Re(R.cadr(e)),r=Re(R.caddr(e)),n=Re(R.cadddr(e));return Re(s1.subst(n,r,t))}K.Eval_subst=KN;function eI(e){let t=h_(R.cadr(e));if(isNaN(t)||t<1)return e;e=qN.alloc_tensor(t*t),e.tensor.ndim=2,e.tensor.dim[0]=t,e.tensor.dim[1]=t;for(let r=0;r<t;r++)e.tensor.elem[t*r+r]=R.Constants.one;return a1.check_tensor_dimensions(e),e}K.Eval_unit=eI;function tI(e){return R.car(e)===hr.symbol(R.SETQ)&&(e=Uc.makeList(hr.symbol(R.TESTEQ),R.cadr(e),R.caddr(e))),Re(e)}K.Eval_predicate=tI;function*d1(e){if(R.iscons(e))for(let t of e)yield Re(t)}K.evalList=d1});var ce=A(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.subtract=Pn.add_all=Pn.add=Pn.Eval_add=void 0;var le=N(),rI=Ee(),Do=$(),f1=j(),nI=G(),A_=Q(),iI=ee(),m1=Ie(),_1=X(),oI=ti(),sI=qt(),zl=0;function aI(e){let t=[];e=le.cdr(e);for(let r of e){let n=nI.Eval(r);$c(t,n)}return O_(t)}Pn.Eval_add=aI;function O_(e){if(le.DEBUG)for(let t of e)console.log(oI.print_list(t));for(let t=0;t<10&&!(e.length<2||(zl=0,e.sort(uI),zl===0));t++)cI(e);switch(e.length){case 0:return le.Constants.Zero();case 1:return e[0];default:return e.unshift(Do.symbol(le.ADD)),iI.makeList(...e)}}var lI=0;function uI(e,t){if(lI++,le.isNumericAtom(e)&&le.isNumericAtom(t))return zl=1,0;if(le.istensor(e)&&le.istensor(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let n=0;n<e.tensor.ndim;n++){if(e.tensor.dim[n]<t.tensor.dim[n])return-1;if(e.tensor.dim[n]>t.tensor.dim[n])return 1}return zl=1,0}le.ismultiply(e)&&(e=le.cdr(e),le.isNumericAtom(le.car(e))&&(e=le.cdr(e),le.cdr(e)===Do.symbol(le.NIL)&&(e=le.car(e)))),le.ismultiply(t)&&(t=le.cdr(t),le.isNumericAtom(le.car(t))&&(t=le.cdr(t),le.cdr(t)===Do.symbol(le.NIL)&&(t=le.car(t))));let r=m1.cmp_expr(e,t);return r===0&&(zl=1),r}function cI(e){let t=0;for(;t<e.length-1;){rI.check_esc_flag();let r,n,i=e[t],o=e[t+1];if(le.istensor(i)&&le.istensor(o)){r=sI.tensor_plus_tensor(i,o),r!==Do.symbol(le.NIL)&&(e.splice(t,2,r),t--),t++;continue}if(le.istensor(i)||le.istensor(o)){t++;continue}if(le.isNumericAtom(i)&&le.isNumericAtom(o)){r=f1.add_numbers(i,o),A_.isZeroAtomOrTensor(r)?e.splice(t,2):e.splice(t,2,r),t--,t++;continue}if(le.isNumericAtom(i)||le.isNumericAtom(o)){t++;continue}r=le.Constants.One(),n=le.Constants.One();let s=0;if(le.ismultiply(i)&&(i=le.cdr(i),s=1,le.isNumericAtom(le.car(i))&&(r=le.car(i),i=le.cdr(i),le.cdr(i)===Do.symbol(le.NIL)&&(i=le.car(i),s=0))),le.ismultiply(o)&&(o=le.cdr(o),le.isNumericAtom(le.car(o))&&(n=le.car(o),o=le.cdr(o),le.cdr(o)===Do.symbol(le.NIL)&&(o=le.car(o)))),!m1.equal(i,o)){t++;continue}if(r=f1.add_numbers(r,n),A_.isZeroAtomOrTensor(r)){e.splice(t,2),t--,t++;continue}let u=s?new le.Cons(Do.symbol(le.MULTIPLY),i):i;e.splice(t,2,_1.multiply(r,u)),t--,t++}}function $c(e,t){le.isadd(t)?e.push(...t.tail()):A_.isZeroAtom(t)||e.push(t)}function b1(e,t){let r=[];return $c(r,e),$c(r,t),O_(r)}Pn.add=b1;function dI(e){let t=[];for(let r of e)$c(t,r);return O_(t)}Pn.add_all=dI;function fI(e,t){return b1(e,_1.negate(t))}Pn.subtract=fI});var sn=A(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.absval=Dn.abs=Dn.absValFloat=Dn.Eval_abs=void 0;var xt=N(),M_=or(),mI=Ee(),Yl=$(),_I=Ie(),bI=ce(),Bc=j(),gI=yo(),yI=Mn(),Gc=G(),vI=wn(),qI=vl(),EI=Bi(),ko=Q(),g1=ee(),Fc=X(),xI=oi(),Zl=Et(),y1=$s(),pI=ei(),v1=Zi();function hI(e){return T_(Gc.Eval(xt.cadr(e)))}Dn.Eval_abs=hI;function AI(e){return vI.zzfloat(Gc.Eval(Vl(Gc.Eval(e))))}Dn.absValFloat=AI;function T_(e){return Fc.divide(Vl(xI.numerator(e)),Vl(yI.denominator(e)))}Dn.abs=T_;function Vl(e){return ko.isZeroAtomOrTensor(e)?xt.Constants.zero:ko.isnegativenumber(e)?Fc.negate(e):ko.ispositivenumber(e)||e===Yl.symbol(xt.PI)?e:xt.isadd(e)&&(M_.findPossibleClockForm(e,e)||M_.findPossibleExponentialForm(e)||M_.Find(e,xt.Constants.imaginaryunit))?(e=pI.rect(e),v1.simplify_trig(Zl.power(bI.add(Zl.power(y1.real(e),Bc.integer(2)),Zl.power(qI.imag(e),Bc.integer(2))),Bc.rational(1,2)))):xt.ispower(e)&&ko.equaln(xt.cadr(e),-1)?xt.Constants.One():xt.ispower(e)&&ko.ispositivenumber(xt.caddr(e))?Zl.power(T_(xt.cadr(e)),xt.caddr(e)):xt.ispower(e)&&xt.cadr(e)===Yl.symbol(xt.E)?_I.exponential(y1.real(xt.caddr(e))):xt.ismultiply(e)?e.tail().map(Vl).reduce(Fc.multiply):xt.car(e)===Yl.symbol(xt.ABS)?g1.makeList(Yl.symbol(xt.ABS),xt.cadr(e)):xt.istensor(e)?OI(e):((ko.isnegativeterm(e)||xt.isadd(e)&&ko.isnegativeterm(xt.cadr(e)))&&(e=Fc.negate(e)),g1.makeList(Yl.symbol(xt.ABS),e))}Dn.absval=Vl;function OI(e){return e.tensor.ndim!==1&&mI.stop("abs(tensor) with tensor rank > 1"),Gc.Eval(v1.simplify(Zl.power(EI.inner(e,gI.conjugate(e)),Bc.rational(1,2))))}});var Q=A(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.isnpi=Z.isquarterturn=Z.isimaginaryunit=Z.isfloating=Z.isMinusSqrtThreeOverTwo=Z.isSqrtThreeOverTwo=Z.isminusoneoversqrttwo=Z.isoneoversqrttwo=Z.isminusoneovertwo=Z.isoneovertwo=Z.equalq=Z.equaln=Z.isfraction=Z.isoneover=Z.isNumberOneOverSomething=Z.isintegerfactor=Z.issymbolic=Z.isnegative=Z.iseveninteger=Z.iscomplexnumber=Z.iscomplexnumberdouble=Z.isimaginarynumber=Z.isnegativeterm=Z.ispolyexpandedform=Z.isunivarpolyfactoredorexpandedform=Z.isposint=Z.isnonnegativeinteger=Z.isintegerorintegerfloat=Z.isinteger=Z.isone=Z.isminusone=Z.isplusone=Z.isplustwo=Z.ispositivenumber=Z.isnegativenumber=Z.isZeroLikeOrNonZeroLikeOrUndetermined=Z.isZeroAtomOrTensor=Z.isZeroAtom=void 0;var h=N(),pa=or(),Qi=$(),Kt=Ie(),MI=sn(),jc=j(),q1=G(),TI=wn(),NI=Vr(),E1=X(),Xl=!1;function x1(e){switch(e.k){case h.NUM:if(h.MZERO(e.q.a))return!0;break;case h.DOUBLE:if(e.d===0)return!0;break}return!1}Z.isZeroAtom=x1;function II(e){return h.istensor(e)?e.tensor.elem.every(t=>Hl(t)):!1}function Hl(e){return x1(e)||II(e)}Z.isZeroAtomOrTensor=Hl;function SI(e){let t=q1.Eval_predicate(e);if(Hl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(t=TI.zzfloat(t),Hl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0;if(pa.Find(t,h.Constants.imaginaryunit)){if(t=q1.Eval_predicate(MI.absValFloat(t)),Hl(t))return!1;if(h.isNumericAtomOrTensor(t))return!0}return null}Z.isZeroLikeOrNonZeroLikeOrUndetermined=SI;function zc(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===-1)return!0;break;case h.DOUBLE:if(e.d<0)return!0;break}return!1}Z.isnegativenumber=zc;function wI(e){switch(e.k){case h.NUM:if(h.MSIGN(e.q.a)===1)return!0;break;case h.DOUBLE:if(e.d>0)return!0;break}return!1}Z.ispositivenumber=wI;function RI(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,2)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===2)return!0;break}return!1}Z.isplustwo=RI;function p1(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===1)return!0;break}return!1}Z.isplusone=p1;function N_(e){switch(e.k){case h.NUM:if(h.MEQUAL(e.q.a,-1)&&h.MEQUAL(e.q.b,1))return!0;break;case h.DOUBLE:if(e.d===-1)return!0;break}return!1}Z.isminusone=N_;function LI(e){return p1(e)||N_(e)}Z.isone=LI;function Uo(e){return e.k===h.NUM&&h.MEQUAL(e.q.b,1)}Z.isinteger=Uo;function CI(e){return e.k===h.DOUBLE?e.d===Math.round(e.d):Uo(e)}Z.isintegerorintegerfloat=CI;function PI(e){return h.isrational(e)&&h.MEQUAL(e.q.b,1)&&h.MSIGN(e.q.a)===1}Z.isnonnegativeinteger=PI;function Yc(e){return Uo(e)&&h.MSIGN(e.q.a)===1}Z.isposint=Yc;function DI(e,t){return t==null&&(t=NI.guess(e)),UI(e,t)&&kI(pa.Find(e,Qi.symbol(h.SYMBOL_X)),pa.Find(e,Qi.symbol(h.SYMBOL_Y)),pa.Find(e,Qi.symbol(h.SYMBOL_Z)))===1?t:!1}Z.isunivarpolyfactoredorexpandedform=DI;function kI(...e){return e.reduce((t,r)=>t+Number(r),0)}function UI(e,t){return $I(e,t)}function $I(e,t){return h.ismultiply(e)?e.tail().every(r=>{let n=h1(r,t);return h.DEBUG&&(console.log(`ispolyfactoredorexpandedform_factor testing ${r}`),n&&console.log(`... tested negative:${r}`)),n}):h1(e,t)}function h1(e,t){return h.ispower(e)?(h.DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(Yc(h.caddr(e)),h.DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+Zc(h.cadr(e),t)):void 0)),Yc(h.caddr(e))&&Zc(h.cadr(e),t)):(h.DEBUG&&console.log(`ispolyfactoredorexpandedform_power not a power, testing if this is exp form: ${e}`),Zc(e,t))}function BI(e,t){return pa.Find(e,t)?Zc(e,t):!1}Z.ispolyexpandedform=BI;function Zc(e,t){return h.isadd(e)?e.tail().every(r=>A1(r,t)):A1(e,t)}function A1(e,t){return h.ismultiply(e)?e.tail().every(r=>O1(r,t)):O1(e,t)}function O1(e,t){return Kt.equal(e,t)?!0:h.ispower(e)&&Kt.equal(h.cadr(e),t)?Yc(h.caddr(e)):!pa.Find(e,t)}function I_(e){return zc(e)||h.ismultiply(e)&&zc(h.cadr(e))}Z.isnegativeterm=I_;function M1(e){return h.ispower(e)&&h.isrational(h.car(h.cdr(h.cdr(e))))&&zc(h.car(h.cdr(e)))?(Xl&&console.log(`hasNegativeRationalExponent: ${e} has imaginary component`),!0):(Xl&&console.log(`hasNegativeRationalExponent: ${e} has NO imaginary component`),!1)}function T1(e){return h.ismultiply(e)&&Kt.length(e)===3&&h.isdouble(h.cadr(e))&&M1(h.caddr(e))||Kt.equal(e,h.Constants.imaginaryunit)}function S_(e){return h.ismultiply(e)&&Kt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&Kt.equal(h.caddr(e),h.Constants.imaginaryunit)||Kt.equal(e,h.Constants.imaginaryunit)||M1(h.caddr(e))?(Xl&&console.log(`isimaginarynumber: ${e} is imaginary number`),!0):(Xl&&console.log(`isimaginarynumber: ${e} isn't an imaginary number`),!1)}Z.isimaginarynumber=S_;function GI(e){return h.isadd(e)&&Kt.length(e)===3&&h.isdouble(h.cadr(e))&&T1(h.caddr(e))||T1(e)}Z.iscomplexnumberdouble=GI;function FI(e){return Xl&&h.breakpoint,h.isadd(e)&&Kt.length(e)===3&&h.isNumericAtom(h.cadr(e))&&S_(h.caddr(e))||S_(e)?(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!0):(h.DEBUG&&console.log(`iscomplexnumber: ${e} is imaginary number`),!1)}Z.iscomplexnumber=FI;function jI(e){return Uo(e)&&e.q.a.isEven()}Z.iseveninteger=jI;function zI(e){return h.isadd(e)&&I_(h.cadr(e))||I_(e)}Z.isnegative=zI;function N1(e){return h.issymbol(e)?!0:h.iscons(e)?[...e].some(N1):!1}Z.issymbolic=N1;function YI(e){return Uo(e)||h.ispower(e)&&Uo(h.cadr(e))&&Uo(h.caddr(e))}Z.isintegerfactor=YI;function ZI(e){return I1(e)&&h.MEQUAL(e.q.a.abs(),1)}Z.isNumberOneOverSomething=ZI;function VI(e){return h.ispower(e)&&N_(h.caddr(e))}Z.isoneover=VI;function I1(e){return e.k===h.NUM&&!h.MEQUAL(e.q.b,1)}Z.isfraction=I1;function Vc(e,t){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,1);case h.DOUBLE:return e.d===t;default:return!1}}Z.equaln=Vc;function Xc(e,t,r){switch(e.k){case h.NUM:return h.MEQUAL(e.q.a,t)&&h.MEQUAL(e.q.b,r);case h.DOUBLE:return e.d===t/r;default:return!1}}Z.equalq=Xc;function w_(e){return Xc(e,1,2)}Z.isoneovertwo=w_;function S1(e){return Xc(e,-1,2)}Z.isminusoneovertwo=S1;function w1(e){return h.ispower(e)&&Vc(h.cadr(e),2)&&Xc(h.caddr(e),-1,2)}Z.isoneoversqrttwo=w1;function XI(e){return h.ismultiply(e)&&Vc(h.cadr(e),-1)&&w1(h.caddr(e))&&Kt.length(e)===3}Z.isminusoneoversqrttwo=XI;function HI(e){return h.ismultiply(e)&&w_(h.cadr(e))&&R1(h.caddr(e))&&Kt.length(e)===3}Z.isSqrtThreeOverTwo=HI;function QI(e){return h.ismultiply(e)&&S1(h.cadr(e))&&R1(h.caddr(e))&&Kt.length(e)===3}Z.isMinusSqrtThreeOverTwo=QI;function R1(e){return h.ispower(e)&&Vc(h.cadr(e),3)&&w_(h.caddr(e))}function L1(e){return e.k===h.DOUBLE||e===Qi.symbol(h.FLOATF)?!0:h.iscons(e)?[...e].some(L1):!1}Z.isfloating=L1;function WI(e){return Kt.equal(e,h.Constants.imaginaryunit)}Z.isimaginaryunit=WI;function JI(e){let t=0;if(!h.ismultiply(e))return 0;if(Kt.equal(h.cadr(e),h.Constants.imaginaryunit))return h.caddr(e)!==Qi.symbol(h.PI)||Kt.length(e)!==3?0:2;if(!h.isNumericAtom(h.cadr(e))||!Kt.equal(h.caddr(e),h.Constants.imaginaryunit)||h.cadddr(e)!==Qi.symbol(h.PI)||Kt.length(e)!==4)return 0;let r=jc.nativeInt(E1.multiply(h.cadr(e),jc.integer(2)));if(isNaN(r))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:r=t?4:3;break;case 2:r=2;break;case 3:r=t?3:4}return r}Z.isquarterturn=JI;function KI(e){let t=0;return e===Qi.symbol(h.PI)?2:!h.ismultiply(e)||!h.isNumericAtom(h.cadr(e))||h.caddr(e)!==Qi.symbol(h.PI)||Kt.length(e)!==3||(t=jc.nativeInt(E1.multiply(h.cadr(e),jc.integer(2))),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)}Z.isnpi=KI});var ui=A(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.yn=Rt.jn=Rt.append=Rt.isalnumorunderscore=Rt.isalpha=Rt.isdigit=Rt.isspace=Rt.clear_term=Rt.doubleToReasonableString=Rt.strcmp=void 0;var eS=j(),tS=Q(),rS=ee(),Wi=N(),C1=Ee(),Hc=$();function nS(e,t){return e===t?0:e>t?1:-1}Rt.strcmp=nS;function iS(e){let t;if(Wi.defs.codeGen||Wi.defs.fullDoubleOutput)return""+e;if(tS.isZeroAtomOrTensor(Hc.get_binding(Hc.symbol(Wi.FORCE_FIXED_PRINTOUT))))t=""+e,Wi.defs.printMode===Wi.PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):t=t.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(t)?t=t.replace(/e(.*)/gm,"*10^($1)"):t=t.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)");else{let r=eS.nativeInt(Hc.get_binding(Hc.symbol(Wi.MAX_FIXED_PRINTOUT_DIGITS)));t=""+e.toFixed(r),t=t.replace(/(\.\d*?[1-9])0+$/gm,"$1"),t=t.replace(/\.0+$/gm,""),t.indexOf(".")===-1&&(t+=".0"),parseFloat(t)!==e&&(t=e.toFixed(r)+"...")}return t}Rt.doubleToReasonableString=iS;function oS(){}Rt.clear_term=oS;function sS(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"}Rt.isspace=sS;function P1(e){return e==null?!1:/^\d+$/.test(e)}Rt.isdigit=P1;function aS(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1}Rt.isalpha=aS;function lS(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1}function uS(e){return e==null?!1:lS(e)||P1(e)}Rt.isalnumorunderscore=uS;function cS(e,t){let r=[];return Wi.iscons(e)&&r.push(...e),Wi.iscons(t)&&r.push(...t),rS.makeList(...r)}Rt.append=cS;function dS(e,t){C1.stop("Not implemented")}Rt.jn=dS;function fS(e,t){C1.stop("Not implemented")}Rt.yn=fS});var D1=A(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.qadd=void 0;var R_=N(),mS=j(),_S=jf(),bS=ys(),Ql=un();function gS(e,t){let r=Ql.mmul(e.q.a,t.q.b),n=Ql.mmul(e.q.b,t.q.a),i=_S.madd(r,n);if(R_.MZERO(i))return R_.Constants.zero;let o=Ql.mmul(e.q.b,t.q.b),s=bS.mgcd(i,o);s=mS.makeSignSameAs(s,o);let u=Ql.mdiv(i,s),c=Ql.mdiv(o,s);return new R_.Num(u,c)}Qc.qadd=gS});var k1=A(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.qdiv=void 0;var Wc=N(),yS=Ee(),vS=j(),qS=ys(),Jc=un();function ES(e,t){if(Wc.MZERO(t.q.a)&&yS.stop("divide by zero"),Wc.MZERO(e.q.a))return Wc.Constants.zero;let r=Jc.mmul(e.q.a,t.q.b),n=Jc.mmul(e.q.b,t.q.a),i=qS.mgcd(r,n);return i=vS.makeSignSameAs(i,n),new Wc.Num(Jc.mdiv(r,i),Jc.mdiv(n,i))}Kc.qdiv=ES});var U1=A(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.qmul=void 0;var ed=N(),xS=j(),pS=ys(),td=un();function hS(e,t){if(ed.MZERO(e.q.a)||ed.MZERO(t.q.a))return ed.Constants.zero;let r=td.mmul(e.q.a,t.q.a),n=td.mmul(e.q.b,t.q.b),i=pS.mgcd(r,n);return i=xS.makeSignSameAs(i,n),new ed.Num(td.mdiv(r,i),td.mdiv(n,i))}rd.qmul=hS});var j=A(oe=>{"use strict";var AS=oe&&oe.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oe,"__esModule",{value:!0});oe.bignum_factorial=oe.bignum_float=oe.nativeDouble=oe.gcd_numbers=oe.print_number=oe.bignum_scan_float=oe.bignum_scan_integer=oe.nativeInt=oe.rational=oe.double=oe.integer=oe.convert_rational_to_double=oe.bignum_power_number=oe.mp_denominator=oe.mp_numerator=oe.bignum_truncate=oe.negate_number=oe.compare_numbers=oe.invert_number=oe.divide_numbers=oe.multiply_numbers=oe.add_numbers=oe.makePositive=oe.makeSignSameAs=oe.setSignTo=oe.isSmall=oe.mint=void 0;var Ut=AS(Mi()),fe=N(),OS=Mu(),MS=ui(),L_=Ee(),ha=Q(),$1=ys(),nd=un(),B1=rc(),TS=X(),NS=D1(),IS=k1(),SS=U1();function wS(e){return Ut.default(e)}oe.mint=wS;function G1(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)}oe.isSmall=G1;function id(e,t){if(e.isPositive()){if(t<0)return e.multiply(Ut.default(-1))}else if(t>0)return e.multiply(Ut.default(-1));return e}oe.setSignTo=id;function C_(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply(Ut.default(-1))}else if(t.isPositive())return e.multiply(Ut.default(-1));return e}oe.makeSignSameAs=C_;function RS(e){return e.isNegative()?e.multiply(Ut.default(-1)):e}oe.makePositive=RS;function LS(e,t){if(fe.isrational(e)&&fe.isrational(t))return NS.qadd(e,t);let r=fe.isdouble(e)?e.d:_n(e),n=fe.isdouble(t)?t.d:_n(t);return P_(r+n)}oe.add_numbers=LS;function CS(e,t){if(fe.isrational(e)&&fe.isrational(t))return SS.qmul(e,t);let r=fe.isdouble(e)?e.d:_n(e),n=fe.isdouble(t)?t.d:_n(t);return new fe.Double(r*n)}oe.multiply_numbers=CS;function PS(e,t){if(fe.isrational(e)&&fe.isrational(t))return IS.qdiv(e,t);ha.isZeroAtomOrTensor(t)&&L_.stop("divide by zero");let r=fe.isdouble(e)?e.d:_n(e),n=fe.isdouble(t)?t.d:_n(t);return new fe.Double(r/n)}oe.divide_numbers=PS;function DS(e){if(ha.isZeroAtomOrTensor(e)&&L_.stop("divide by zero"),fe.isdouble(e))return new fe.Double(1/e.d);let t=Ut.default(e.q.a),r=Ut.default(e.q.b);return r=C_(r,t),t=id(t,1),new fe.Num(r,t)}oe.invert_number=DS;function kS(e,t){let r=nd.mmul(e.q.a,t.q.b),n=nd.mmul(e.q.b,t.q.a);return OS.mcmp(r,n)}function US(e,t){if(fe.isrational(e)&&fe.isrational(t))return kS(e,t);let r=fe.isdouble(e)?e.d:_n(e),n=fe.isdouble(t)?t.d:_n(t);return r<n?-1:r>n?1:0}oe.compare_numbers=US;function $S(e){if(ha.isZeroAtomOrTensor(e))return e;switch(e.k){case fe.NUM:return new fe.Num(Ut.default(e.q.a.multiply(Ut.default.minusOne)),Ut.default(e.q.b));case fe.DOUBLE:return new fe.Double(-e.d);default:L_.stop("bug caught in mp_negate_number")}}oe.negate_number=$S;function BS(e){let t=nd.mdiv(e.q.a,e.q.b);return new fe.Num(t)}oe.bignum_truncate=BS;function GS(e){return fe.isrational(e)?new fe.Num(Ut.default(e.q.a)):fe.Constants.one}oe.mp_numerator=GS;function FS(e){return fe.isrational(e)?new fe.Num(Ut.default(e.q.b)):fe.Constants.one}oe.mp_denominator=FS;function jS(e,t){let r=B1.mpow(e.q.a,Math.abs(t)),n=B1.mpow(e.q.b,Math.abs(t));if(t<0){let i=r;r=n,n=i,r=C_(r,n),n=id(n,1)}return new fe.Num(r,n)}oe.bignum_power_number=jS;function _n(e){e.q==null&&fe.breakpoint;let t=e.q.a.divmod(e.q.b);return t.quotient.toJSNumber()+t.remainder.toJSNumber()/e.q.b.toJSNumber()}oe.convert_rational_to_double=_n;function zS(e){return new fe.Num(Ut.default(e))}oe.integer=zS;function P_(e){return new fe.Double(e)}oe.double=P_;function YS(e,t){return new fe.Num(Ut.default(e),Ut.default(t))}oe.rational=YS;function ZS(e){let t=NaN;switch(e.k){case fe.NUM:ha.isinteger(e)&&G1(e.q.a)&&(t=e.q.a.toJSNumber());break;case fe.DOUBLE:fe.DEBUG&&console.log("popping integer but double is found"),Math.floor(e.d)===e.d&&(fe.DEBUG&&console.log("...although it's an integer"),t=e.d);break}return t}oe.nativeInt=ZS;function VS(e){let t=0,r=e[t];(r==="+"||r==="-")&&t++;let n=Ut.default(e.substring(t)),i=new fe.Num(n);return r==="-"&&(i=TS.negate(i)),i}oe.bignum_scan_integer=VS;function XS(e){return P_(parseFloat(e))}oe.bignum_scan_float=XS;function HS(e,t){let r="",n="",i="";switch(e.k){case fe.NUM:var o=e.q.a.toString();t||o[0]==="-"&&(o=o.substring(1)),fe.defs.printMode===fe.PRINTMODE_LATEX&&ha.isfraction(e)&&(o="\\frac{"+o+"}{"),r+=o,ha.isfraction(e)&&(fe.defs.printMode!==fe.PRINTMODE_LATEX&&(r+="/"),n=e.q.b.toString(),fe.defs.printMode===fe.PRINTMODE_LATEX&&(n+="}"),r+=n);break;case fe.DOUBLE:o=MS.doubleToReasonableString(e.d),t||o[0]==="-"&&(o=o.substring(1)),r+=o;break}return r}oe.print_number=HS;function QS(e,t){let r=$1.mgcd(e.q.a,t.q.a),n=$1.mgcd(e.q.b,t.q.b);return new fe.Num(id(r,1),n)}oe.gcd_numbers=QS;function WS(e){let t=0;switch(e.k){case fe.NUM:t=_n(e);break;case fe.DOUBLE:({d:t}=e);break;default:t=0}return t}oe.nativeDouble=WS;function JS(e){let t=_n(e);return new fe.Double(t)}oe.bignum_float=JS;function KS(e){return new fe.Num(ew(e))}oe.bignum_factorial=KS;function ew(e){let t;if(e===0||e===1)return t=Ut.default(1),t;t=Ut.default(2);let r=Ut.default(0);if(3<=e)for(let n=3;n<=e;n++)r=Ut.default(n),t=nd.mmul(t,r);return t}});var n_=A(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.polyform=Oa.bake=void 0;var Tt=N(),tw=j(),rw=go(),Ji=Q(),Wl=ee(),Ir=$();function F1(e){return Tt.doexpand(nw,e)}Oa.bake=F1;function nw(e){let t=Ji.ispolyexpandedform(e,Ir.symbol(Tt.SYMBOL_S)),r=Ji.ispolyexpandedform(e,Ir.symbol(Tt.SYMBOL_T)),n=Ji.ispolyexpandedform(e,Ir.symbol(Tt.SYMBOL_X)),i=Ji.ispolyexpandedform(e,Ir.symbol(Tt.SYMBOL_Y)),o=Ji.ispolyexpandedform(e,Ir.symbol(Tt.SYMBOL_Z)),s;return t&&!r&&!n&&!i&&!o?s=Aa(e,Ir.symbol(Tt.SYMBOL_S)):!t&&r&&!n&&!i&&!o?s=Aa(e,Ir.symbol(Tt.SYMBOL_T)):!t&&!r&&n&&!i&&!o?s=Aa(e,Ir.symbol(Tt.SYMBOL_X)):!t&&!r&&!n&&i&&!o?s=Aa(e,Ir.symbol(Tt.SYMBOL_Y)):!t&&!r&&!n&&!i&&o?s=Aa(e,Ir.symbol(Tt.SYMBOL_Z)):Tt.iscons(e)&&Tt.car(e)!==Ir.symbol(Tt.FOR)?s=Wl.makeList(Tt.car(e),...e.tail().map(F1)):s=e,s}function j1(e,t){return Ji.ispolyexpandedform(e,t)?Aa(e,t):Tt.iscons(e)?Wl.makeList(Tt.car(e),...e.tail().map(r=>j1(r,t))):e}Oa.polyform=j1;function Aa(e,t){let r=rw.coeff(e,t),n=[];for(let i=r.length-1;i>=0;i--){let o=r[i];n.push(...iw(i,o,t))}return n.length>1?new Tt.Cons(Ir.symbol(Tt.ADD),Wl.makeList(...n)):n[0]}function iw(e,t,r){if(Ji.isZeroAtomOrTensor(t))return[];if(e===0)return Tt.isadd(t)?t.tail():[t];let n=[];return Tt.ismultiply(t)?n.push(...t.tail()):Ji.equaln(t,1)||n.push(t),e===1?n.push(r):n.push(Wl.makeList(Ir.symbol(Tt.POWER),r,tw.integer(e))),n.length>1?[Wl.makeList(Ir.symbol(Tt.MULTIPLY),...n)]:n}});var U_=A(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.testApprox=Jr.approxAll=Jr.approxRationalsOfLogs=Jr.approxRadicals=Jr.Eval_approxratio=void 0;var ow=St(),_i=N(),sw=$(),z1=j(),aw=wn(),lw=ee(),uw=qt();function cw(e){return od(_i.cadr(e))}Jr.Eval_approxratio=cw;function od(e){if(_i.istensor(e)){let t=ow.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=Array.from(e.tensor.dim),t.tensor.elem=t.tensor.elem.map(r=>{let n=od(r);return uw.check_tensor_dimensions(t),n}),t}return e.k===_i.DOUBLE?dw(e):_i.iscons(e)?new _i.Cons(od(_i.car(e)),od(_i.cdr(e))):e}function dw(e){let t=aw.zzfloat(e);if(t.k===_i.DOUBLE){let r=t.d,n=r.toString().split(".");if(n.length===2){let i=n[1].length,o=1/Math.pow(10,i),s=fw(r,o);return z1.rational(s[0],s[1])}return z1.integer(r)}return lw.makeList(sw.symbol(_i.APPROXRATIO),t)}function fw(e,t){if(isNaN(e))return[0,0];if(e===1/0)return[1,0];if(e===-1/0)return[-1,0];let r=e<0?-1:1;if(e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return[e*r,1];if(e<1e-19)return[r,1e19];if(e>1e19)return[1e19*r,1];let n=e,i=0,o=1,s;for(;;){n=1/(n-Math.floor(n));let u=o;if(o=o*Math.floor(n)+i,i=u,s=Math.floor(e*o+.5),!(Math.abs(e-s/o)>t)||n===Math.floor(n))break}return s=r*s,[s,o]}var Wr=0,mw=1,Y1=2,Z1=3,D_=4,_w=6,V1=7,bw=8,gw=9;function yw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o of[2,3,5,6,7,8,10])for(let s=1;s<=10;s++){let u,c,f,_=Math.sqrt(o)/s;if(Math.abs(_)>1e-10?(f=e/_,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-_)),u<2*t){let w=Dr(c,o,s);w<i&&(i=w,n=[`${c} * sqrt( ${o} ) / ${s}`,_w,c,o,s])}}return n}function vw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o of[1,2,3,5,6,7,8,10])for(let s of[1,2,3,5,6,7,8,10]){let u,c,f,_=Math.sqrt(o/s);if(Math.abs(_)>1e-10?(f=e/_,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-_)),u<2*t){let w=Dr(c,o,s);w<i&&(i=w,n=[`${c} * (sqrt( ${o} / ${s} )`,D_,c,o,s])}}return n}function $o(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=yw(e);if(n!=null)return n;let i=vw(e);return i!=null?i:null}Jr.approxRadicals=$o;function Jl(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=X1(e);if(n!=null)return n;let i=qw(e);return i!=null?i:null}function X1(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=2;o<=5;o++)for(let s=1;s<=5;s++){let u,c,f,_=Math.log(o)/s;if(Math.abs(_)>1e-10?(f=e/_,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-_)),!(c!==1&&Math.abs(Math.floor(c/s))===Math.abs(c/s))&&u<2.2*t){let w=Dr(c,o,s);w<i&&(i=w,n=[`${c} * log( ${o} ) / ${s}`,gw,c,o,s])}}return n}Jr.approxRationalsOfLogs=X1;function qw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=5;o++)for(let s=1;s<=5;s++){let u,c,f,_=Math.log(o/s);if(Math.abs(_)>1e-10?(f=e/_,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-_)),u<1.96*t){let w=Dr(c,o,s);w<i&&(i=w,n=[`${c} * log( ${o} / ${s} )`,bw,c,o,s])}}return n}function H1(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=2;o++)for(let s=1;s<=12;s++){let u,c,f,_=Math.pow(Math.E,o)/s;if(Math.abs(_)>1e-10?(f=e/_,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-_)),u<2*t){let w=Dr(c,o,s);w<i&&(i=w,n=[`${c} * (e ^ ${o} ) / ${s}`,V1,c,o,s])}}return n}function k_(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=5;o++)for(let s=1;s<=12;s++){let u,c,f,_=Math.pow(Math.PI,o)/s;if(Math.abs(_)>1e-10?(f=e/_,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-_)),u<2*t){let w=Dr(c,o,s);w<i&&(i=w,n=[`${c} * (pi ^ ${o} ) / ${s} )`,Z1,c,o,s])}}return n}function Kl(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Ew(e);if(n!=null)return n;let i=xw(e);return i!=null?i:null}function Ew(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=4;o++)for(let s=1;s<=4;s++){let u,c,f,_=o/s,w=Math.sin(_);if(Math.abs(w)>1e-10?(f=e/w,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-w)),u<2*t){let T=Dr(c,o,s);T<i&&(i=T,n=[`${c} * sin( ${o}/${s} )`,mw,c,o,s])}}return n}function xw(e){let t,r=e.toString().split(".");if(r.length===2){let o=r[1].length;t=1/Math.pow(10,o)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=null,i=Number.MAX_VALUE;for(let o=1;o<=13;o++)for(let s=1;s<=13;s++){let u,c,f,_=o/s,w=Math.sin(Math.PI*_);if(Math.abs(w)>1e-10?(f=e/w,c=Math.round(f),u=Math.abs(1-f/c)):(f=1,c=1,u=Math.abs(e-w)),u<23*t){let T=Dr(c,o,s);T<i&&(i=T,n=[`${c} * sin( ${o}/${s} * pi )`,Y1,c,o,s])}}return n}function Se(e){let t,r=e.toString().split(".");if(r.length===2){let T=r[1].length;t=1/Math.pow(10,T)}else return[""+Math.floor(e),Wr,Math.floor(e),1,2];console.log(`precision: ${t}`);let n=Number.MAX_VALUE,i=0,o=null,s=!0,u=$o(e);u!=null&&(i=Dr(u),i<n?(s&&console.log(`better explanation by approxRadicals: ${u} complexity: ${i}`),n=i,o=u):s&&console.log(`subpar explanation by approxRadicals: ${u} complexity: ${i}`));let c=Jl(e);c!=null&&(i=Dr(c),i<n?(s&&console.log(`better explanation by approxLogs: ${c} complexity: ${i}`),n=i,o=c):s&&console.log(`subpar explanation by approxLogs: ${c} complexity: ${i}`));let f=H1(e);f!=null&&(i=Dr(f),i<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfE: ${f} complexity: ${i}`),n=i,o=f):s&&console.log(`subpar explanation by approxRationalsOfPowersOfE: ${f} complexity: ${i}`));let _=k_(e);_!=null&&(i=Dr(_),i<n?(s&&console.log(`better explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${i}`),n=i,o=_):s&&console.log(`subpar explanation by approxRationalsOfPowersOfPI: ${_} complexity: ${i}`));let w=Kl(e);return w!=null&&(i=Dr(w),i<n?(s&&console.log(`better explanation by approxTrigonometric: ${w} complexity: ${i}`),n=i,o=w):s&&console.log(`subpar explanation by approxTrigonometric: ${w} complexity: ${i}`)),o}Jr.approxAll=Se;function Dr(e,t,r){let n=0;if(e instanceof Array){switch(e[1]){case Y1:n=4;break;case Z1:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case V1:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n}function pw(){for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,i=Math.sqrt(t)/r,o=$o(i),s=o[2]*Math.sqrt(o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} ) / ${r} . obtained: ${o}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing with 4 digits: 1 * sqrt( ${t} ) / ${r}`);let n=t/r,i=Math.sqrt(t)/r,o=i.toFixed(4),s=$o(Number(o)),u=s[2]*Math.sqrt(s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits: 1 * sqrt( ${t} ) / ${r} . obtained: ${s}`)}for(let t of[2,3,5,6,7,8,10])for(let r of[2,3,5,6,7,8,10]){if(t===r)continue;console.log(`testapproxRadicals testing: 1 * sqrt( ${t} / ${r} )`);let n=t/r,i=Math.sqrt(t/r),o=$o(i);if(o!=null){let s=o[2]*Math.sqrt(o[3]/o[4]);o[1]===D_&&Math.abs(i-s)>1e-15&&console.log(`fail testapproxRadicals: 1 * sqrt( ${t} / ${r} ) . obtained: ${o}`)}}for(let t of[1,2,3,5,6,7,8,10])for(let r of[1,2,3,5,6,7,8,10]){if(t===1&&r===1)continue;console.log(`testapproxRadicals testing with 4 digits:: 1 * sqrt( ${t} / ${r} )`);let n=t/r,i=Math.sqrt(t/r),o=i.toFixed(4),s=$o(Number(o)),u=s[2]*Math.sqrt(s[3]/s[4]);s[1]===D_&&Math.abs(i-u)>1e-15&&console.log(`fail testapproxRadicals with 4 digits:: 1 * sqrt( ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} ) / ${r}`);let n=t/r,i=Math.log(t)/r,o=Se(i),s=o[2]*Math.log(o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} ) / ${r} . obtained: ${o}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} ) / ${r}`);let n=t/r,i=Math.log(t)/r,o=i.toFixed(4),s=Se(Number(o)),u=s[2]*Math.log(s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing: 1 * log(${t} / ${r} )}`);let n=t/r,i=Math.log(t/r),o=Se(i),s=o[2]*Math.log(o[3]/o[4]);Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * log(${t} / ${r} ) . obtained: ${o}`)}for(let t=1;t<=5;t++)for(let r=1;r<=5;r++){console.log(`testApproxAll testing with 4 digits: 1 * log(${t} / ${r} )`);let n=t/r,i=Math.log(t/r),o=i.toFixed(4),s=Se(Number(o)),u=s[2]*Math.log(s[3]/s[4]);Math.abs(i-u)>1e-15&&console.log(`fail testApproxAll with 4 digits: 1 * log(${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,i=Math.pow(Math.E,t)/r,o=Se(i),s=o[2]*Math.pow(Math.E,o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * (e ^ ${t} ) / ${r} . obtained: ${o}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ ${t} ) / ${r}`);let n=t/r,i=Math.pow(Math.E,t)/r,o=i.toFixed(4),s=H1(Number(o)),u=s[2]*Math.pow(Math.E,s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ ${t} ) / ${r} . obtained: ${s}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`testApproxAll testing: 1 * pi ^ ${t} / ${r}`);let n=t/r,i=Math.pow(Math.PI,t)/r,o=Se(i),s=o[2]*Math.pow(Math.PI,o[3])/o[4];Math.abs(i-s)>1e-15&&console.log(`fail testApproxAll: 1 * pi ^ ${t} / ${r} ) . obtained: ${o}`)}for(let t=1;t<=2;t++)for(let r=1;r<=12;r++){console.log(`approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ ${t} / ${r}`);let n=t/r,i=Math.pow(Math.PI,t)/r,o=i.toFixed(4),s=k_(Number(o)),u=s[2]*Math.pow(Math.PI,s[3])/s[4];Math.abs(i-u)>1e-15&&console.log(`fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ ${t} / ${r} ) . obtained: ${s}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing: 1 * sin( ${t}/${r} )}`);let n=t/r,i=Math.sin(n),o=Se(i),s=o[3]/o[4],u=o[2]*Math.sin(s);Math.abs(i-u)>1e-15&&console.log(`fail testApproxAll: 1 * sin( ${t}/${r} ) . obtained: ${o}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 5 digits: 1 * sin( ${t}/${r} )`);let n=t/r,i=Math.sin(n),o=i.toFixed(5),s=Se(Number(o));s==null&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),f=Math.abs(i-c);f>1e-14&&console.log(`fail testApproxAll with 5 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${f}`)}for(let t=1;t<=4;t++)for(let r=1;r<=4;r++){console.log(`testApproxAll testing with 4 digits: 1 * sin( ${t}/${r} )`);let n=t/r,i=Math.sin(n),o=i.toFixed(4),s=Se(Number(o));s==null&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained:  undefined `);let u=s[3]/s[4],c=s[2]*Math.sin(u),f=Math.abs(i-c);f>1e-14&&console.log(`fail testApproxAll with 4 digits: 1 * sin( ${t}/${r} ) . obtained: ${s} error: ${f}`)}let e=0;Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),e=0,Se(e)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),e=Math.sqrt(2),Se(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),e=1.41,Se(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),e=1.4,$o(e)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),e=.6,Jl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),e=.69,Jl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),e=.7,Jl(e)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),e=1.09,Jl(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),e=1.09,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),e=1.098,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),e=1.1,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),e=1.11,Se(e)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),e=Math.sqrt(3),Se(e)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),e=1,Se(e)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),e=3.141592,Se(e)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),e=31.41592,Se(e)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),e=314.1592,Se(e)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),e=3141592653589793e-8,Se(e)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),e=Math.sqrt(2),Kl(e)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),e=Math.sqrt(3),Kl(e)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),e=(Math.sqrt(6)-Math.sqrt(2))/4,Se(e)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),e=Math.sqrt(2-Math.sqrt(2))/2,Se(e)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),e=(Math.sqrt(6)+Math.sqrt(2))/4,Se(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),e=Math.sqrt(2+Math.sqrt(3))/2,Se(e)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),e=(Math.sqrt(5)-1)/4,Se(e)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),e=Math.sqrt(10-2*Math.sqrt(5))/4,Se(e)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),e=Math.sin(Math.PI/7),Se(e)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),e=Math.sin(Math.PI/9),Se(e)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),e=1836.15267,k_(e)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267");for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){console.log(`approxTrigonometric testing: 1 * sin( ${t}/${r} * pi )`);let n=t/r;e=Math.sin(Math.PI*n);let i=Kl(e),o=i[3]/i[4],s=i[2]*Math.sin(Math.PI*o);Math.abs(e-s)>1e-15&&console.log(`fail approxTrigonometric: 1 * sin( ${t}/${r} * pi ) . obtained: ${i}`)}for(let t=1;t<=13;t++)for(let r=1;r<=13;r++){if(t===5&&r===11||t===6&&r===11)continue;console.log(`approxTrigonometric testing with 4 digits: 1 * sin( ${t}/${r} * pi )`);let n=t/r,i=Math.sin(Math.PI*n),o=i.toFixed(4),s=Kl(Number(o)),u=s[3]/s[4],c=s[2]*Math.sin(Math.PI*u),f=Math.abs(i-c);f>1e-14&&console.log(`fail approxTrigonometric with 4 digits: 1 * sin( ${t}/${r} * pi ) . obtained: ${s} error: ${f}`)}return console.log("testApprox done")}Jr.testApprox=pw});var W1=A(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.Eval_arccos=void 0;var re=N(),Kr=$(),dr=j(),hw=G(),kn=Q(),Q1=ee(),Ki=X();function Aw(e){return Ow(hw.Eval(re.cadr(e)))}sd.Eval_arccos=Aw;function Ow(e){if(re.car(e)===Kr.symbol(re.COS))return re.cadr(e);if(re.isdouble(e))return dr.double(Math.acos(e.d));if(kn.isoneoversqrttwo(e)||re.ismultiply(e)&&kn.equalq(re.car(re.cdr(e)),1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===Kr.symbol(re.POWER)&&kn.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&kn.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?dr.double(Math.PI/4):Ki.multiply(dr.rational(1,4),Kr.symbol(re.PI));if(kn.isminusoneoversqrttwo(e)||re.ismultiply(e)&&kn.equalq(re.car(re.cdr(e)),-1,2)&&re.car(re.car(re.cdr(re.cdr(e))))===Kr.symbol(re.POWER)&&kn.equaln(re.car(re.cdr(re.car(re.cdr(re.cdr(e))))),2)&&kn.equalq(re.car(re.cdr(re.cdr(re.car(re.cdr(re.cdr(e)))))),1,2))return re.defs.evaluatingAsFloats?dr.double(Math.PI*3/4):Ki.multiply(dr.rational(3,4),Kr.symbol(re.PI));if(kn.isSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?dr.double(Math.PI/6):Ki.multiply(dr.rational(1,6),Kr.symbol(re.PI));if(kn.isMinusSqrtThreeOverTwo(e))return re.defs.evaluatingAsFloats?dr.double(5*Math.PI/6):Ki.multiply(dr.rational(5,6),Kr.symbol(re.PI));if(!re.isrational(e))return Q1.makeList(Kr.symbol(re.ARCCOS),e);switch(dr.nativeInt(Ki.multiply(e,dr.integer(2)))){case-2:return re.Constants.Pi();case-1:return re.defs.evaluatingAsFloats?dr.double(Math.PI*2/3):Ki.multiply(dr.rational(2,3),Kr.symbol(re.PI));case 0:return re.defs.evaluatingAsFloats?dr.double(Math.PI/2):Ki.multiply(dr.rational(1,2),Kr.symbol(re.PI));case 1:return re.defs.evaluatingAsFloats?dr.double(Math.PI/3):Ki.multiply(dr.rational(1,3),Kr.symbol(re.PI));case 2:return re.Constants.Zero();default:return Q1.makeList(Kr.symbol(re.ARCCOS),e)}}});var K1=A(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.Eval_arccosh=void 0;var Bo=N(),Mw=Ee(),J1=$(),Tw=j(),Nw=G(),Iw=Q(),Sw=ee();function ww(e){return Rw(Nw.Eval(Bo.cadr(e)))}ad.Eval_arccosh=ww;function Rw(e){if(Bo.car(e)===J1.symbol(Bo.COSH))return Bo.cadr(e);if(Bo.isdouble(e)){let{d:t}=e;return t<1&&Mw.stop("arccosh function argument is less than 1.0"),t=Math.log(t+Math.sqrt(t*t-1)),Tw.double(t)}return Iw.isplusone(e)?Bo.Constants.zero:Sw.makeList(J1.symbol(Bo.ARCCOSH),e)}});var tq=A(ld=>{"use strict";Object.defineProperty(ld,"__esModule",{value:!0});ld.Eval_arcsin=void 0;var ne=N(),kr=$(),er=j(),Lw=G(),Un=Q(),eq=ee(),bi=X();function Cw(e){return Pw(Lw.Eval(ne.cadr(e)))}ld.Eval_arcsin=Cw;function Pw(e){if(ne.car(e)===kr.symbol(ne.SIN))return ne.cadr(e);if(ne.isdouble(e))return er.double(Math.asin(e.d));if(Un.isoneoversqrttwo(e)||ne.ismultiply(e)&&Un.equalq(ne.car(ne.cdr(e)),1,2)&&ne.car(ne.car(ne.cdr(ne.cdr(e))))===kr.symbol(ne.POWER)&&Un.equaln(ne.car(ne.cdr(ne.car(ne.cdr(ne.cdr(e))))),2)&&Un.equalq(ne.car(ne.cdr(ne.cdr(ne.car(ne.cdr(ne.cdr(e)))))),1,2))return bi.multiply(er.rational(1,4),kr.symbol(ne.PI));if(Un.isminusoneoversqrttwo(e)||ne.ismultiply(e)&&Un.equalq(ne.car(ne.cdr(e)),-1,2)&&ne.car(ne.car(ne.cdr(ne.cdr(e))))===kr.symbol(ne.POWER)&&Un.equaln(ne.car(ne.cdr(ne.car(ne.cdr(ne.cdr(e))))),2)&&Un.equalq(ne.car(ne.cdr(ne.cdr(ne.car(ne.cdr(ne.cdr(e)))))),1,2))return ne.defs.evaluatingAsFloats?er.double(-Math.PI/4):bi.multiply(er.rational(-1,4),kr.symbol(ne.PI));if(Un.isSqrtThreeOverTwo(e))return ne.defs.evaluatingAsFloats?er.double(Math.PI/3):bi.multiply(er.rational(1,3),kr.symbol(ne.PI));if(Un.isMinusSqrtThreeOverTwo(e))return ne.defs.evaluatingAsFloats?er.double(-Math.PI/3):bi.multiply(er.rational(-1,3),kr.symbol(ne.PI));if(!ne.isrational(e))return eq.makeList(kr.symbol(ne.ARCSIN),e);switch(er.nativeInt(bi.multiply(e,er.integer(2)))){case-2:return ne.defs.evaluatingAsFloats?er.double(-Math.PI/2):bi.multiply(er.rational(-1,2),kr.symbol(ne.PI));case-1:return ne.defs.evaluatingAsFloats?er.double(-Math.PI/6):bi.multiply(er.rational(-1,6),kr.symbol(ne.PI));case 0:return ne.Constants.Zero();case 1:return ne.defs.evaluatingAsFloats?er.double(Math.PI/6):bi.multiply(er.rational(1,6),kr.symbol(ne.PI));case 2:return ne.defs.evaluatingAsFloats?er.double(Math.PI/2):bi.multiply(er.rational(1,2),kr.symbol(ne.PI));default:return eq.makeList(kr.symbol(ne.ARCSIN),e)}}});var nq=A(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.Eval_arcsinh=void 0;var Go=N(),rq=$(),Dw=j(),kw=G(),Uw=Q(),$w=ee();function Bw(e){return Gw(kw.Eval(Go.cadr(e)))}ud.Eval_arcsinh=Bw;function Gw(e){if(Go.car(e)===rq.symbol(Go.SINH))return Go.cadr(e);if(Go.isdouble(e)){let{d:t}=e;return t=Math.log(t+Math.sqrt(t*t+1)),Dw.double(t)}return Uw.isZeroAtomOrTensor(e)?Go.Constants.zero:$w.makeList(rq.symbol(Go.ARCSINH),e)}});var oq=A(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});cd.Eval_arctanh=void 0;var Fo=N(),Fw=Ee(),iq=$(),jw=j(),zw=G(),Yw=Q(),Zw=ee();function Vw(e){return Xw(zw.Eval(Fo.cadr(e)))}cd.Eval_arctanh=Vw;function Xw(e){if(Fo.car(e)===iq.symbol(Fo.TANH))return Fo.cadr(e);if(Fo.isdouble(e)){let{d:t}=e;return(t<-1||t>1)&&Fw.stop("arctanh function argument is not in the interval [-1,1]"),t=Math.log((1+t)/(1-t))/2,jw.double(t)}return Yw.isZeroAtomOrTensor(e)?Fo.Constants.zero:Zw.makeList(iq.symbol(Fo.ARCTANH),e)}});var lq=A(dd=>{"use strict";Object.defineProperty(dd,"__esModule",{value:!0});dd.Eval_binomial=void 0;var gi=N(),$_=Ie(),Hw=ce(),sq=G(),B_=po(),aq=X();function Qw(e){let t=sq.Eval(gi.cadr(e)),r=sq.Eval(gi.caddr(e));return Ww(t,r)}dd.Eval_binomial=Qw;function Ww(e,t){return Jw(e,t)}function Jw(e,t){return Kw(e,t)?aq.divide(aq.divide(B_.factorial(e),B_.factorial(t)),B_.factorial(Hw.subtract(e,t))):gi.Constants.zero}function Kw(e,t){return gi.isNumericAtom(e)&&$_.lessp(e,gi.Constants.zero)||gi.isNumericAtom(t)&&$_.lessp(t,gi.Constants.zero)?!1:!(gi.isNumericAtom(e)&&gi.isNumericAtom(t)&&$_.lessp(e,t))}});var cq=A(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.Eval_ceiling=void 0;var Ma=N(),eR=$(),tR=ce(),rR=j(),nR=G(),uq=Q(),iR=ee(),oR=un();function sR(e){return aR(nR.Eval(Ma.cadr(e)))}fd.Eval_ceiling=sR;function aR(e){return lR(e)}function lR(e){if(!Ma.isNumericAtom(e))return iR.makeList(eR.symbol(Ma.CEILING),e);if(Ma.isdouble(e))return rR.double(Math.ceil(e.d));if(uq.isinteger(e))return e;let t=new Ma.Num(oR.mdiv(e.q.a,e.q.b));return uq.isnegativenumber(e)||(t=tR.add(t,Ma.Constants.one)),t}});var mq=A(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.Eval_choose=void 0;var yi=N(),G_=Ie(),uR=ce(),dq=G(),F_=po(),fq=X();function cR(e){let t=dq.Eval(yi.cadr(e)),r=dq.Eval(yi.caddr(e));return dR(t,r)}md.Eval_choose=cR;function dR(e,t){return fR(e,t)?fq.divide(fq.divide(F_.factorial(e),F_.factorial(t)),F_.factorial(uR.subtract(e,t))):yi.Constants.zero}function fR(e,t){return yi.isNumericAtom(e)&&G_.lessp(e,yi.Constants.zero)||yi.isNumericAtom(t)&&G_.lessp(t,yi.Constants.zero)?!1:!(yi.isNumericAtom(e)&&yi.isNumericAtom(t)&&G_.lessp(e,t))}});var z_=A(Ta=>{"use strict";Object.defineProperty(Ta,"__esModule",{value:!0});Ta.expcos=Ta.Eval_expcos=void 0;var j_=N(),_q=Ie(),mR=ce(),bq=j(),_R=G(),eu=X();function bR(e){return gq(_R.Eval(j_.cadr(e)))}Ta.Eval_expcos=bR;function gq(e){return mR.add(eu.multiply(_q.exponential(eu.multiply(j_.Constants.imaginaryunit,e)),bq.rational(1,2)),eu.multiply(_q.exponential(eu.multiply(eu.negate(j_.Constants.imaginaryunit),e)),bq.rational(1,2)))}Ta.expcos=gq});var Y_=A(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.expsin=Na.Eval_expsin=void 0;var tu=N(),yq=Ie(),gR=ce(),vq=j(),yR=G(),jo=X();function vR(e){return qq(yR.Eval(tu.cadr(e)))}Na.Eval_expsin=vR;function qq(e){return gR.subtract(jo.multiply(jo.divide(yq.exponential(jo.multiply(tu.Constants.imaginaryunit,e)),tu.Constants.imaginaryunit),vq.rational(1,2)),jo.multiply(jo.divide(yq.exponential(jo.multiply(jo.negate(tu.Constants.imaginaryunit),e)),tu.Constants.imaginaryunit),vq.rational(1,2)))}Na.expsin=qq});var xq=A(_d=>{"use strict";Object.defineProperty(_d,"__esModule",{value:!0});_d.Eval_circexp=void 0;var _t=N(),Ia=$(),zo=Ie(),Sa=ce(),Z_=j(),Eq=G(),qR=z_(),ER=Y_(),bn=X(),xR=qt();function pR(e){let t=V_(Eq.Eval(_t.cadr(e)));return Eq.Eval(t)}_d.Eval_circexp=pR;function V_(e){if(_t.car(e)===Ia.symbol(_t.COS))return qR.expcos(_t.cadr(e));if(_t.car(e)===Ia.symbol(_t.SIN))return ER.expsin(_t.cadr(e));if(_t.car(e)===Ia.symbol(_t.TAN)){e=_t.cadr(e);let t=zo.exponential(bn.multiply(_t.Constants.imaginaryunit,e)),r=zo.exponential(bn.negate(bn.multiply(_t.Constants.imaginaryunit,e)));return bn.divide(bn.multiply(Sa.subtract(r,t),_t.Constants.imaginaryunit),Sa.add(t,r))}return _t.car(e)===Ia.symbol(_t.COSH)?(e=_t.cadr(e),bn.multiply(Sa.add(zo.exponential(e),zo.exponential(bn.negate(e))),Z_.rational(1,2))):_t.car(e)===Ia.symbol(_t.SINH)?(e=_t.cadr(e),bn.multiply(Sa.subtract(zo.exponential(e),zo.exponential(bn.negate(e))),Z_.rational(1,2))):_t.car(e)===Ia.symbol(_t.TANH)?(e=zo.exponential(bn.multiply(_t.cadr(e),Z_.integer(2))),bn.divide(Sa.subtract(e,_t.Constants.one),Sa.add(e,_t.Constants.one))):_t.iscons(e)?e.map(V_):(e.k===_t.TENSOR&&(e=xR.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(V_)),e)}});var hq=A(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});bd.Eval_contract=void 0;var hR=St(),vi=N(),pq=Ee(),AR=$(),OR=ce(),X_=j(),H_=G(),MR=Q();function TR(e){let t=H_.Eval(vi.cadr(e)),r,n;return vi.cddr(e)===AR.symbol(vi.NIL)?(r=vi.Constants.one,n=X_.integer(2)):(r=H_.Eval(vi.caddr(e)),n=H_.Eval(vi.cadddr(e))),NR(t,r,n)}bd.Eval_contract=TR;function NR(e,t,r){let n=[],i=[];if(!vi.istensor(e))return MR.isZeroAtomOrTensor(e)||pq.stop("contract: tensor expected, 1st arg is not a tensor"),vi.Constants.zero;let o=X_.nativeInt(t),s=X_.nativeInt(r),{ndim:u}=e.tensor;(o<1||o>u||s<1||s>u||o===s||e.tensor.dim[o-1]!==e.tensor.dim[s-1])&&pq.stop("contract: index out of range"),o--,s--;let c=e.tensor.dim[o],f=1;for(let k=0;k<u;k++)k!==o&&k!==s&&(f*=e.tensor.dim[k]);t=hR.alloc_tensor(f),t.tensor.ndim=u-2;let _=0;for(let k=0;k<u;k++)k!==o&&k!==s&&(t.tensor.dim[_++]=e.tensor.dim[k]);let w=e.tensor.elem,T=t.tensor.elem;for(let k=0;k<u;k++)n[k]=0,i[k]=e.tensor.dim[k];for(let k=0;k<f;k++){let V=vi.Constants.zero;for(let Y=0;Y<c;Y++){n[o]=Y,n[s]=Y;let Ae=0;for(let tt=0;tt<u;tt++)Ae=Ae*i[tt]+n[tt];V=OR.add(V,w[Ae])}T[k]=V;for(let Y=u-1;Y>=0;Y--)if(!(Y===o||Y===s)){if(++n[Y]<i[Y])break;n[Y]=0}}return f===1?T[0]:t}});var Oq=A(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd.Eval_defint=void 0;var qi=N(),IR=ce(),wa=G(),SR=Gl(),Aq=Zr();function wR(e){let t=wa.Eval(qi.cadr(e));for(e=qi.cddr(e);qi.iscons(e);){let r=wa.Eval(qi.car(e));e=qi.cdr(e);let n=wa.Eval(qi.car(e));e=qi.cdr(e);let i=wa.Eval(qi.car(e));e=qi.cdr(e),t=SR.integral(t,r);let o=wa.Eval(Aq.subst(t,r,i)),s=wa.Eval(Aq.subst(t,r,n));t=IR.subtract(o,s)}return t}gd.Eval_defint=wR});var yd=A(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.degree=Ra.Eval_degree=void 0;var en=N(),RR=$(),Q_=Ie(),Mq=G(),LR=Vr(),CR=Q();function PR(e){let t=Mq.Eval(en.cadr(e));e=Mq.Eval(en.caddr(e));let r=e===RR.symbol(en.NIL)?LR.guess(t):e;return Tq(t,r)}Ra.Eval_degree=PR;function Tq(e,t){return Nq(e,t,en.Constants.zero)}Ra.degree=Tq;function Nq(e,t,r){return Q_.equal(e,t)?CR.isZeroAtomOrTensor(r)&&(r=en.Constants.one):en.ispower(e)?Q_.equal(en.cadr(e),t)&&en.isNumericAtom(en.caddr(e))&&Q_.lessp(r,en.caddr(e))&&(r=en.caddr(e)):en.iscons(e)&&(r=e.tail().reduce((n,i)=>Nq(i,t,n),r)),r}});var Lq=A(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.Eval_eigenvec=eo.Eval_eigenval=eo.Eval_eigen=void 0;var Ur=N(),vd=Ee(),Yo=$(),Iq=j(),Sq=G(),DR=wn(),wq=ee(),kR=ti(),Rq=qt(),ue=0,Xt=[],Ei=[];function UR(e){let{arg:t}=W_(e);t||vd.stop("eigen: argument is not a square matrix");let[r,n]=J_(Ur.EIGEN,t);return e=Yo.usr_symbol("D"),Yo.set_binding(e,r),e=Yo.usr_symbol("Q"),Yo.set_binding(e,n),Yo.symbol(Ur.NIL)}eo.Eval_eigen=UR;function $R(e){let{arg:t,invalid:r}=W_(e);if(r)return wq.makeList(Yo.symbol(Ur.EIGENVAL),r);let[n,i]=J_(Ur.EIGENVAL,t);return n}eo.Eval_eigenval=$R;function BR(e){let{arg:t,invalid:r}=W_(e);if(r)return wq.makeList(Yo.symbol(Ur.EIGENVEC),r);let[n,i]=J_(Ur.EIGENVEC,t);return i}eo.Eval_eigenvec=BR;function W_(e){if(e=Sq.Eval(DR.yyfloat(Sq.Eval(Ur.cadr(e)))),!Ur.istensor(e))return{invalid:e};(e.tensor.ndim!==2||e.tensor.dim[0]!==e.tensor.dim[1])&&vd.stop("eigen: argument is not a square matrix"),ue=e.tensor.dim[0],GR(e)||vd.stop("eigen: matrix is not numerical");for(let t=0;t<ue-1;t++)for(let r=t+1;r<ue;r++){let n=e.tensor.elem[ue*t+r],i=e.tensor.elem[ue*r+t];Math.abs(n.d-i.d)>1e-10&&vd.stop("eigen: matrix is not symmetrical")}return{arg:e}}function GR(e){for(let t=0;t<ue;t++)for(let r=0;r<ue;r++)if(!Ur.isdouble(e.tensor.elem[ue*t+r]))return!1;return!0}function J_(e,t){for(let o=0;o<ue*ue;o++)Xt[o]=0;for(let o=0;o<ue*ue;o++)Ei[o]=0;for(let o=0;o<ue;o++){Xt[ue*o+o]=t.tensor.elem[ue*o+o].d;for(let s=o+1;s<ue;s++)Xt[ue*o+s]=t.tensor.elem[ue*o+s].d,Xt[ue*s+o]=t.tensor.elem[ue*o+s].d}for(let o=0;o<ue;o++){Ei[ue*o+o]=1;for(let s=o+1;s<ue;s++)Ei[ue*o+s]=0,Ei[ue*s+o]=0}let r=0;for(r=0;r<100&&FR()!==0;r++);r===100&&kR.print_str(`
note: eigen did not converge
`);let n;if(e===Ur.EIGEN||e===Ur.EIGENVAL){n=Rq.copy_tensor(t);for(let o=0;o<ue;o++)for(let s=0;s<ue;s++)n.tensor.elem[ue*o+s]=Iq.double(Xt[ue*o+s])}let i;if(e===Ur.EIGEN||e===Ur.EIGENVEC){i=Rq.copy_tensor(t);for(let o=0;o<ue;o++)for(let s=0;s<ue;s++)i.tensor.elem[ue*o+s]=Iq.double(Ei[ue*o+s])}return[n,i]}function FR(){let e=0;for(let t=0;t<ue-1;t++)for(let r=t+1;r<ue;r++)Xt[ue*t+r]!==0&&(jR(t,r),e++);return e}function jR(e,t){let r=.5*(Xt[ue*e+e]-Xt[ue*t+t])/Xt[ue*e+t],n=1/(Math.abs(r)+Math.sqrt(r*r+1));r<0&&(n=-n);let i=1/Math.sqrt(n*n+1),o=n*i;for(let s=0;s<ue;s++){let u=Xt[ue*e+s],c=Xt[ue*t+s];Xt[ue*e+s]=i*u+o*c,Xt[ue*t+s]=i*c-o*u}for(let s=0;s<ue;s++){let u=Xt[ue*s+e],c=Xt[ue*s+t];Xt[ue*s+e]=i*u+o*c,Xt[ue*s+t]=i*c-o*u}for(let s=0;s<ue;s++){let u=Ei[ue*e+s],c=Ei[ue*t+s];Ei[ue*e+s]=i*u+o*c,Ei[ue*t+s]=i*c-o*u}Xt[ue*e+t]=0,Xt[ue*t+e]=0}});var K_=A(La=>{"use strict";Object.defineProperty(La,"__esModule",{value:!0});La.erfc=La.Eval_erfc=void 0;var qd=N(),zR=$(),YR=j(),ZR=G(),VR=Q(),XR=ee();function HR(e){return QR(ZR.Eval(qd.cadr(e)))}La.Eval_erfc=HR;function QR(e){if(qd.isdouble(e)){let t=Cq(e.d);return YR.double(t)}return VR.isZeroAtomOrTensor(e)?qd.Constants.one:XR.makeList(zR.symbol(qd.ERFC),e)}function Cq(e){if(e===0)return 1;let t=Math.abs(e),r=1/(1+.5*t),n=r*Math.exp(-t*t-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277)))))))));return e>=0?n:2-n}La.erfc=Cq});var $q=A(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});Ed.Eval_erf=void 0;var ru=N(),Pq=$(),WR=j(),JR=K_(),KR=G(),Dq=Q(),kq=ee(),Uq=X();function eL(e){return tL(KR.Eval(ru.cadr(e)))}Ed.Eval_erf=eL;function tL(e){return ru.isdouble(e)?WR.double(1-JR.erfc(e.d)):Dq.isZeroAtomOrTensor(e)?ru.Constants.zero:Dq.isnegativeterm(e)?Uq.negate(kq.makeList(Pq.symbol(ru.ERF),Uq.negate(e))):kq.makeList(Pq.symbol(ru.ERF),e)}});var Fq=A(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.factors=void 0;var Bq=N();function rL(e){let t=[];return Bq.isadd(e)?e.tail().forEach(r=>t.push(...Gq(r))):t.push(...Gq(e)),t}xd.factors=rL;function Gq(e){return Bq.ismultiply(e)?e.tail():[e]}});var Qq=A(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.Eval_expand=void 0;var eb=St(),lt=N(),jq=or(),nL=$(),iL=Ie(),tb=ce(),$r=j(),zq=yd(),oL=Mn(),rb=G(),sL=Es(),Yq=Fq(),Zq=al(),aL=Vr(),Vq=Bi(),lL=Nl(),nu=Q(),Br=X(),uL=oi(),to=Et(),cL=Gu(),dL=qt();function fL(e){let t=rb.Eval(lt.cadr(e)),r=rb.Eval(lt.caddr(e)),n=r===nL.symbol(lt.NIL)?aL.guess(t):r;return nb(t,n)}pd.Eval_expand=fL;function nb(e,t){if(lt.istensor(e))return mL(e,t);if(lt.isadd(e))return e.tail().reduce((u,c)=>tb.add(u,nb(c,t)),lt.Constants.zero);let r=uL.numerator(e),n=oL.denominator(e);if([n,r]=_L(n,r,t),(nu.isone(r)||nu.isone(n))&&(!nu.ispolyexpandedform(n,t)||nu.isone(n)))return e;let i=cL.divpoly(r,n,t);if(r=tb.subtract(r,Br.multiply(n,i)),nu.isZeroAtomOrTensor(r))return i;n=sL.factorpoly(n,t);let o=bL(n,t);r=yL(r,o,t),n=vL(n,o,t);let s;if(lt.istensor(o)){let u=lt.doexpand(lL.inv,o);s=Vq.inner(Vq.inner(u,r),n)}else{let u=lt.doexpand(Br.divide,r,o);s=Br.multiply(u,n)}return tb.add(s,i)}function mL(e,t){return e=dL.copy_tensor(e),e.tensor.elem=e.tensor.elem.map(r=>nb(r,t)),e}function _L(e,t,r){let n=[...Yq.factors(e),...Yq.factors(t)],i=0;for(let o=0;o<n.length;o++){let s=n[o];if(!lt.ispower(s)||lt.cadr(s)!==r)continue;let u=$r.nativeInt(lt.caddr(s));isNaN(u)||u<i&&(i=u)}return i===0?[e,t]:(e=Br.multiply(e,to.power(r,$r.integer(-i))),t=Br.multiply(t,to.power(r,$r.integer(-i))),[e,t])}function bL(e,t){let r=[];lt.ismultiply(e)?e.tail().forEach(o=>r.push(...Xq(e,o,t))):r.push(...Xq(e,e,t));let n=r.length;if(n===1)return r[0];let i=eb.alloc_tensor(n*n);i.tensor.ndim=2,i.tensor.dim[0]=n,i.tensor.dim[1]=n;for(let o=0;o<n;o++)for(let s=0;s<n;s++){let u=to.power(t,$r.integer(o)),c=lt.doexpand(Br.divide,r[s],u);i.tensor.elem[n*o+s]=Zq.filter(c,t)}return i}function Xq(e,t,r){let n,i=0;if(!jq.Find(t,r))return[];let o=lt.doexpand(gL,e,t);lt.ispower(t)?(i=$r.nativeInt(lt.caddr(t)),n=lt.cadr(t)):(i=1,n=t);let s=[],u=$r.nativeInt(zq.degree(n,r));for(let c=0;c<i;c++)for(let f=0;f<u;f++){let _=to.power(n,$r.integer(c)),w=lt.doexpand(Br.multiply,o,_);_=to.power(r,$r.integer(f));let T=lt.doexpand(Br.multiply,w,_);s.push(T)}return s}function gL(e,t){let r=lt.Constants.one;if(lt.ismultiply(e)){let n=[];e.tail().forEach(i=>{iL.equal(i,t)||n.push(rb.Eval(i))}),r=Br.multiply_all(n)}return r}function yL(e,t,r){if(!lt.istensor(t))return e;let n=t.tensor.dim[0],i=eb.alloc_tensor(n);i.tensor.ndim=1,i.tensor.dim[0]=n;for(let o=0;o<n;o++){let s=to.power(r,$r.integer(o)),u=lt.doexpand(Br.divide,e,s);i.tensor.elem[o]=Zq.filter(u,r)}return i}function vL(e,t,r){if(!lt.istensor(t))return Br.reciprocate(e);let n=[];lt.ismultiply(e)?e.tail().forEach(s=>{n.push(...Hq(s,r))}):n=Hq(e,r);let i=n.length,o=eb.alloc_tensor(i);return o.tensor.ndim=1,o.tensor.dim[0]=i,o.tensor.elem=n,o}function Hq(e,t){let r=1;if(!jq.Find(e,t))return[];lt.ispower(e)&&(r=$r.nativeInt(lt.caddr(e)),e=lt.cadr(e));let n=[],i=$r.nativeInt(zq.degree(e,t));for(let o=r;o>0;o--)for(let s=0;s<i;s++)n.push(Br.multiply(Br.reciprocate(to.power(e,$r.integer(o))),to.power(t,$r.integer(s))));return n}});var Jq=A(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});hd.Eval_floor=void 0;var Ca=N(),qL=$(),EL=ce(),xL=j(),pL=G(),Wq=Q(),hL=ee(),AL=un();function OL(e){return ML(pL.Eval(Ca.cadr(e)))}hd.Eval_floor=OL;function ML(e){return TL(e)}function TL(e){if(!Ca.isNumericAtom(e))return hL.makeList(qL.symbol(Ca.FLOOR),e);if(Ca.isdouble(e))return xL.double(Math.floor(e.d));if(Wq.isinteger(e))return e;let t=new Ca.Num(AL.mdiv(e.q.a,e.q.b));return Wq.isnegativenumber(e)&&(t=EL.add(t,Ca.Constants.negOne)),t}});var Kq=A(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.Eval_for=void 0;var Pa=N(),NL=Ee(),Ad=$(),IL=j(),ib=G();function SL(e){let t=Pa.caddr(e);Pa.issymbol(t)||NL.stop("for: 2nd arg should be the variable to loop over");let r=ib.evaluate_integer(Pa.cadddr(e));if(isNaN(r))return e;let n=ib.evaluate_integer(Pa.caddddr(e));if(isNaN(n))return e;let i=Ad.get_binding(t);for(let o=r;o<=n;o++)Ad.set_binding(t,IL.integer(o)),ib.Eval(Pa.cadr(e));return Ad.set_binding(t,i),Ad.symbol(Pa.NIL)}Od.Eval_for=SL});var nE=A(Td=>{"use strict";Object.defineProperty(Td,"__esModule",{value:!0});Td.Eval_gamma=void 0;var We=N(),eE=$(),wL=ce(),ob=j(),RL=G(),LL=Q(),tE=ee(),xi=X(),rE=Et(),CL=Wn();function PL(e){return Md(RL.Eval(We.cadr(e)))}Td.Eval_gamma=PL;function Md(e){return DL(e)}function DL(e){return We.isrational(e)&&We.MEQUAL(e.q.a,1)&&We.MEQUAL(e.q.b,2)?rE.power(We.Constants.Pi(),ob.rational(1,2)):We.isrational(e)&&We.MEQUAL(e.q.a,3)&&We.MEQUAL(e.q.b,2)?xi.multiply(rE.power(We.Constants.Pi(),ob.rational(1,2)),ob.rational(1,2)):LL.isnegativeterm(e)?xi.divide(xi.multiply(We.Constants.Pi(),We.Constants.negOne),xi.multiply(xi.multiply(CL.sine(xi.multiply(We.Constants.Pi(),e)),e),Md(xi.negate(e)))):We.isadd(e)?kL(e):tE.makeList(eE.symbol(We.GAMMA),e)}function kL(e){let t=We.cdr(e);return We.isrational(We.car(t))&&We.MEQUAL(We.car(t).q.a,1)&&We.MEQUAL(We.car(t).q.b,1)?xi.multiply(We.cadr(t),Md(We.cadr(t))):We.isrational(We.car(t))&&We.MEQUAL(We.car(t).q.a,-1)&&We.MEQUAL(We.car(t).q.b,1)?xi.divide(Md(We.cadr(t)),wL.add(We.cadr(t),We.Constants.negOne)):tE.makeList(eE.symbol(We.GAMMA),e)}});var iE=A(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.Eval_isprime=void 0;var sb=N(),UL=G(),$L=Q(),BL=zf();function GL(e){return FL(UL.Eval(sb.cadr(e)))}Nd.Eval_isprime=GL;function FL(e){return $L.isnonnegativeinteger(e)&&BL.mprime(e.q.a)?sb.Constants.one:sb.Constants.zero}});var sE=A(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});Ld.Eval_laguerre=void 0;var gn=N(),Id=$(),Sd=ce(),wd=j(),Rd=G(),jL=ee(),ab=X(),zL=Zr();function YL(e){let t=Rd.Eval(gn.cadr(e)),r=Rd.Eval(gn.caddr(e)),n=Rd.Eval(gn.cadddr(e)),i=n===Id.symbol(gn.NIL)?gn.Constants.zero:n;return ZL(t,r,i)}Ld.Eval_laguerre=YL;function ZL(e,t,r){let n=wd.nativeInt(t);return n<0||isNaN(n)?jL.makeList(Id.symbol(gn.LAGUERRE),e,t,r):gn.issymbol(e)?oE(n,e,r):Rd.Eval(zL.subst(oE(n,Id.symbol(gn.SECRETX),r),Id.symbol(gn.SECRETX),e))}function oE(e,t,r){let n=gn.Constants.zero,i=gn.Constants.one;for(let o=0;o<e;o++){let s=ab.divide(Sd.subtract(ab.multiply(Sd.add(Sd.subtract(wd.integer(2*o+1),t),r),i),ab.multiply(Sd.add(wd.integer(o),r),n)),wd.integer(o+1));n=i,i=s}return i}});var lE=A(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});Cd.Eval_leading=void 0;var lb=N(),VL=$(),XL=yd(),aE=G(),HL=al(),QL=Vr(),WL=X(),JL=Et();function KL(e){let t=aE.Eval(lb.cadr(e));e=aE.Eval(lb.caddr(e));let r=e===VL.symbol(lb.NIL)?QL.guess(t):e;return eC(t,r)}Cd.Eval_leading=KL;function eC(e,t){let r=XL.degree(e,t);return HL.filter(WL.divide(e,JL.power(t,r)),t)}});var dE=A(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});Dd.Eval_legendre=void 0;var tr=N(),Da=$(),ub=Ie(),uE=ce(),Zo=j(),tC=Ri(),rC=wo(),Pd=G(),nC=ee(),Vo=X(),iC=Et(),oC=Wn(),sC=Zr();function aC(e){let t=Pd.Eval(tr.cadr(e)),r=Pd.Eval(tr.caddr(e)),n=Pd.Eval(tr.cadddr(e)),i=n===Da.symbol(tr.NIL)?tr.Constants.zero:n;return lC(t,r,i)}Dd.Eval_legendre=aC;function lC(e,t,r){return uC(e,t,r)}function uC(e,t,r){let n=Zo.nativeInt(t),i=Zo.nativeInt(r);if(n<0||isNaN(n)||i<0||isNaN(i))return nC.makeList(Da.symbol(tr.LEGENDRE),e,t,r);let o;if(tr.issymbol(e))o=cE(n,i,e);else{let s=cE(n,i,Da.symbol(tr.SECRETX));o=Pd.Eval(sC.subst(s,Da.symbol(tr.SECRETX),e))}return o=cC(o,i,e)||o,o}function cE(e,t,r){let n=tr.Constants.zero,i=tr.Constants.one;for(let o=0;o<e;o++){let s=Vo.divide(uE.subtract(Vo.multiply(Vo.multiply(Zo.integer(2*o+1),r),i),Vo.multiply(Zo.integer(o),n)),Zo.integer(o+1));n=i,i=s}for(let o=0;o<t;o++)i=rC.derivative(i,r);return i}function cC(e,t,r){if(t===0)return;let n=uE.subtract(tr.Constants.one,ub.square(r));tr.car(r)===Da.symbol(tr.COS)?n=ub.square(oC.sine(tr.cadr(r))):tr.car(r)===Da.symbol(tr.SIN)&&(n=ub.square(tC.cosine(tr.cadr(r))));let i=Vo.multiply(e,iC.power(n,Vo.multiply(Zo.integer(t),Zo.rational(1,2))));return t%2&&(i=Vo.negate(i)),i}});var fE=A(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});Ud.Eval_lookup=void 0;var kd=N(),dC=$();function fC(e){return e=kd.cadr(e),!kd.iscons(e)&&kd.cadr(e).k===kd.SYM&&(e=dC.get_binding(e)),e}Ud.Eval_lookup=fC});var _E=A(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Gd.Eval_mod=void 0;var ro=N(),$d=Ee(),mC=$(),Bd=j(),mE=G(),cb=Q(),_C=ee(),bC=un();function gC(e){let t=mE.Eval(ro.cadr(e)),r=mE.Eval(ro.caddr(e));return yC(t,r)}Gd.Eval_mod=gC;function yC(e,t){if(cb.isZeroAtomOrTensor(t)&&$d.stop("mod function: divide by zero"),!ro.isNumericAtom(e)||!ro.isNumericAtom(t))return _C.makeList(mC.symbol(ro.MOD),e,t);if(ro.isdouble(e)){let r=Bd.nativeInt(e);isNaN(r)&&$d.stop("mod function: cannot convert float value to integer"),e=Bd.integer(r)}if(ro.isdouble(t)){let r=Bd.nativeInt(t);isNaN(r)&&$d.stop("mod function: cannot convert float value to integer"),t=Bd.integer(r)}return(!cb.isinteger(e)||!cb.isinteger(t))&&$d.stop("mod function: integer arguments expected"),new ro.Num(bC.mmod(e.q.a,t.q.a))}});var qE=A(Yd=>{"use strict";Object.defineProperty(Yd,"__esModule",{value:!0});Yd.Eval_nroots=void 0;var vC=St(),Xo=N(),iu=Ee(),qC=$(),EC=Ie(),xC=ce(),bE=j(),pC=go(),Fd=G(),gE=wn(),hC=Vr(),AC=vl(),OC=Q(),MC=X(),TC=$s(),yE=101,jd=1e-6,NC=1e-9;function ou(e){return Math.sqrt(e.r*e.r+e.i*e.i)}function zd(){return 4*Math.random()-2}var $n=class{constructor(){this.r=0,this.i=0}},et=new $n,Bn=new $n,ht=new $n,yr=new $n,Sr=new $n,Gr=new $n,ka=new $n,Gn=new $n,Ze=[];for(let e=0;e<yE;e++)Ze[e]=new $n;function IC(e){let t=Fd.Eval(Xo.caddr(e));e=Fd.Eval(Xo.cadr(e)),t=t===qC.symbol(Xo.NIL)?hC.guess(e):t,OC.ispolyexpandedform(e,t)||iu.stop("nroots: polynomial?");let r=pC.coeff(e,t),n=r.length;n>yE&&iu.stop("nroots: degree?");for(let o=0;o<n;o++)e=Fd.Eval(gE.yyfloat(TC.real(r[o]))),t=Fd.Eval(gE.yyfloat(AC.imag(r[o]))),(!Xo.isdouble(e)||!Xo.isdouble(t))&&iu.stop("nroots: coefficients?"),Ze[o].r=e.d,Ze[o].i=t.d;SC(n);let i=[];for(let o=n;o>1;o--)wC(o),Math.abs(et.r)<jd&&(et.r=0),Math.abs(et.i)<jd&&(et.i=0),i.push(xC.add(bE.double(et.r),MC.multiply(bE.double(et.i),Xo.Constants.imaginaryunit))),RC(o);if(n=i.length,n==1)return i[0];if(n>1)return i.sort(EC.cmp_expr),e=vC.alloc_tensor(n),e.tensor.ndim=1,e.tensor.dim[0]=n,e.tensor.elem=i,e}Yd.Eval_nroots=IC;function SC(e){yr.r=Ze[e-1].r,yr.i=Ze[e-1].i;let t=yr.r*yr.r+yr.i*yr.i;for(let r=0;r<e-1;r++)Ze[r].r=(Ze[r].r*yr.r+Ze[r].i*yr.i)/t,Ze[r].i=(Ze[r].i*yr.r-Ze[r].r*yr.i)/t;Ze[e-1].r=1,Ze[e-1].i=0}function wC(e){if(ou(Ze[0])<jd){et.r=0,et.i=0;return}for(let t=0;t<100;t++){et.r=zd(),et.i=zd(),vE(e),Bn.r=et.r,Bn.i=et.i,Gr.r=Sr.r,Gr.i=Sr.i,et.r=zd(),et.i=zd();for(let r=0;r<1e3;r++){vE(e);let n=ou(Sr);if(Xo.DEBUG&&console.log(`nrabs: ${n}`),n<NC)return;ou(Sr)<ou(Gr)&&(ht.r=et.r,ht.i=et.i,et.r=Bn.r,et.i=Bn.i,Bn.r=ht.r,Bn.i=ht.i,ht.r=Sr.r,ht.i=Sr.i,Sr.r=Gr.r,Sr.i=Gr.i,Gr.r=ht.r,Gr.i=ht.i),ka.r=Bn.r-et.r,ka.i=Bn.i-et.i,Gn.r=Gr.r-Sr.r,Gn.i=Gr.i-Sr.i;let i=Gn.r*Gn.r+Gn.i*Gn.i;if(i===0)break;yr.r=(ka.r*Gn.r+ka.i*Gn.i)/i,yr.i=(ka.i*Gn.r-ka.r*Gn.i)/i,et.r=Bn.r-(yr.r*Gr.r-yr.i*Gr.i),et.i=Bn.i-(yr.r*Gr.i+yr.i*Gr.r)}}iu.stop("nroots: convergence error")}function vE(e){ht.r=et.r,ht.i=et.i,Sr.r=Ze[0].r+Ze[1].r*ht.r-Ze[1].i*ht.i,Sr.i=Ze[0].i+Ze[1].r*ht.i+Ze[1].i*ht.r;for(let t=2;t<e;t++){let r=et.r*ht.r-et.i*ht.i;ht.i=et.r*ht.i+et.i*ht.r,ht.r=r,Sr.r+=Ze[t].r*ht.r-Ze[t].i*ht.i,Sr.i+=Ze[t].r*ht.i+Ze[t].i*ht.r}}function RC(e){for(let t=e-1;t>0;t--)Ze[t-1].r+=Ze[t].r*et.r-Ze[t].i*et.i,Ze[t-1].i+=Ze[t].i*et.r+Ze[t].r*et.i;ou(Ze[0])>jd&&iu.stop("nroots: residual error");for(let t=0;t<e-1;t++)Ze[t].r=Ze[t+1].r,Ze[t].i=Ze[t+1].i}});var hE=A(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.Eval_outer=void 0;var LC=St(),no=N(),CC=Ee(),EE=G(),xE=X(),pE=qt();function PC(e){e=no.cdr(e);let t=EE.Eval(no.car(e));return no.iscons(e)?e.tail().reduce((n,i)=>DC(n,EE.Eval(i)),t):t}Zd.Eval_outer=PC;function DC(e,t){return no.istensor(e)&&no.istensor(t)?kC(e,t):no.istensor(e)?pE.tensor_times_scalar(e,t):no.istensor(t)?pE.scalar_times_tensor(e,t):xE.multiply(e,t)}function kC(e,t){let r=e.tensor.ndim+t.tensor.ndim;r>no.MAXDIM&&CC.stop("outer: rank of result exceeds maximum");let n=e.tensor.nelem*t.tensor.nelem,i=LC.alloc_tensor(n);i.tensor.ndim=r,i.tensor.dim=[...e.tensor.dim,...t.tensor.dim];let o=0;for(let s=0;s<e.tensor.nelem;s++)for(let u=0;u<t.tensor.nelem;u++)i.tensor.elem[o++]=xE.multiply(e.tensor.elem[s],t.tensor.elem[u]);return i}});var fb=A(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.Eval_patternsinfo=tn.Eval_clearpatterns=tn.do_clearPatterns=tn.Eval_pattern=tn.Eval_silentpattern=void 0;var Ge=N(),db=Ee(),Ua=$(),UC=Ie(),$C=ee(),AE=ti();function BC(e){return OE(e),Ua.symbol(Ge.NIL)}tn.Eval_silentpattern=BC;function OE(e){let t;Ge.iscons(Ge.cdr(e))||db.stop("pattern needs at least a template and a transformed version");let r=Ge.car(Ge.cdr(e)),n=Ge.car(Ge.cdr(Ge.cdr(e)));n===Ua.symbol(Ge.NIL)&&db.stop("pattern needs at least a template and a transformed version"),Ge.iscons(Ge.cdr(Ge.cdr(e)))?t=Ge.car(Ge.cdr(Ge.cdr(Ge.cdr(e)))):t=Ua.symbol(Ge.NIL),UC.equal(r,n)&&db.stop("recursive pattern");let i="template: "+AE.print_list(r);i+=" tests: "+AE.print_list(t),Ge.DEBUG&&console.log(`pattern stringkey: ${i}`);let o=Ge.defs.userSimplificationsInStringForm.indexOf(i);return o===-1?(Ge.defs.userSimplificationsInStringForm.push(i),Ge.defs.userSimplificationsInListForm.push(Ge.cdr(e))):(Ge.DEBUG&&console.log(`pattern already exists, replacing. ${Ge.cdr(e)}`),Ge.defs.userSimplificationsInStringForm[o]=i,Ge.defs.userSimplificationsInListForm[o]=Ge.cdr(e)),$C.makeList(Ua.symbol(Ge.PATTERN),Ge.cdr(e))}tn.Eval_pattern=OE;function ME(){Ge.defs.userSimplificationsInListForm=[],Ge.defs.userSimplificationsInStringForm=[]}tn.do_clearPatterns=ME;function GC(){return ME(),Ua.symbol(Ge.NIL)}tn.Eval_clearpatterns=GC;function FC(){let e=jC();return e!==""?new Ge.Str(e):Ua.symbol(Ge.NIL)}tn.Eval_patternsinfo=FC;function jC(){let e="";for(let t of Array.from(Ge.defs.userSimplificationsInListForm))e+=Ge.defs.userSimplificationsInListForm+`
`;return e}});var NE=A(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});Vd.Eval_prime=void 0;var mb=N(),zC=Ee(),TE=j(),YC=G();function ZC(e){return VC(YC.Eval(mb.cadr(e)))}Vd.Eval_prime=ZC;function VC(e){let t=TE.nativeInt(e);return(t<1||t>mb.MAXPRIMETAB)&&zC.stop("prime: Argument out of range."),t=mb.primetab[t-1],TE.integer(t)}});var IE=A(Xd=>{"use strict";Object.defineProperty(Xd,"__esModule",{value:!0});Xd.Eval_product=void 0;var Ho=N(),XC=Ee(),_b=$(),HC=j(),bb=G(),QC=X();function WC(e){let t=Ho.cadr(e),r=Ho.caddr(e);Ho.issymbol(r)||XC.stop("sum: 2nd arg?");let n=bb.evaluate_integer(Ho.cadddr(e));if(isNaN(n))return e;let i=bb.evaluate_integer(Ho.caddddr(e));if(isNaN(i))return e;let o=_b.get_binding(r),s=Ho.Constants.one;for(let u=n;u<=i;u++){_b.set_binding(r,HC.integer(u));let c=bb.Eval(t),f=QC.multiply(s,c);Ho.DEBUG&&(console.log(`product - factor 1: ${c}`),console.log(`product - factor 2: ${s}`),console.log(`product - result: ${f}`)),s=f}return _b.set_binding(r,o),s}Xd.Eval_product=WC});var wE=A(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.Eval_round=void 0;var Hd=N(),JC=$(),SE=j(),KC=G(),e3=wn(),t3=Q(),r3=ee();function n3(e){return i3(KC.Eval(Hd.cadr(e)))}Qd.Eval_round=n3;function i3(e){return Hd.isNumericAtom(e)?Hd.isdouble(e)?SE.double(Math.round(e.d)):t3.isinteger(e)?e:(e=e3.yyfloat(e),SE.integer(Math.round(e.d))):r3.makeList(JC.symbol(Hd.ROUND),e)}});var RE=A(Wd=>{"use strict";Object.defineProperty(Wd,"__esModule",{value:!0});Wd.Eval_shape=void 0;var o3=St(),gb=N(),s3=Ee(),a3=j(),l3=G(),u3=Q();function c3(e){return d3(l3.Eval(gb.cadr(e)))}Wd.Eval_shape=c3;function d3(e){if(!gb.istensor(e))return u3.isZeroAtomOrTensor(e)||s3.stop("transpose: tensor expected, 1st arg is not a tensor"),gb.Constants.zero;let{ndim:t}=e.tensor,r=o3.alloc_tensor(t);r.tensor.ndim=1,r.tensor.dim[0]=t;for(let n=0;n<t;n++)r.tensor.elem[n]=a3.integer(e.tensor.dim[n]);return r}});var LE=A(Jd=>{"use strict";Object.defineProperty(Jd,"__esModule",{value:!0});Jd.Eval_sum=void 0;var $a=N(),f3=Ee(),yb=$(),m3=ce(),_3=j(),vb=G();function b3(e){let t=$a.cadr(e),r=$a.caddr(e);$a.issymbol(r)||f3.stop("sum: 2nd arg?");let n=vb.evaluate_integer($a.cadddr(e));if(isNaN(n))return e;let i=vb.evaluate_integer($a.caddddr(e));if(isNaN(i))return e;let o=yb.get_binding(r),s=$a.Constants.zero;for(let u=n;u<=i;u++)yb.set_binding(r,_3.integer(u)),s=m3.add(s,vb.Eval(t));return yb.set_binding(r,o),s}Jd.Eval_sum=b3});var DE=A(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.Eval_tan=void 0;var yn=N(),qb=$(),Fr=j(),g3=G(),y3=Q(),CE=ee(),Qo=X(),Kd=Et();function v3(e){return PE(g3.Eval(yn.cadr(e)))}ef.Eval_tan=v3;function PE(e){if(yn.car(e)===qb.symbol(yn.ARCTAN))return yn.cadr(e);if(yn.isdouble(e)){let r=Math.tan(e.d);return Math.abs(r)<1e-10&&(r=0),Fr.double(r)}if(y3.isnegative(e))return Qo.negate(PE(Qo.negate(e)));let t=Fr.nativeInt(Qo.divide(Qo.multiply(e,Fr.integer(180)),yn.Constants.Pi()));if(t<0||isNaN(t))return CE.makeList(qb.symbol(yn.TAN),e);switch(t%360){case 0:case 180:return yn.Constants.zero;case 30:case 210:return Qo.multiply(Fr.rational(1,3),Kd.power(Fr.integer(3),Fr.rational(1,2)));case 150:case 330:return Qo.multiply(Fr.rational(-1,3),Kd.power(Fr.integer(3),Fr.rational(1,2)));case 45:case 225:return yn.Constants.one;case 135:case 315:return yn.Constants.negOne;case 60:case 240:return Kd.power(Fr.integer(3),Fr.rational(1,2));case 120:case 300:return Qo.negate(Kd.power(Fr.integer(3),Fr.rational(1,2)));default:return CE.makeList(qb.symbol(yn.TAN),e)}}});var UE=A(tf=>{"use strict";Object.defineProperty(tf,"__esModule",{value:!0});tf.Eval_tanh=void 0;var Wo=N(),kE=$(),q3=j(),E3=G(),x3=Q(),p3=ee();function h3(e){return A3(E3.Eval(Wo.cadr(e)))}tf.Eval_tanh=h3;function A3(e){if(Wo.car(e)===kE.symbol(Wo.ARCTANH))return Wo.cadr(e);if(Wo.isdouble(e)){let t=Math.tanh(e.d);return Math.abs(t)<1e-10&&(t=0),q3.double(t)}return x3.isZeroAtomOrTensor(e)?Wo.Constants.zero:p3.makeList(kE.symbol(Wo.TANH),e)}});var GE=A(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.Eval_taylor=void 0;var wr=N(),rf=$(),$E=ce(),Eb=j(),O3=wo(),Ba=G(),M3=po(),T3=Vr(),N3=Q(),I3=ee(),xb=X(),BE=Zr();function S3(e){e=wr.cdr(e);let t=Ba.Eval(wr.car(e));e=wr.cdr(e);let r=Ba.Eval(wr.car(e)),n=r===rf.symbol(wr.NIL)?T3.guess(t):r;e=wr.cdr(e),r=Ba.Eval(wr.car(e));let i=r===rf.symbol(wr.NIL)?Eb.integer(24):r;e=wr.cdr(e),r=Ba.Eval(wr.car(e));let o=r===rf.symbol(wr.NIL)?wr.Constants.zero:r;return w3(t,n,i,o)}nf.Eval_taylor=S3;function w3(e,t,r,n){let i=Eb.nativeInt(r);if(isNaN(i))return I3.makeList(rf.symbol(wr.TAYLOR),e,t,r,n);let o=wr.Constants.one,s=Ba.Eval(BE.subst(e,t,n));for(let u=1;u<=i&&(e=O3.derivative(e,t),!N3.isZeroAtomOrTensor(e));u++){o=xb.multiply(o,$E.subtract(t,n));let c=Ba.Eval(BE.subst(e,t,n));s=$E.add(s,xb.divide(xb.multiply(c,o),M3.factorial(Eb.integer(u))))}return s}});var FE=A(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.Eval_or=Bt.Eval_and=Bt.Eval_not=Bt.Eval_testlt=Bt.Eval_testle=Bt.Eval_testgt=Bt.Eval_testge=Bt.Eval_testeq=Bt.Eval_test=void 0;var ge=N(),R3=$(),pb=ce(),pi=G(),L3=wn(),Jo=Q(),of=Zi();function C3(e){let t=e;for(e=ge.cdr(e);ge.iscons(e);){if(ge.cdr(e)===R3.symbol(ge.NIL))return pi.Eval(ge.car(e));let r=Jo.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(e));if(r==null)return t;if(r)return pi.Eval(ge.cadr(e));e=ge.cddr(e)}return ge.Constants.zero}Bt.Eval_test=C3;function P3(e){let t=e,r=pb.subtract(pi.Eval(ge.cadr(e)),pi.Eval(ge.caddr(e))),n=Jo.isZeroLikeOrNonZeroLikeOrUndetermined(r);if(n)return ge.Constants.zero;if(n!=null&&!n)return ge.Constants.one;let i=of.simplify(pi.Eval(ge.cadr(e))),o=of.simplify(pi.Eval(ge.caddr(e)));return r=pb.subtract(i,o),n=Jo.isZeroLikeOrNonZeroLikeOrUndetermined(r),n?ge.Constants.zero:n!=null&&!n?ge.Constants.one:t}Bt.Eval_testeq=P3;function D3(e){let t=e,r=sf(e);return r==null?t:r>=0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testge=D3;function k3(e){let t=e,r=sf(e);return r==null?t:r>0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testgt=k3;function U3(e){let t=e,r=sf(e);return r==null?t:r<=0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testle=U3;function $3(e){let t=e,r=sf(e);return r==null?t:r<0?ge.Constants.one:ge.Constants.zero}Bt.Eval_testlt=$3;function B3(e){let t=e,r=Jo.isZeroLikeOrNonZeroLikeOrUndetermined(ge.cadr(e));return r==null?t:r?ge.Constants.zero:ge.Constants.one}Bt.Eval_not=B3;function G3(e){let t=e,r=ge.cdr(t),n=!1;for(;ge.iscons(r);){let i=Jo.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(r));if(i==null)n=!0,r=ge.cdr(r);else if(i)r=ge.cdr(r);else if(!i)return ge.Constants.zero}return n?t:ge.Constants.one}Bt.Eval_and=G3;function F3(e){let t=e,r=ge.cdr(t),n=!1;for(;ge.iscons(r);){let i=Jo.isZeroLikeOrNonZeroLikeOrUndetermined(ge.car(r));if(i==null)n=!0,r=ge.cdr(r);else{if(i)return ge.Constants.one;i||(r=ge.cdr(r))}}return n?t:ge.Constants.zero}Bt.Eval_or=F3;function sf(e){let t=0,r=of.simplify(pi.Eval(ge.cadr(e))),n=of.simplify(pi.Eval(ge.caddr(e)));if(e=pb.subtract(r,n),e.k!==ge.NUM&&e.k!==ge.DOUBLE&&(e=pi.Eval(L3.yyfloat(e))),Jo.isZeroAtomOrTensor(e))return 0;switch(e.k){case ge.NUM:ge.MSIGN(e.q.a)===-1?t=-1:t=1;break;case ge.DOUBLE:e.d<0?t=-1:t=1;break;default:t=null}return t}});var jE=A(lf=>{"use strict";Object.defineProperty(lf,"__esModule",{value:!0});lf.Eval_zero=void 0;var j3=St(),af=N(),z3=G();function Y3(e){let t=Array(af.MAXDIM).fill(0),r=1,n=0;if(af.iscons(e))for(let i of e.tail()){let o=z3.evaluate_integer(i);if(o<1||isNaN(o))return af.Constants.zero;r*=o,t[n++]=o}if(n===0)return af.Constants.zero;e=j3.alloc_tensor(r),e.tensor.ndim=n;for(let i=0;i<n;i++)e.tensor.dim[i]=t[i];return e}lf.Eval_zero=Y3});var su=A(Ga=>{"use strict";Object.defineProperty(Ga,"__esModule",{value:!0});Ga.defn=Ga.init=void 0;var Z3=sn(),V3=ce(),X3=Om(),H3=U_(),Q3=W1(),W3=K1(),J3=tq(),K3=nq(),eP=dm(),tP=oq(),rP=fs(),nP=Sm(),iP=wm(),zE=j(),oP=lq(),sP=cq(),aP=mq(),lP=xq(),YE=Ob(),uP=Pu(),cP=go(),dP=Am(),fP=bl(),mP=yo(),_P=hq(),bP=Ri(),gP=Rm(),yP=e_(),vP=Df(),qP=Oq(),EP=yd(),xP=Mn(),pP=wo(),hP=Dm(),hb=Lq(),AP=$q(),OP=K_(),bt=G(),MP=Qq(),TP=z_(),NP=Y_(),IP=dl(),SP=al(),wP=wn(),RP=Jq(),LP=Kq(),CP=nE(),PP=_o(),DP=vl(),ZE=Bi(),kP=Gl(),UP=iE(),$P=sE(),BP=Uf(),GP=lE(),FP=dE(),jP=ee(),zP=b_(),YP=fE(),ZP=_E(),VP=X(),XP=qE(),HP=oi(),QP=hE(),uf=fb(),WP=Du(),JP=Et(),KP=NE(),io=ti(),eD=IE(),tD=Gu(),rD=gl(),nD=$s(),iD=ei(),oD=Jm(),sD=wE(),aD=zi(),lD=y_(),uD=RE(),cD=Zi(),dD=Wn(),fD=v_(),mD=LE(),_D=DE(),bD=UE(),gD=GE(),hi=FE(),yD=s_(),vD=jE(),g=N(),y=$(),Ab=0;function qD(){Ab=0,g.reset_after_error(),g.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!Ab&&(Ab=1,y.reset_symbols(),XE())}Ga.init=qD;var VE=['version="'+g.version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"];function XE(){y.std_symbol(g.ABS,Z3.Eval_abs),y.std_symbol(g.ADD,V3.Eval_add),y.std_symbol(g.ADJ,X3.Eval_adj),y.std_symbol(g.AND,hi.Eval_and),y.std_symbol(g.APPROXRATIO,H3.Eval_approxratio),y.std_symbol(g.ARCCOS,Q3.Eval_arccos),y.std_symbol(g.ARCCOSH,W3.Eval_arccosh),y.std_symbol(g.ARCSIN,J3.Eval_arcsin),y.std_symbol(g.ARCSINH,K3.Eval_arcsinh),y.std_symbol(g.ARCTAN,eP.Eval_arctan),y.std_symbol(g.ARCTANH,tP.Eval_arctanh),y.std_symbol(g.ARG,rP.Eval_arg),y.std_symbol(g.ATOMIZE),y.std_symbol(g.BESSELJ,nP.Eval_besselj),y.std_symbol(g.BESSELY,iP.Eval_bessely),y.std_symbol(g.BINDING,bt.Eval_binding),y.std_symbol(g.BINOMIAL,oP.Eval_binomial),y.std_symbol(g.CEILING,sP.Eval_ceiling),y.std_symbol(g.CHECK,bt.Eval_check),y.std_symbol(g.CHOOSE,aP.Eval_choose),y.std_symbol(g.CIRCEXP,lP.Eval_circexp),y.std_symbol(g.CLEAR,YE.Eval_clear),y.std_symbol(g.CLEARALL,YE.Eval_clearall),y.std_symbol(g.CLEARPATTERNS,uf.Eval_clearpatterns),y.std_symbol(g.CLOCK,uP.Eval_clock),y.std_symbol(g.COEFF,cP.Eval_coeff),y.std_symbol(g.COFACTOR,dP.Eval_cofactor),y.std_symbol(g.CONDENSE,fP.Eval_condense),y.std_symbol(g.CONJ,mP.Eval_conj),y.std_symbol(g.CONTRACT,_P.Eval_contract),y.std_symbol(g.COS,bP.Eval_cos),y.std_symbol(g.COSH,gP.Eval_cosh),y.std_symbol(g.DECOMP,yP.Eval_decomp),y.std_symbol(g.DEFINT,qP.Eval_defint),y.std_symbol(g.DEGREE,EP.Eval_degree),y.std_symbol(g.DENOMINATOR,xP.Eval_denominator),y.std_symbol(g.DET,bt.Eval_det),y.std_symbol(g.DERIVATIVE,pP.Eval_derivative),y.std_symbol(g.DIM,bt.Eval_dim),y.std_symbol(g.DIRAC,hP.Eval_dirac),y.std_symbol(g.DIVISORS,bt.Eval_divisors),y.std_symbol(g.DO,bt.Eval_do),y.std_symbol(g.DOT,ZE.Eval_inner),y.std_symbol(g.DRAW),y.std_symbol(g.DSOLVE),y.std_symbol(g.ERF,AP.Eval_erf),y.std_symbol(g.ERFC,OP.Eval_erfc),y.std_symbol(g.EIGEN,hb.Eval_eigen),y.std_symbol(g.EIGENVAL,hb.Eval_eigenval),y.std_symbol(g.EIGENVEC,hb.Eval_eigenvec),y.std_symbol(g.EVAL,bt.Eval_Eval),y.std_symbol(g.EXP,bt.Eval_exp),y.std_symbol(g.EXPAND,MP.Eval_expand),y.std_symbol(g.EXPCOS,TP.Eval_expcos),y.std_symbol(g.EXPSIN,NP.Eval_expsin),y.std_symbol(g.FACTOR,IP.Eval_factor),y.std_symbol(g.FACTORIAL,bt.Eval_factorial),y.std_symbol(g.FACTORPOLY,bt.Eval_factorpoly),y.std_symbol(g.FILTER,SP.Eval_filter),y.std_symbol(g.FLOATF,wP.Eval_float),y.std_symbol(g.FLOOR,RP.Eval_floor),y.std_symbol(g.FOR,LP.Eval_for),y.std_symbol(g.FUNCTION,vP.Eval_function_reference),y.std_symbol(g.GAMMA,CP.Eval_gamma),y.std_symbol(g.GCD,PP.Eval_gcd),y.std_symbol(g.HERMITE,bt.Eval_hermite),y.std_symbol(g.HILBERT,bt.Eval_hilbert),y.std_symbol(g.IMAG,DP.Eval_imag),y.std_symbol(g.INDEX,bt.Eval_index),y.std_symbol(g.INNER,ZE.Eval_inner),y.std_symbol(g.INTEGRAL,kP.Eval_integral),y.std_symbol(g.INV,bt.Eval_inv),y.std_symbol(g.INVG,bt.Eval_invg),y.std_symbol(g.ISINTEGER,bt.Eval_isinteger),y.std_symbol(g.ISPRIME,UP.Eval_isprime),y.std_symbol(g.LAGUERRE,$P.Eval_laguerre),y.std_symbol(g.LCM,BP.Eval_lcm),y.std_symbol(g.LEADING,GP.Eval_leading),y.std_symbol(g.LEGENDRE,FP.Eval_legendre),y.std_symbol(g.LOG,zP.Eval_log),y.std_symbol(g.LOOKUP,YP.Eval_lookup),y.std_symbol(g.MOD,ZP.Eval_mod),y.std_symbol(g.MULTIPLY,VP.Eval_multiply),y.std_symbol(g.NOT,hi.Eval_not),y.std_symbol(g.NROOTS,XP.Eval_nroots),y.std_symbol(g.NUMBER,bt.Eval_number),y.std_symbol(g.NUMERATOR,HP.Eval_numerator),y.std_symbol(g.OPERATOR,bt.Eval_operator),y.std_symbol(g.OR,hi.Eval_or),y.std_symbol(g.OUTER,QP.Eval_outer),y.std_symbol(g.PATTERN,uf.Eval_pattern),y.std_symbol(g.PATTERNSINFO,uf.Eval_patternsinfo),y.std_symbol(g.POLAR,WP.Eval_polar),y.std_symbol(g.POWER,JP.Eval_power),y.std_symbol(g.PRIME,KP.Eval_prime),y.std_symbol(g.PRINT,io.Eval_print),y.std_symbol(g.PRINT2DASCII,io.Eval_print2dascii),y.std_symbol(g.PRINTFULL,io.Eval_printcomputer),y.std_symbol(g.PRINTLATEX,io.Eval_printlatex),y.std_symbol(g.PRINTLIST,io.Eval_printlist),y.std_symbol(g.PRINTPLAIN,io.Eval_printhuman),y.std_symbol(g.PRINT_LEAVE_E_ALONE),y.std_symbol(g.PRINT_LEAVE_X_ALONE),y.std_symbol(g.PRODUCT,eD.Eval_product),y.std_symbol(g.QUOTE,bt.Eval_quote),y.std_symbol(g.QUOTIENT,tD.Eval_quotient),y.std_symbol(g.RANK,bt.Eval_rank),y.std_symbol(g.RATIONALIZE,rD.Eval_rationalize),y.std_symbol(g.REAL,nD.Eval_real),y.std_symbol(g.YYRECT,iD.Eval_rect),y.std_symbol(g.ROOTS,oD.Eval_roots),y.std_symbol(g.ROUND,sD.Eval_round),y.std_symbol(g.SETQ,bt.Eval_setq),y.std_symbol(g.SGN,lD.Eval_sgn),y.std_symbol(g.SILENTPATTERN,uf.Eval_silentpattern),y.std_symbol(g.SIMPLIFY,cD.Eval_simplify),y.std_symbol(g.SIN,dD.Eval_sin),y.std_symbol(g.SINH,fD.Eval_sinh),y.std_symbol(g.SHAPE,uD.Eval_shape),y.std_symbol(g.SQRT,bt.Eval_sqrt),y.std_symbol(g.STOP,bt.Eval_stop),y.std_symbol(g.SUBST,bt.Eval_subst),y.std_symbol(g.SUM,mD.Eval_sum),y.std_symbol(g.SYMBOLSINFO,y.Eval_symbolsinfo),y.std_symbol(g.TAN,_D.Eval_tan),y.std_symbol(g.TANH,bD.Eval_tanh),y.std_symbol(g.TAYLOR,gD.Eval_taylor),y.std_symbol(g.TEST,hi.Eval_test),y.std_symbol(g.TESTEQ,hi.Eval_testeq),y.std_symbol(g.TESTGE,hi.Eval_testge),y.std_symbol(g.TESTGT,hi.Eval_testgt),y.std_symbol(g.TESTLE,hi.Eval_testle),y.std_symbol(g.TESTLT,hi.Eval_testlt),y.std_symbol(g.TRANSPOSE,yD.Eval_transpose),y.std_symbol(g.UNIT,bt.Eval_unit),y.std_symbol(g.ZERO,vD.Eval_zero),y.std_symbol(g.NIL),y.std_symbol(g.AUTOEXPAND),y.std_symbol(g.BAKE),y.std_symbol(g.ASSUME_REAL_VARIABLES),y.std_symbol(g.LAST),y.std_symbol(g.LAST_PRINT),y.std_symbol(g.LAST_2DASCII_PRINT),y.std_symbol(g.LAST_FULL_PRINT),y.std_symbol(g.LAST_LATEX_PRINT),y.std_symbol(g.LAST_LIST_PRINT),y.std_symbol(g.LAST_PLAIN_PRINT),y.std_symbol(g.TRACE),y.std_symbol(g.FORCE_FIXED_PRINTOUT),y.std_symbol(g.MAX_FIXED_PRINTOUT_DIGITS),y.std_symbol(g.YYE),y.std_symbol(g.DRAWX),y.std_symbol(g.METAA),y.std_symbol(g.METAB),y.std_symbol(g.METAX),y.std_symbol(g.SECRETX),y.std_symbol(g.VERSION),y.std_symbol(g.PI),y.std_symbol(g.SYMBOL_A),y.std_symbol(g.SYMBOL_B),y.std_symbol(g.SYMBOL_C),y.std_symbol(g.SYMBOL_D),y.std_symbol(g.SYMBOL_I),y.std_symbol(g.SYMBOL_J),y.std_symbol(g.SYMBOL_N),y.std_symbol(g.SYMBOL_R),y.std_symbol(g.SYMBOL_S),y.std_symbol(g.SYMBOL_T),y.std_symbol(g.SYMBOL_X),y.std_symbol(g.SYMBOL_Y),y.std_symbol(g.SYMBOL_Z),y.std_symbol(g.SYMBOL_IDENTITY_MATRIX),y.std_symbol(g.SYMBOL_A_UNDERSCORE),y.std_symbol(g.SYMBOL_B_UNDERSCORE),y.std_symbol(g.SYMBOL_X_UNDERSCORE),y.std_symbol(g.C1),y.std_symbol(g.C2),y.std_symbol(g.C3),y.std_symbol(g.C4),y.std_symbol(g.C5),y.std_symbol(g.C6),ED();let e=g.defs.codeGen;g.defs.codeGen=!1;for(let t=0;t<VE.length;t++){let r=VE[t],[,n]=aD.scan(r);g.DEBUG&&(console.log(`... evaling ${r}`),console.log("top of stack:"),console.log(io.print_list(n))),bt.Eval(n)}g.defs.codeGen=e}Ga.defn=XE;function ED(){let e=jP.makeList(y.symbol(g.POWER),zE.integer(-1),zE.rational(1,2));g.DEBUG&&console.log(io.print_list(e)),g.Constants.imaginaryunit=e}});var Ob=A(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.Eval_clear=oo.do_clearall=oo.Eval_clearall=void 0;var Ai=N(),xD=su(),pD=ui(),hD=Ee(),cf=$(),AD=fb();function OD(){return HE(),cf.symbol(Ai.NIL)}oo.Eval_clearall=OD;function HE(){return Ai.defs.test_flag||pD.clear_term(),AD.do_clearPatterns(),cf.clear_symbols(),xD.defn(),Ai.defs.codeGen=!1}oo.do_clearall=HE;function MD(e){let t;for(t=Ai.cdr(e);Ai.iscons(t);){let r=Ai.car(t);r.k!==Ai.SYM&&hD.stop("symbol error"),cf.clear_symbol(r),t=Ai.cdr(t)}return cf.symbol(Ai.NIL)}oo.Eval_clear=MD});var Sb=A(ff=>{"use strict";Object.defineProperty(ff,"__esModule",{value:!0});ff.print2dascii=void 0;var v=N(),TD=ui(),vn=$(),au=sn(),Fa=j(),rr=Q(),ND=ti(),QE=1e4,WE=class{constructor(){this.c=0,this.x=0,this.y=0}},gt=[];for(let e=0;e<QE;e++)gt[e]=new WE;var ct=0,Fn=0,jn=0,JE=0;function Mb(e){let t="";return t+=e,t}function ID(e){return Mb(e)}function SD(e){ct=0,Fn=0,jn=0,wD(e);let[t,r,n]=Array.from(Ya(0,ct));if(r>100){ND.printline(e);return}return zD()}ff.print2dascii=SD;function wD(e){if(v.car(e)===vn.symbol(v.SETQ)){vr(v.cadr(e)),Ib(" = "),vr(v.caddr(e));return}v.istensor(e)?ZD(e):vr(e)}function KE(e){if(Fn>0)return!1;if(rr.isfraction(e))return!0;if(!v.ismultiply(e))return!1;if(rr.isfraction(v.cadr(e)))return!0;for(;v.iscons(e);){if(Ko(v.car(e)))return!0;e=v.cdr(e)}return!1}function vr(e){if(JE++,v.isadd(e))for(e=v.cdr(e),ja(v.car(e))&&(_e("-"),KE(v.car(e))&&_e(" ")),za(v.car(e)),e=v.cdr(e);v.iscons(e);)ja(v.car(e))?(_e(" "),_e("-"),_e(" ")):(_e(" "),_e("+"),_e(" ")),za(v.car(e)),e=v.cdr(e);else ja(e)&&(_e("-"),KE(e)&&_e(" ")),za(e);JE--}function RD(e){if(v.isadd(e))for(e=v.cdr(e),za(v.car(e)),e=v.cdr(e);v.iscons(e);)ja(v.car(e))?(_e(" "),_e("-"),_e(" ")):(_e(" "),_e("+"),_e(" ")),za(v.car(e)),e=v.cdr(e);else za(e)}function ja(e){return!!(rr.isnegativenumber(e)||v.ismultiply(e)&&rr.isnegativenumber(v.cadr(e)))}function za(e){if(v.ismultiply(e)){let t=LD(e);t&&Fn===0?PD(e,t):CD(e,t)}else qn(e)}function Ko(e){return v.ispower(e)&&v.cadr(e)!==vn.symbol(v.E)&&ja(v.caddr(e))}function LD(e){let t=0;for(e=v.cdr(e);v.iscons(e);){let r=v.car(e);Ko(r)&&t++,e=v.cdr(e)}return t}function CD(e,t){if(t===0)for(e=v.cdr(e),(rr.isplusone(v.car(e))||rr.isminusone(v.car(e)))&&(e=v.cdr(e)),qn(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(" "),qn(v.car(e)),e=v.cdr(e);else DD(e),_e("/"),t>1||rr.isfraction(v.cadr(e))?(_e("("),ex(e),_e(")")):ex(e)}function PD(e,t){let r,n,i=0,o=0,s=0,u=0,c=0,f=v.Constants.one,_=v.Constants.one;for(v.isrational(v.cadr(e))&&(f=au.absval(Fa.mp_numerator(v.cadr(e))),_=Fa.mp_denominator(v.cadr(e))),v.isdouble(v.cadr(e))&&(f=au.absval(v.cadr(e))),u=rr.isplusone(f)?0:1,r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),Ko(n)||u++,r=v.cdr(r);for(c=jn,o=ct,i=0,rr.isplusone(f)||(Oi(f,0),i++),r=v.cdr(e),v.isNumericAtom(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),Ko(n)||(i>0&&_e(" "),u===1?vr(n):qn(n),i++),r=v.cdr(r);for(i===0&&_e("1"),s=ct,i=0,rr.isplusone(_)||(Oi(_,0),i++,t++),r=v.cdr(e),v.isrational(v.car(r))&&(r=v.cdr(r));v.iscons(r);)n=v.car(r),Ko(n)&&(i>0&&_e(" "),Tb(n,t),i++),r=v.cdr(r);Nb(c,o,s)}function DD(e){let t=v.Constants.one;e=v.cdr(e),v.isrational(v.car(e))?(t=au.absval(Fa.mp_numerator(v.car(e))),e=v.cdr(e)):v.isdouble(v.car(e))&&(t=au.absval(v.car(e)),e=v.cdr(e));let r=0;for(rr.isplusone(t)||(Oi(t,0),r++);v.iscons(e);)Ko(v.car(e))||(r>0&&_e(" "),qn(v.car(e)),r++),e=v.cdr(e);r===0&&_e("1")}function ex(e){let t=0;if(e=v.cdr(e),rr.isfraction(v.car(e))){let r=Fa.mp_denominator(v.car(e));Oi(r,0),t++,e=v.cdr(e)}for(;v.iscons(e);)Ko(v.car(e))&&(t>0&&_e(" "),Tb(v.car(e),0),t++),e=v.cdr(e)}function qn(e){if(v.istensor(e)){df(e);return}if(v.isdouble(e)){Oi(e,0);return}if(v.isadd(e)||v.ismultiply(e)){so(e);return}if(v.ispower(e)){UD(e);return}if(v.iscons(e)){$D(e);return}if(v.isNumericAtom(e)){Fn===0?kD(e):Oi(e,0);return}if(v.issymbol(e)){tx(e);return}v.isstr(e)&&FD(e)}function kD(e){let t=au.absval(Fa.mp_numerator(e)),r=Fa.mp_denominator(e);if(rr.isplusone(r)){Oi(t,0);return}let n=jn,i=ct;Oi(t,0);let o=ct;Oi(r,0),Nb(n,i,o)}function lu(e){return v.iscons(e)&&!v.isadd(e)&&!v.ismultiply(e)&&!v.ispower(e)||v.issymbol(e)?!0:rr.isfraction(e)||rr.isnegativenumber(e)?!1:!!v.isNumericAtom(e)}function UD(e){let t=0,r=0,n=0;if(v.cadr(e)===vn.symbol(v.E)){Ib("exp("),vr(v.caddr(e)),_e(")");return}if(Fn>0){rr.isminusone(v.caddr(e))?(_e("1"),_e("/"),lu(v.cadr(e))?qn(v.cadr(e)):so(v.cadr(e))):(lu(v.cadr(e))?qn(v.cadr(e)):so(v.cadr(e)),_e("^"),lu(v.caddr(e))?qn(v.caddr(e)):so(v.caddr(e)));return}if(ja(v.caddr(e))){n=jn,t=ct,_e("1"),r=ct,Tb(e,1),Nb(n,t,r);return}t=ct,lu(v.cadr(e))?qn(v.cadr(e)):so(v.cadr(e)),r=ct,Fn++,vr(v.caddr(e)),Fn--,rx(t,r)}function Tb(e,t){let r=0,n=0;if(rr.isminusone(v.caddr(e))){t===1?vr(v.cadr(e)):qn(v.cadr(e));return}r=ct,lu(v.cadr(e))?qn(v.cadr(e)):so(v.cadr(e)),n=ct,Fn++,RD(v.caddr(e)),Fn--,rx(r,n)}function $D(e){if(v.car(e)===vn.symbol(v.INDEX)&&v.issymbol(v.cadr(e))){BD(e);return}if(v.isfactorial(e)){GD(e);return}if(v.car(e)===vn.symbol(v.DERIVATIVE)?_e("d"):tx(v.car(e)),_e("("),e=v.cdr(e),v.iscons(e))for(vr(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(","),vr(v.car(e)),e=v.cdr(e);_e(")")}function BD(e){if(e=v.cdr(e),v.caar(e)===vn.symbol(v.ADD)||v.caar(e)===vn.symbol(v.MULTIPLY)||v.caar(e)===vn.symbol(v.POWER)||v.caar(e)===vn.symbol(v.FACTORIAL)?so(v.car(e)):vr(v.car(e)),_e("["),e=v.cdr(e),v.iscons(e))for(vr(v.car(e)),e=v.cdr(e);v.iscons(e);)_e(","),vr(v.car(e)),e=v.cdr(e);_e("]")}function GD(e){e=v.cadr(e),rr.isfraction(e)||v.isadd(e)||v.ismultiply(e)||v.ispower(e)||v.isfactorial(e)?so(e):vr(e),_e("!")}function so(e){_e("("),vr(e),_e(")")}function tx(e){if(e===vn.symbol(v.E)){Ib("exp(1)");return}let t=vn.get_printname(e);for(let r=0;r<t.length;r++)_e(t[r])}function FD(e){let t=e.str;_e('"');for(let r=0;r<t.length;r++)_e(t[r]);_e('"')}function Nb(e,t,r){let n=0,i=0,[o,s,u]=Array.from(Ya(t,r)),[c,f,_]=Array.from(Ya(r,ct));f>s?n=(f-s)/2:n=0,n++,i=-(u+o-1)-1,uu(t,r,n,i),f>s?n=-s:n=-s+(s-f)/2,n++,i=-_+1,uu(r,ct,n,i);let T=0;f>s?T=f:T=s,T+=2,jn=e;for(let k=0;k<T;k++)_e("-")}function rx(e,t){let r=0,n=0,i=0,o=0,s=0,u=0,c=0;[n,i,o]=Array.from(Ya(e,t)),[s,u,c]=Array.from(Ya(t,ct)),r=-c-s+1,r+=o-1,uu(t,ct,0,r)}function uu(e,t,r,n){for(let i=e;i<t;i++)gt[i].x+=r,gt[i].y+=n}function Ya(e,t){let r=gt[e].x,n=gt[e].x,i=gt[e].y,o=gt[e].y;for(let f=e+1;f<t;f++)gt[f].x<r&&(r=gt[f].x),gt[f].x>n&&(n=gt[f].x),gt[f].y<i&&(i=gt[f].y),gt[f].y>o&&(o=gt[f].y);let s=o-i+1,u=n-r+1;return[s,u,i]}function _e(e){if(ct!==QE)return gt[ct]==null&&v.breakpoint,gt[ct].c=e,gt[ct].x=jn,gt[ct].y=0,ct++,jn++}function Ib(e){for(let t=0;t<e.length;t++)_e(e[t])}function Oi(e,t){let r="";switch(e.k){case v.NUM:r=e.q.a.toString(),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)_e(r[n]);if(r=e.q.b.toString(),r==="1")break;_e("/");for(let n=0;n<r.length;n++)_e(r[n]);break;case v.DOUBLE:r=TD.doubleToReasonableString(e.d),r[0]==="-"&&t===0&&(r=r.substring(1));for(let n=0;n<r.length;n++)_e(r[n]);break}}function jD(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}function zD(){let e="",t=gt.slice(0,ct);t.sort(jD),gt=[].concat(t).concat(gt.slice(ct));let r=0,{y:n}=gt[0];for(let i=0;i<ct;i++){for(;gt[i].y>n;)e+=ID(`
`),r=0,n++;for(;gt[i].x>r;)e+=Mb(" "),r++;e+=Mb(gt[i].c),r++}return e}var YD=100,nx=class{constructor(){this.x=0,this.y=0,this.h=0,this.w=0,this.index=0,this.count=0}},Nt=[];for(let e=0;e<1e4;e++)Nt[e]=new nx;var ix=3,ox=1;function ZD(e){let t=0,r=0,n=0;if(e.tensor.ndim>2){df(e);return}let i=e.tensor.dim[0];e.tensor.ndim===2?t=e.tensor.dim[1]:t=1;let o=i*t;if(o>YD){df(e);return}let s=jn;for(let T=0;T<o;T++)Nt[T].index=ct,Nt[T].x=jn,vr(e.tensor.elem[T]),Nt[T].count=ct-Nt[T].index,[Nt[T].h,Nt[T].w,Nt[T].y]=Array.from(Ya(Nt[T].index,ct));let u=0,c=0;for(let T=0;T<o;T++)Nt[T].h>u&&(u=Nt[T].h),Nt[T].w>c&&(c=Nt[T].w);let f=i*u+(i-1)*ox,_=t*c+(t-1)*ix,w=-(f/2);for(let T=0;T<i;T++)for(let k=0;k<t;k++){let V=T*t+k;r=s-Nt[V].x,n=w-Nt[V].y,uu(Nt[V].index,Nt[V].index+Nt[V].count,r,n),r=0,k>0&&(r=k*(c+ix)),n=0,T>0&&(n=T*(u+ox)),r+=(c-Nt[V].w)/2,n+=(u-Nt[V].h)/2,uu(Nt[V].index,Nt[V].index+Nt[V].count,r,n)}jn=s+_}function df(e){sx(e,0,0)}function sx(e,t,r){_e("(");for(let n=0;n<e.tensor.dim[t];n++)t+1===e.tensor.ndim?(vr(e.tensor.elem[r]),r=r+1):r=sx(e,t+1,r),n+1<e.tensor.dim[t]&&_e(",");return _e(")"),r}});var Ee=A(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.computeResultsAndJavaScriptFromAlgebra=nr.computeDependenciesFromAlgebra=nr.check_esc_flag=nr.top_level_eval=nr.check_stack=nr.run=nr.findDependenciesInScript=nr.stop=void 0;var VD=n_(),ax=Ob(),XD=G(),cu=Q(),lx=ti(),HD=Sb(),ux=zi(),QD=Zi(),mf=Zr(),p=N(),_f=su(),yt=$();function du(e){p.defs.errorMessage+="Stop: ",p.defs.errorMessage+=e;let t=p.defs.errorMessage;throw p.defs.errorMessage="",new Error(t)}nr.stop=du;function wb(e,t=!1){p.DEBUG&&console.log(`stringToBeParsed: ${e}`);let r=new Date().getTime(),n=!0;p.defs.codeGen=!0,p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.symbolsInExpressionsWithoutAssignments=[],p.defs.patternHasBeenFound=!1;let i=0,o="",s="",u=0,c={affectsVariables:[],affectedBy:[]},f=e;for(;;){try{p.defs.errorMessage="",Za(),p.DEBUG&&console.log("findDependenciesInScript: scanning"),[u]=ux.scan(e.substring(i)),p.DEBUG&&console.log("scanned"),Za()}catch(Y){p.PRINTOUTRESULT&&console.log(Y),p.defs.errorMessage=Y+"",p.reset_after_error();break}if(u===0)break;i+=u}let _="";p.DEBUG&&console.log("all local dependencies ----------------"),_+="All local dependencies: ";for(let Y in p.defs.symbolsDependencies){let Ae=p.defs.symbolsDependencies[Y];p.DEBUG&&console.log(`variable ${Y} depends on: `),c.affectsVariables.push(Y),_+=" variable "+Y+" depends on: ";for(let tt of Array.from(Ae))p.DEBUG&&console.log(`    ${tt}`),tt[0]!=="'"&&c.affectedBy.push(tt),_+=tt+", ";_+="; "}_+=". ",p.DEBUG&&console.log("Symbols with reassignments ----------------"),_+="Symbols with reassignments: ";for(let Y of Array.from(p.defs.symbolsHavingReassignments))c.affectedBy.indexOf(Y)===-1&&(c.affectedBy.push(Y),_+=Y+", ");_+=". ",p.DEBUG&&console.log("Symbols in expressions without assignments ----------------"),_+="Symbols in expressions without assignments: ";for(let Y of Array.from(p.defs.symbolsInExpressionsWithoutAssignments))c.affectedBy.indexOf(Y)===-1&&(c.affectedBy.push(Y),_+=Y+", ");_+=". ",c.affectedBy.push("PATTERN_DEPENDENCY"),p.defs.patternHasBeenFound&&(c.affectsVariables.push("PATTERN_DEPENDENCY"),_+=" - PATTERN_DEPENDENCY inserted - "),p.DEBUG&&console.log("All dependencies recursively ----------------"),_+="All dependencies recursively: ";let w=["",""],T="",k="";if(p.defs.errorMessage===""&&!t){try{o="",s="",w=dx(e,!0),o="",s=""}catch(Y){let Ae=Y;p.PRINTOUTRESULT&&console.log(Ae),p.defs.errorMessage=Ae.toString(),_f.init()}if(p.defs.errorMessage==="")for(let Y in p.defs.symbolsDependencies){p.defs.codeGen=!0,p.DEBUG&&console.log("  variable "+Y+" is: "+yt.get_binding(yt.usr_symbol(Y)).toString()),p.defs.codeGen=!1,p.DEBUG&&console.log(`  variable ${Y} depends on: `),_+=" variable "+Y+" depends on: ";var V=[];let Ae=[],tt=[];cx(Y,V,[],Ae,[],tt);for(let Oe of Array.from(Ae))p.DEBUG&&console.log(`    --> cycle through ${Oe}`);for(let Oe of Array.from(V))p.DEBUG&&console.log(`    ${Oe}`),_+=Oe+", ";_+="; ";for(let Oe of Array.from(tt))_+=" "+Oe+", ";p.DEBUG&&console.log(`  code generation:${Y} is: ${yt.get_binding(yt.usr_symbol(Y))}`);let Ve=yt.get_binding(yt.usr_symbol(Y)),ke=[],st=[];for(let Oe of Array.from(V))if(Oe[0]==="'"){let at=Oe.substring(1),ir=yt.usr_symbol(at),Gt=yt.usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+at);ke.push(ir),st.push(Gt),Ve=mf.subst(Ve,ir,Gt),p.DEBUG&&console.log(`after substitution: ${Ve}`)}try{Ve=QD.simplifyForCodeGeneration(Ve)}catch(Oe){p.PRINTOUTRESULT&&console.log(Oe),p.defs.errorMessage=Oe+"",_f.init()}for(let Oe=0;Oe<ke.length;Oe++)Ve=mf.subst(Ve,st[Oe],ke[Oe]);if(yt.clearRenamedVariablesToAvoidBindingToExternalScope(),p.defs.errorMessage===""){let Oe=Ve,at=[];yt.collectUserSymbols(Oe,at),o="",s="",p.defs.codeGen=!0;let ir=Oe.toString();p.defs.codeGen=!1;let Gt=p.defs.printMode;p.defs.printMode=p.PRINTMODE_LATEX;let qr=Oe.toString();if(p.defs.printMode=Gt,Ae.indexOf(Y)!==-1)T+="// "+Y+" is part of a cyclic dependency, no code generated.",k+="#"+Y+" is part of a cyclic dependency, no code generated.";else if(at=at.filter(It=>p.predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(It+"")===-1),at=at.filter(It=>V.indexOf(It+"")!==-1||V.indexOf("'"+It+"")!==-1),at.length!==0){let It="(";for(let uo of Array.from(at))uo.printname!==Y&&(It+=uo.printname+", ");It=It.replace(/, $/gm,""),It+=")",T+=Y+" = function "+It+" { return ( "+ir+" ); }",k+=Y+It+" = "+qr}else T+=Y+" = "+ir+";",k+=Y+" = "+qr;T+=`
`,k+=`
`,p.DEBUG&&console.log(`    ${T}`)}}}return T=T.replace(/\n$/gm,""),k=k.replace(/\n$/gm,""),p.defs.symbolsDependencies={},p.defs.symbolsHavingReassignments=[],p.defs.patternHasBeenFound=!1,p.defs.symbolsInExpressionsWithoutAssignments=[],p.DEBUG&&console.log(`testable string: ${_}`),bf&&console.log(`findDependenciesInScript time for: ${f} : ${new Date().getTime()-r}ms`),[_,w[0],T,k,w[1],p.defs.errorMessage,c]}nr.findDependenciesInScript=wb;function cx(e,t,r,n,i,o){if(r.push(e),p.defs.symbolsDependencies[i[i.length-1]]!=null&&p.defs.symbolsDependencies[i[i.length-1]].indexOf("'"+e)!==-1){p.DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e);return}if(i.push(e),p.defs.symbolsDependencies[e]==null)t.indexOf(e)===-1&&t.push(e);else for(let s of Array.from(p.defs.symbolsDependencies[e]))if(i.indexOf(s)!==-1){p.DEBUG&&console.log("  found cycle:");let u="";for(let c of Array.from(i))n.indexOf(c)===-1&&n.push(c),p.DEBUG&&console.log(c+" --> "),u+=c+" --> ";p.DEBUG&&console.log(` ... then ${s} again`),u+=" ... then "+s+" again",o.push(u),n.indexOf(s)===-1&&n.push(s)}else cx(s,t,r,n,i,o),i.pop()}var WD="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}";function Rb(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(p.transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(p.dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+WD+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e}function Lb(e){return e=e.replace(new RegExp(String.fromCharCode(8901),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(8226),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(12539),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(55296),"g"),String.fromCharCode(p.dotprod_unicode)),e=e.replace(new RegExp(String.fromCharCode(65381),"g"),String.fromCharCode(p.dotprod_unicode)),e}var bf=!1;function dx(e,t=!1){let r,n,i,o=new Date().getTime();e=Lb(e),p.defs.inited||(p.defs.inited=!0,_f.init());let s=0,u=0,c="",f="",_,w;for(;;){try{p.defs.errorMessage="",Za(),[s,r]=ux.scan(e.substring(u)),Za()}catch(k){p.PRINTOUTRESULT&&console.log(k),c+=k.message,t&&(f+=Rb(k.message)),p.reset_after_error();break}if(s===0)break;u+=s;let T=!1;try{p.defs.stringsEmittedByUserPrintouts="",n=fx(r),Za(),p.isstr(n)&&(p.DEBUG&&console.log(n.str),p.DEBUG&&console.log(`
`)),n===yt.symbol(p.NIL)?(w=p.defs.stringsEmittedByUserPrintouts,t&&(_="$$"+p.defs.stringsEmittedByUserPrintouts+"$$")):(w=lx.print_expr(n),w+=`
`,t&&(_="$$"+lx.collectLatexStringFromReturnValue(n)+"$$",p.DEBUG&&console.log(`collectedLatexResult: ${_}`))),c+=w,t&&(f+=_),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("printline"),p.DEBUG&&console.log(w)),p.PRINTOUTRESULT&&(p.DEBUG&&console.log("display:"),HD.print2dascii(n)),t&&(f+=`
`)}catch(k){T=!0,w=k.message,t&&(_=Rb(k.message)),p.PRINTOUTRESULT&&console.log(w),c+=w,w!==""&&(c+=`
`),t&&(f+=_,f+=`
`),_f.init()}}if(c[c.length-1]===`
`&&(c=c.substring(0,c.length-1)),t&&f[f.length-1]===`
`&&(f=f.substring(0,f.length-1)),t?(p.DEBUG&&console.log(`allReturnedLatexStrings: ${f}`),i=[c,f]):i=c,bf){let T="run time on: "+e+" : "+(new Date().getTime()-o)+"ms";console.log(T)}return c="",f="",i}nr.run=dx;function Za(){p.defs.chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0&&(p.breakpoint,du("symbols evaluation still ongoing?")),p.defs.evaluatingAsFloats&&(p.breakpoint,du("numeric evaluation still ongoing?")),p.defs.evaluatingPolar&&(p.breakpoint,du("evaluation of polar still ongoing?"))}nr.check_stack=Za;function fx(e){p.DEBUG&&console.log("#### top level eval"),p.defs.trigmode=0;let t=yt.symbol(p.AUTOEXPAND);p.defs.expanding=!cu.isZeroAtomOrTensor(yt.get_binding(t));let r=e,n=XD.Eval(e);return n===yt.symbol(p.NIL)||(yt.set_binding(yt.symbol(p.LAST),n),cu.isZeroAtomOrTensor(yt.get_binding(yt.symbol(p.BAKE)))||(n=VD.bake(n)),(r===yt.symbol(p.SYMBOL_I)||r===yt.symbol(p.SYMBOL_J))&&cu.isimaginaryunit(n))?n:cu.isimaginaryunit(yt.get_binding(yt.symbol(p.SYMBOL_J)))?mf.subst(n,p.Constants.imaginaryunit,yt.symbol(p.SYMBOL_J)):cu.isimaginaryunit(yt.get_binding(yt.symbol(p.SYMBOL_I)))?mf.subst(n,p.Constants.imaginaryunit,yt.symbol(p.SYMBOL_I)):n}nr.top_level_eval=fx;function JD(){p.defs.esc_flag&&du("esc key")}nr.check_esc_flag=JD;function KD(e){let t,r;p.DEBUG&&console.log("computeDependenciesFromAlgebra!!!");let n=e,i=!0;if(p.defs.called_from_Algebra_block=!0,e=Lb(e),!i){p.defs.userSimplificationsInListForm=[];let o="";for(let s of Array.from(p.defs.userSimplificationsInListForm))o+="silentpattern("+p.car(s)+","+p.car(p.cdr(s))+","+p.car(p.cdr(p.cdr(s)))+`)
`;ax.do_clearall(),e=o+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(p.DEBUG){console.log("computeDependenciesFromAlgebra: patterns in the list --------------- ");for(let o of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(o)+","+p.cdr(o)+")");console.log("...end of list --------------- ")}return p.defs.called_from_Algebra_block=!1,wb(e,!0)[6]}nr.computeDependenciesFromAlgebra=KD;function ek(e){let t,r,n,i,o,s,u,c,f,_=e,w=!0;p.defs.called_from_Algebra_block=!0;let T=new Date().getTime();bf&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=Lb(e);let k=e;if(p.DEBUG){console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- ");for(o of Array.from(p.defs.userSimplificationsInListForm))console.log(p.car(o)+","+p.cdr(o)+")");console.log("...end of list --------------- ")}if(!w){p.defs.userSimplificationsInListForm=[];let V="";for(o of Array.from(p.defs.userSimplificationsInListForm))V+="silentpattern("+p.car(o)+","+p.car(p.cdr(o))+","+p.car(p.cdr(p.cdr(o)))+`)
`;ax.do_clearall(),e=V+e,p.DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[f,c,n,u,s,p.defs.errorMessage,i]=wb(e),p.defs.called_from_Algebra_block=!1,(u!==""||p.defs.errorMessage!=="")&&(c+=`
`+u,p.defs.errorMessage!==""&&(c+=`
`+p.defs.errorMessage),c=c.replace(/\n/g,`

`),s+=`
$$`+u+"$$",p.defs.errorMessage!==""&&(s+=Rb(p.defs.errorMessage)),s=s.replace(/\n/g,`

`)),s=s.replace(/\n*/,""),s=s.replace(/\$\$\$\$\n*/g,""),n=n.replace(/Math\./g,""),n=n.replace(/\n/g,`

`),bf&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+k+" : "+(new Date().getTime()-T)+"ms"),{code:n,result:s,latexResult:s,dependencyInfo:i}}nr.computeResultsAndJavaScriptFromAlgebra=ek});var qt=A(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.copy_tensor=vt.power_tensor=vt.compare_tensors=vt.d_tensor_scalar=vt.d_scalar_tensor=vt.d_tensor_tensor=vt.is_square_matrix=vt.check_tensor_dimensions=vt.scalar_times_tensor=vt.tensor_times_scalar=vt.tensor_plus_tensor=vt.Eval_tensor=void 0;var zn=St(),fr=N(),Cb=Ee(),fu=$(),mx=Ie(),tk=ce(),rk=j(),Pb=wo(),nk=G(),ik=Bi(),ok=Nl(),sk=Q(),Db=ee(),_x=X();function ak(e){Yn(e);let{nelem:t,ndim:r}=e.tensor,n=zn.alloc_tensor(t);return n.tensor.ndim=r,n.tensor.dim=Array.from(e.tensor.dim),Yn(n),n.tensor.elem=e.tensor.elem.map(nk.Eval),Yn(e),Yn(n),vk(n)}vt.Eval_tensor=ak;function lk(e,t){if(e.tensor.ndim!==t.tensor.ndim||e.tensor.dim.some((c,f)=>c!==t.tensor.dim[f]))return fu.symbol(fr.NIL);let{nelem:r,ndim:n}=e.tensor,i=zn.alloc_tensor(r);i.tensor.ndim=n,i.tensor.dim=Array.from(e.tensor.dim);let o=e.tensor.elem,s=t.tensor.elem,u=i.tensor.elem;for(let c=0;c<r;c++)u[c]=tk.add(o[c],s[c]);return i}vt.tensor_plus_tensor=lk;function uk(e,t){let{ndim:r,nelem:n}=e.tensor,i=zn.alloc_tensor(n);return i.tensor.ndim=r,i.tensor.dim=Array.from(e.tensor.dim),i.tensor.elem=e.tensor.elem.map(o=>_x.multiply(o,t)),i}vt.tensor_times_scalar=uk;function ck(e,t){let{ndim:r,nelem:n}=t.tensor,i=zn.alloc_tensor(n);return i.tensor.ndim=r,i.tensor.dim=Array.from(t.tensor.dim),i.tensor.elem=t.tensor.elem.map(o=>_x.multiply(e,o)),i}vt.scalar_times_tensor=ck;function Yn(e){if(e.tensor.nelem!==e.tensor.elem.length)return console.log("something wrong in tensor dimensions"),fr.breakpoint}vt.check_tensor_dimensions=Yn;function dk(e){return fr.istensor(e)&&e.tensor.ndim===2&&e.tensor.dim[0]===e.tensor.dim[1]}vt.is_square_matrix=dk;function fk(e,t){let{ndim:r,nelem:n}=e.tensor;if(r+1>=fr.MAXDIM)return Db.makeList(fu.symbol(fr.DERIVATIVE),e,t);let i=zn.alloc_tensor(n*t.tensor.nelem);i.tensor.ndim=r+1,i.tensor.dim=[...e.tensor.dim,t.tensor.dim[0]];let o=e.tensor.elem,s=t.tensor.elem,u=i.tensor.elem;for(let c=0;c<n;c++)for(let f=0;f<t.tensor.nelem;f++)u[c*t.tensor.nelem+f]=Pb.derivative(o[c],s[f]);return i}vt.d_tensor_tensor=fk;function mk(e,t){let r=zn.alloc_tensor(t.tensor.nelem);return r.tensor.ndim=1,r.tensor.dim[0]=t.tensor.dim[0],r.tensor.elem=t.tensor.elem.map(n=>Pb.derivative(e,n)),r}vt.d_scalar_tensor=mk;function _k(e,t){let r=zn.alloc_tensor(e.tensor.nelem);return r.tensor.ndim=e.tensor.ndim,r.tensor.dim=[...e.tensor.dim],r.tensor.elem=e.tensor.elem.map(n=>Pb.derivative(n,t)),r}vt.d_tensor_scalar=_k;function bk(e,t){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(let r=0;r<e.tensor.ndim;r++){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(let r=0;r<e.tensor.nelem;r++)if(!mx.equal(e.tensor.elem[r],t.tensor.elem[r]))return mx.lessp(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0}vt.compare_tensors=bk;function gk(e,t){let r=e.tensor.ndim-1;if(e.tensor.dim[0]!==e.tensor.dim[r])return Db.makeList(fu.symbol(fr.POWER),e,t);let n=rk.nativeInt(t);if(isNaN(n))return Db.makeList(fu.symbol(fr.POWER),e,t);if(n===0){e.tensor.ndim!==2&&Cb.stop("power(tensor,0) with tensor rank not equal to 2"),n=e.tensor.dim[0],e=zn.alloc_tensor(n*n),e.tensor.ndim=2,e.tensor.dim[0]=n,e.tensor.dim[1]=n;for(let s=0;s<n;s++)e.tensor.elem[n*s+s]=fr.Constants.one;return Yn(e),e}let i=e;n<0&&(n=-n,i=ok.inv(i));let o=i;for(let s=1;s<n&&(o=ik.inner(o,i),!sk.isZeroAtomOrTensor(o));s++);return o}vt.power_tensor=gk;function yk(e){let t=zn.alloc_tensor(e.tensor.nelem);return t.tensor.ndim=e.tensor.ndim,t.tensor.dim=[...e.tensor.dim],t.tensor.elem=[...e.tensor.elem],Yn(e),Yn(t),t}vt.copy_tensor=yk;function vk(e){if(!fr.istensor(e))return e;let t=e.tensor.elem[0];if(e.tensor.elem.some(o=>!qk(t,o))&&Cb.stop("Cannot promote tensor due to inconsistent tensor components."),!fr.istensor(t))return e;let r=e.tensor.ndim+t.tensor.ndim;r>fr.MAXDIM&&Cb.stop("tensor rank > "+fr.MAXDIM);let n=e.tensor.nelem*t.tensor.nelem,i=zn.alloc_tensor(n);return i.tensor.ndim=r,i.tensor.dim=[...e.tensor.dim,...t.tensor.dim],i.tensor.elem=[].concat(...e.tensor.elem.map(o=>o.tensor.elem)),Yn(t),Yn(i),i}function qk(e,t){if(!fr.istensor(e)&&!fr.istensor(t))return!0;if(!fr.istensor(e)||!fr.istensor(t)||e.tensor.ndim!==t.tensor.ndim)return!1;for(let r=0;r<e.tensor.ndim;r++)if(e.tensor.dim[r]!==t.tensor.dim[r])return!1;return!0}});var St=A(gf=>{"use strict";Object.defineProperty(gf,"__esModule",{value:!0});gf.alloc_tensor=void 0;var Ek=qt(),bx=N();function xk(e){let t=new bx.Tensor;for(let r=0;r<e;r++)t.tensor.elem[r]=bx.Constants.zero;return Ek.check_tensor_dimensions(t),t}gf.alloc_tensor=xk});var Ie=A(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.sort=Lt.square=Lt.exponential=Lt.yyexpand=Lt.length=Lt.cmp_expr=Lt.sign=Lt.lessp=Lt.equal=Lt.zero_matrix=void 0;var pk=St(),ut=N(),gx=ui(),mu=$(),yx=j(),hk=G(),vx=Et(),Ak=qt();function Ok(e,t){let r=pk.alloc_tensor(e*t);return r.ndim=2,r.dim[0]=e,r.dim[1]=t,r}Lt.zero_matrix=Ok;function Mk(e,t){return _u(e,t)===0}Lt.equal=Mk;function Tk(e,t){return _u(e,t)<0}Lt.lessp=Tk;function yf(e){return e<0?-1:e>0?1:0}Lt.sign=yf;function _u(e,t){let r=0;if(e===t)return 0;if(e===mu.symbol(ut.NIL))return-1;if(t===mu.symbol(ut.NIL))return 1;if(ut.isNumericAtom(e)&&ut.isNumericAtom(t))return yf(yx.compare_numbers(e,t));if(ut.isNumericAtom(e))return-1;if(ut.isNumericAtom(t))return 1;if(ut.isstr(e)&&ut.isstr(t))return yf(gx.strcmp(e.str,t.str));if(ut.isstr(e))return-1;if(ut.isstr(t))return 1;if(ut.issymbol(e)&&ut.issymbol(t))return yf(gx.strcmp(mu.get_printname(e),mu.get_printname(t)));if(ut.issymbol(e))return-1;if(ut.issymbol(t))return 1;if(ut.istensor(e)&&ut.istensor(t))return Ak.compare_tensors(e,t);if(ut.istensor(e))return-1;if(ut.istensor(t))return 1;for(;ut.iscons(e)&&ut.iscons(t);){if(r=_u(ut.car(e),ut.car(t)),r!==0)return r;e=ut.cdr(e),t=ut.cdr(t)}return ut.iscons(t)?-1:ut.iscons(e)?1:0}Lt.cmp_expr=_u;function Nk(e){return ut.iscons(e)?[...e].length:0}Lt.length=Nk;function Ik(e){return ut.doexpand(hk.Eval,e)}Lt.yyexpand=Ik;function Sk(e){return vx.power(mu.symbol(ut.E),e)}Lt.exponential=Sk;function wk(e){return vx.power(e,yx.integer(2))}Lt.square=wk;function Rk(e){e.sort(_u)}Lt.sort=Rk});var Ac=A(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.countsize=ao.countOccurrencesOfSymbol=ao.count=void 0;var Lk=Ie(),vf=N(),kb=e=>e.reduce((t,r)=>t+r,0);function qf(e){let t;if(vf.iscons(e)){let r=[...e];t=kb(r.map(qf))+r.length}else t=1;return t}ao.count=qf;function qx(e,t){let r=0;return vf.iscons(t)?r=kb([...t].map(n=>qx(e,n))):Lk.equal(e,t)&&(r=1),r}ao.countOccurrencesOfSymbol=qx;function Ck(e){let t=0;if(vf.istensor(e))for(let r=0;r<e.tensor.nelem;r++)t+=qf(e.tensor.elem[r]);else if(vf.iscons(e)){let r=[...e];t=kb(r.map(qf))+r.length}else t=1;return t}ao.countsize=Ck});var $=A(ot=>{"use strict";Object.defineProperty(ot,"__esModule",{value:!0});ot.clear_symbol=ot.clearRenamedVariablesToAvoidBindingToExternalScope=ot.iskeyword=ot.symbol=ot.collectUserSymbols=ot.clear_symbols=ot.reset_symbols=ot.get_binding=ot.set_binding=ot.get_printname=ot.usr_symbol=ot.std_symbol=ot.inChildScope=ot.Eval_symbolsinfo=void 0;var Pk=Ac(),rn=N(),Ef=Ee();function Dk(){let e=kk();return e!==""?new rn.Str(e):Ex(rn.NIL)}ot.Eval_symbolsinfo=Dk;function kk(){return[...jr.symbolinfo()].join(`
`)}var es=class{constructor(t){this.parent=t,this.symbols=new Map,this.bindings=new Map}getOrCreate(t){let r=this.getExisting(t);if(r)return r;let n=new rn.Sym(t);return this.symbols.set(t,n),n}getExisting(t){var r;return((r=this.parent)===null||r===void 0?void 0:r.getExisting(t))||this.symbols.get(t)}mustGet(t){var r;return this.symbols.get(t)||((r=this.parent)===null||r===void 0?void 0:r.mustGet(t))||Ef.stop(`${t} not defined`)}has(t){return this.symbols.has(t.printname)}binding(t){var r;return this.bindings.get(t.printname)||((r=this.parent)===null||r===void 0?void 0:r.binding(t))||t}set(t,r){this.bindings.set(t.printname,r)}clear(){this.bindings.clear()}delete(t){var r;this.symbols.delete(t.printname),this.bindings.delete(t.printname),(r=this.parent)===null||r===void 0||r.delete(t)}*symbolinfo(){this.parent&&(yield*this.parent.symbolinfo());for(let[t,r]of this.symbols.entries()){let n=this.bindings.get(t)||r,i=(n+"").substring(0,4);yield`symbol: ${r} size: ${Pk.countsize(n)} value: ${i}...`}}clearRenamedVariablesToAvoidBindingToExternalScope(){var t;for(let r of this.symbols.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.symbols.delete(r);for(let r of this.bindings.keys())r.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1&&this.bindings.delete(r);(t=this.parent)===null||t===void 0||t.clearRenamedVariablesToAvoidBindingToExternalScope()}},ts=new es,jr=new es(ts);function Uk(e){let t=jr;try{return jr=new es(jr),e()}finally{jr=t}}ot.inChildScope=Uk;function $k(e,t){let r=ts.getOrCreate(e);r.latexPrint=e,r.keyword=t}ot.std_symbol=$k;function Bk(e){return jr.getOrCreate(e)}ot.usr_symbol=Bk;function Gk(e){return e.k!==rn.SYM&&Ef.stop("symbol error"),e.printname}ot.get_printname=Gk;function Fk(e,t){e.k!==rn.SYM&&Ef.stop("symbol error"),jr.set(e,t)}ot.set_binding=Fk;function jk(e){return e.k!==rn.SYM&&Ef.stop("symbol error"),jr.binding(e)}ot.get_binding=jk;function zk(e){return e.k!==rn.SYM?!1:/^[abcdjnrstxyz]_?$/.test(e.printname)||!ts.has(e)}function Yk(){ts=new es,jr=new es(ts)}ot.reset_symbols=Yk;function Zk(){jr=new es(ts),ts.clear()}ot.clear_symbols=Zk;function Ub(e,t){if(t==null&&(t=[]),zk(e)&&t.indexOf(e)===-1){t.push(e);return}if(rn.istensor(e)){for(let r=0;r<e.tensor.nelem;r++)Ub(e.tensor.elem[r],t);return}for(;rn.iscons(e);)Ub(rn.car(e),t),e=rn.cdr(e)}ot.collectUserSymbols=Ub;function Ex(e){return jr.mustGet(e)}ot.symbol=Ex;function Vk(e){return rn.issymbol(e)&&e.keyword!=null}ot.iskeyword=Vk;function Xk(){jr.clearRenamedVariablesToAvoidBindingToExternalScope()}ot.clearRenamedVariablesToAvoidBindingToExternalScope=Xk;function Hk(e){jr.delete(e)}ot.clear_symbol=Hk});var ti=A(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.print_list=Ot.print_expr=Ot.printline=Ot.collectLatexStringFromReturnValue=Ot.print_str=Ot.Eval_printlist=Ot.Eval_printhuman=Ot.Eval_printlatex=Ot.Eval_printcomputer=Ot.Eval_print2dascii=Ot.Eval_print=void 0;var l=N(),se=$(),rs=Ie(),Qk=sn(),xf=j(),Wk=Mn(),Jk=G(),At=Q(),xx=X(),Kk=oi(),eU=Sb(),tU=zi(),rU="^";function nU(e){return l.defs.stringsEmittedByUserPrintouts+=Va(l.cdr(e),l.defs.printMode),se.symbol(l.NIL)}Ot.Eval_print=nU;function iU(e){return l.defs.stringsEmittedByUserPrintouts+=Va(l.cdr(e),l.PRINTMODE_2DASCII),se.symbol(l.NIL)}Ot.Eval_print2dascii=iU;function oU(e){return l.defs.stringsEmittedByUserPrintouts+=Va(l.cdr(e),l.PRINTMODE_COMPUTER),se.symbol(l.NIL)}Ot.Eval_printcomputer=oU;function sU(e){return l.defs.stringsEmittedByUserPrintouts+=Va(l.cdr(e),l.PRINTMODE_LATEX),se.symbol(l.NIL)}Ot.Eval_printlatex=sU;function aU(e){let t=l.defs.test_flag;return l.defs.test_flag=!1,l.defs.stringsEmittedByUserPrintouts+=Va(l.cdr(e),l.PRINTMODE_HUMAN),l.defs.test_flag=t,se.symbol(l.NIL)}Ot.Eval_printhuman=aU;function lU(e){let t=Va(l.cdr(e),l.PRINTMODE_LIST);return l.defs.stringsEmittedByUserPrintouts+=t,se.symbol(l.NIL)}Ot.Eval_printlist=lU;function Va(e,t){let r="";for(;l.iscons(e);){let n=Jk.Eval(l.car(e)),i=l.defs.printMode;t===l.PRINTMODE_COMPUTER?(l.defs.printMode=l.PRINTMODE_COMPUTER,r=pf(n),bu(r,l.LAST_FULL_PRINT)):t===l.PRINTMODE_HUMAN?(l.defs.printMode=l.PRINTMODE_HUMAN,r=pf(n),bu(r,l.LAST_PLAIN_PRINT)):t===l.PRINTMODE_2DASCII?(l.defs.printMode=l.PRINTMODE_2DASCII,r=eU.print2dascii(n),bu(r,l.LAST_2DASCII_PRINT)):t===l.PRINTMODE_LATEX?(l.defs.printMode=l.PRINTMODE_LATEX,r=pf(n),bu(r,l.LAST_LATEX_PRINT)):t===l.PRINTMODE_LIST&&(l.defs.printMode=l.PRINTMODE_LIST,r=Xa(n),bu(r,l.LAST_LIST_PRINT)),l.defs.printMode=i,e=l.cdr(e)}return l.DEBUG&&console.log(`emttedString from display: ${l.defs.stringsEmittedByUserPrintouts}`),r}function bu(e,t){let[,r]=tU.scan('"'+e+'"');se.set_binding(se.symbol(t),r)}function S(e){return l.DEBUG&&console.log(`emttedString from print_str: ${l.defs.stringsEmittedByUserPrintouts}`),e}Ot.print_str=S;function zr(e){return e}function uU(e){let t=l.defs.printMode;l.defs.printMode=l.PRINTMODE_LATEX;let r=l.defs.codeGen;l.defs.codeGen=!1;let n=C(e);return n=n.replace(/_/g,"\\_"),l.defs.printMode=t,l.defs.codeGen=r,l.DEBUG&&console.log(`emttedString from collectLatexStringFromReturnValue: ${l.defs.stringsEmittedByUserPrintouts}`),n}Ot.collectLatexStringFromReturnValue=uU;function pf(e){let t="";return t+=C(e),t}Ot.printline=pf;function px(e){let t="";return At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||rs.lessp(e,l.Constants.zero)?(t+=zr("("),t+=C(e),t+=zr(")")):t+=C(e),t}function hx(e){let t="";return At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)?(t+=zr("("),t+=C(e),t+=zr(")")):t+=C(e),t}function cU(e,t){let r="",n=l.cadr(e),i=l.caddr(e);return At.isminusone(i)?(r+=px(n),r):(t===1&&(r+=zr("(")),i=xx.negate(i),r+=yu(n,i),t===1&&(r+=zr(")")),r)}function dU(e){let t,r,n="",i=0,o=0,s=0,u=l.cdr(e),c=l.car(u);for(l.isrational(c)?(t=Qk.absval(xf.mp_numerator(c)),r=xf.mp_denominator(c),At.isplusone(t)||o++,At.isplusone(r)||s++,u=l.cdr(u)):(t=l.Constants.one,r=l.Constants.one);l.iscons(u);)c=l.car(u),hf(c)?s++:o++,u=l.cdr(u);if(l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("\\frac{")),o===0)n+=zr("1");else for(i=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),At.isplusone(t)||(n+=En(t),i=1);l.iscons(u);)c=l.car(u),hf(c)||(i&&(n+=Bb()),n+=En(c),i=1),u=l.cdr(u);for(l.defs.printMode===l.PRINTMODE_LATEX?n+=S("}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" / "):n+=S("/"),s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=zr("(")),i=0,u=l.cdr(e),l.isrational(l.car(u))&&(u=l.cdr(u)),At.isplusone(r)||(n+=En(r),i=1);l.iscons(u);)c=l.car(u),hf(c)&&(i&&(n+=Bb()),n+=cU(c,s),i=1),u=l.cdr(u);return s>1&&l.defs.printMode!==l.PRINTMODE_LATEX&&(n+=zr(")")),l.defs.printMode===l.PRINTMODE_LATEX&&(n+=S("}")),n}function C(e){let t="";if(l.isadd(e))for(e=l.cdr(e),gu(l.car(e))==="-"&&(t+=S("-")),t+=$b(l.car(e)),e=l.cdr(e);l.iscons(e);)gu(l.car(e))==="+"?l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" + "):t+=S("+"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?t+=S(" - "):t+=S("-"),t+=$b(l.car(e)),e=l.cdr(e);else gu(e)==="-"&&(t+=S("-")),t+=$b(e);return t}Ot.print_expr=C;function gu(e){let t="";return l.ismultiply(e)&&l.isNumericAtom(l.cadr(e))&&rs.lessp(l.cadr(e),l.Constants.zero)||l.isNumericAtom(e)&&rs.lessp(e,l.Constants.zero)?t+="-":t+="+",t}function $b(e){let t="";if(l.ismultiply(e)&&VU(e))return t+=dU(e),t;if(l.ismultiply(e)){let r,n;e=l.cdr(e),At.isminusone(l.car(e))&&(e=l.cdr(e));let i=!1;l.isNumericAtom(l.car(e))&&(i=!0);let o=!1;for(l.defs.printMode===l.PRINTMODE_LATEX&&l.iscons(l.cdr(e))&&At.isNumberOneOverSomething(l.car(e))&&(o=!0,r=l.car(e).q.b.toString()),o?(n=t,t=""):t+=En(l.car(e)),e=l.cdr(e);l.iscons(e);)l.defs.printMode===l.PRINTMODE_LATEX&&i&&l.caar(e)===se.symbol(l.POWER)&&l.isNumericAtom(l.car(l.cdr(l.car(e))))&&(At.isfraction(l.car(l.cdr(l.cdr(l.car(e)))))||(t+=" \\cdot ")),t+=Bb(),t+=En(l.car(e),!1,!0),i=!1,l.isNumericAtom(l.car(e))&&(i=!0),e=l.cdr(e);o&&(t=n+"\\frac{"+t+"}{"+r+"}")}else t+=En(e);return t}function Ax(e){let t="";return t+=zr("("),t+=C(e),t+=zr(")"),t}function fU(e){let t="";return e=l.cadr(e),At.isfraction(e)||l.isadd(e)||l.ismultiply(e)||l.ispower(e)||l.isfactorial(e)?t+=Ax(e):t+=C(e),t+=zr("!"),t}function mU(e){let t="";return t+=S("\\left |"),t+=C(l.cadr(e)),t+=S(" \\right |"),t}function _U(e){let t="";return t+=S("\\binom{"),t+=C(l.cadr(e)),t+=S("}{"),t+=C(l.caddr(e)),t+=S("} "),t}function bU(e){let t="";return t+=C(l.cadr(e)),t+=S(" \\cdot "),t+=C(l.caddr(e)),t}function gU(e){let t="dot(";return t+=C(l.cadr(e)),t+=", ",t+=C(l.caddr(e)),t+=")",t}function yU(e){let t="Math.sin(";return t+=C(l.cadr(e)),t+=")",t}function vU(e){let t="Math.cos(";return t+=C(l.cadr(e)),t+=")",t}function qU(e){let t="Math.tan(";return t+=C(l.cadr(e)),t+=")",t}function EU(e){let t="Math.asin(";return t+=C(l.cadr(e)),t+=")",t}function xU(e){let t="Math.acos(";return t+=C(l.cadr(e)),t+=")",t}function pU(e){let t="Math.atan(";return t+=C(l.cadr(e)),t+=")",t}function hU(e){let t="";return t+=S("\\sqrt{"),t+=C(l.cadr(e)),t+=S("} "),t}function AU(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^T"),t}function OU(e){let t="";return t+=S("transpose("),t+=C(l.cadr(e)),t+=S(")"),t}function MU(e){let t="";return t+=S("identity("),t+=C(l.cadr(e)),t+=S(")"),t}function TU(e){let t="";return t+=S("{"),l.iscons(l.cadr(e))&&(t+=S("(")),t+=C(l.cadr(e)),l.iscons(l.cadr(e))&&(t+=S(")")),t+=S("}"),t+=S("^{-1}"),t}function NU(e){let t="";return t+=S("inv("),t+=C(l.cadr(e)),t+=S(")"),t}function IU(e){let t="",r=l.car(l.cdr(e));e=l.cdr(e);let n=e,i=0;for(;l.iscons(l.cdr(l.cdr(e)));){i++;let o=l.cdr(l.cdr(e));t+=S("\\int^{"),t+=C(l.car(l.cdr(o))),t+=S("}_{"),t+=C(l.car(o)),t+=S("} \\! "),e=l.cdr(o)}t+=C(r),t+=S(" \\,"),e=n;for(let o=1;o<=i;o++){let s=l.cdr(e);t+=S(" \\mathrm{d} "),t+=C(l.car(s)),o<i&&(t+=S(" \\, ")),e=l.cdr(l.cdr(s))}return t}function SU(e){let t="";return t+=Ox(e,0,0)[1],t}function Ox(e,t,r){let n="";if(n+=S("["),t<e.tensor.ndim-1)for(let i=0;i<e.tensor.dim[t];i++){let o;[r,o]=Array.from(Ox(e,t+1,r)),n+=o,i!==e.tensor.dim[t]-1&&(n+=S(","))}else for(let i=0;i<e.tensor.dim[t];i++)n+=C(e.tensor.elem[r]),i!==e.tensor.dim[t]-1&&(n+=S(",")),r++;return n+=S("]"),[r,n]}function wU(e){let t="";return e.tensor.ndim<=2&&(t+=Mx(!0,e,0,0)[1]),t}function Mx(e,t,r,n){let i="";if(e&&(i+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(let o=0;o<t.tensor.dim[r];o++){let s;[n,s]=Array.from(Mx(!1,t,r+1,n)),i+=s,o!==t.tensor.dim[r]-1&&(i+=S(" \\\\ "))}else for(let o=0;o<t.tensor.dim[r];o++)i+=C(t.tensor.elem[n]),o!==t.tensor.dim[r]-1&&(i+=S(" & ")),n++;return e&&(i+=" \\end{bmatrix}"),[n,i]}function RU(e){let t="\\sum_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function LU(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),i=l.caddddr(e);return"(function(){ var "+r+";  var holderSum = 0;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(i)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderSum += "+C(t)+"; }  return holderSum;})()"}function CU(e){let t="\\left\\{ \\begin{array}{ll}";for(e=l.cdr(e);l.iscons(e);){if(l.cdr(e)===se.symbol(l.NIL)){t+="{",t+=C(l.car(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=C(l.cadr(e)),t+="} & if & ",t+=C(l.car(e)),t+=" \\\\\\\\",e=l.cddr(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."}function PU(e){let t="(function(){";e=l.cdr(e);let r=0;for(;l.iscons(e);){if(l.cdr(e)===se.symbol(l.NIL)){t+="else {",t+="return ("+C(l.car(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+C(l.car(e))+"){",t+="return ("+C(l.cadr(e))+");",t+="}",r++,e=l.cddr(e)}return t+="})()",t}function DU(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" < ",t+="{",t+=C(l.caddr(e)),t+="}"}function kU(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\leq ",t+="{",t+=C(l.caddr(e)),t+="}"}function UU(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" > ",t+="{",t+=C(l.caddr(e)),t+="}"}function $U(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" \\geq ",t+="{",t+=C(l.caddr(e)),t+="}"}function BU(e){let t="{";return t+=C(l.cadr(e)),t+="}",t+=" = ",t+="{",t+=C(l.caddr(e)),t+="}"}function GU(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),i=l.caddddr(e);return"(function(){ var "+r+";  var lowerlimit = "+C(n)+";  var upperlimit = "+C(i)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    "+C(t)+" } })()"}function FU(e){let t="";for(e=l.cdr(e);l.iscons(e);)t+=C(l.car(e)),e=l.cdr(e);return t}function jU(e){let t="";return t+=C(l.cadr(e)),t+=" = ",t+=C(l.caddr(e)),t+="; ",t}function zU(e){let t="\\prod_{";return t+=C(l.caddr(e)),t+="=",t+=C(l.cadddr(e)),t+="}^{",t+=C(l.caddddr(e)),t+="}{",t+=C(l.cadr(e)),t+="}",t}function YU(e){let t=l.cadr(e),r=l.caddr(e),n=l.cadddr(e),i=l.caddddr(e);return"(function(){ var "+r+";  var holderProduct = 1;  var lowerlimit = "+C(n)+";  var upperlimit = "+C(i)+";  for ("+r+" = lowerlimit; "+r+" < upperlimit; "+r+"++) {    holderProduct *= "+C(t)+"; }  return holderProduct;})()"}function yu(e,t){let r="";if(l.DEBUG&&console.log("power base: "+e+"  exponent: "+t),At.isoneovertwo(t))if(At.equaln(e,2)){if(l.defs.codeGen)return r+=S("Math.SQRT2"),r}else{if(l.defs.printMode===l.PRINTMODE_LATEX)return r+=S("\\sqrt{"),r+=C(e),r+=S("}"),r;if(l.defs.codeGen)return r+=S("Math.sqrt("),r+=C(e),r+=S(")"),r}if(At.equaln(se.get_binding(se.symbol(l.PRINT_LEAVE_E_ALONE)),1)&&e===se.symbol(l.E))return l.defs.codeGen?(r+=S("Math.exp("),r+=hx(t),r+=S(")"),r):(l.defs.printMode===l.PRINTMODE_LATEX?(r+=S("e^{"),r+=C(t),r+=S("}")):(r+=S("exp("),r+=C(t),r+=S(")")),r);if(l.defs.codeGen)return r+=S("Math.pow("),r+=px(e),r+=S(", "),r+=hx(t),r+=S(")"),r;if(At.equaln(se.get_binding(se.symbol(l.PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==se.symbol(l.E)){if(At.isminusone(t))return l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/"),l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=C(e),r+=S(")")):r+=C(e),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r;if(At.isnegativeterm(t)){l.defs.printMode===l.PRINTMODE_LATEX?r+=S("\\frac{1}{"):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S("1 / "):r+=S("1/");let n=xx.multiply(t,l.Constants.negOne);return l.iscons(e)&&l.defs.printMode!==l.PRINTMODE_LATEX?(r+=S("("),r+=yu(e,n),r+=S(")")):r+=yu(e,n),l.defs.printMode===l.PRINTMODE_LATEX&&(r+=S("}")),r}}if(At.isfraction(t)&&l.defs.printMode===l.PRINTMODE_LATEX){r+=S("\\sqrt");let n=Wk.denominator(t);return At.isplustwo(n)||(r+=S("["),r+=C(n),r+=S("]")),r+=S("{"),t=Kk.numerator(t),r+=yu(e,t),r+=S("}"),r}}return l.defs.printMode===l.PRINTMODE_LATEX&&At.isplusone(t)?r+=C(e):(l.isadd(e)||At.isnegativenumber(e)?(r+=S("("),r+=C(e),r+=S(")")):l.ismultiply(e)||l.ispower(e)?(l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S("(")),r+=En(e,!0),l.defs.printMode!==l.PRINTMODE_LATEX&&(r+=S(")"))):l.isNumericAtom(e)&&(rs.lessp(e,l.Constants.zero)||At.isfraction(e))?(r+=S("("),r+=En(e),r+=S(")")):r+=En(e),l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?r+=S(rU):r+=S("^"),l.defs.printMode===l.PRINTMODE_LATEX?C(t).length>1?(r+=S("{"),r+=C(t),r+=S("}")):r+=C(t):l.iscons(t)||At.isfraction(t)||l.isNumericAtom(t)&&rs.lessp(t,l.Constants.zero)?(r+=S("("),r+=C(t),r+=S(")")):r+=En(t)),r}function ZU(e){let t="";if(e=l.cdr(e),l.caar(e)===se.symbol(l.ADD)||l.caar(e)===se.symbol(l.MULTIPLY)||l.caar(e)===se.symbol(l.POWER)||l.caar(e)===se.symbol(l.FACTORIAL)?t+=Ax(l.car(e)):t+=C(l.car(e)),t+=S("["),e=l.cdr(e),l.iscons(e))for(t+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)t+=S(","),t+=C(l.car(e)),e=l.cdr(e);return t+=S("]"),t}function En(e,t=!1,r=!1){let n="";if(l.isNumericAtom(e))return r&&rs.lessp(e,l.Constants.zero)&&(n+="("),n+=xf.print_number(e,r),r&&rs.lessp(e,l.Constants.zero)&&(n+=")"),n;if(l.isstr(e))return n+=S('"'),n+=S(e.str),n+=S('"'),n;if(l.istensor(e))return l.defs.printMode===l.PRINTMODE_LATEX?n+=wU(e):n+=SU(e),n;if(l.ismultiply(e))return t||(gu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\left ("):n+=S("(")),n+=C(e),t||(gu(e)==="-"||l.defs.printMode!==l.PRINTMODE_LATEX)&&(l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\right ) "):n+=S(")")),n;if(l.isadd(e))return t||(n+=S("(")),n+=C(e),t||(n+=S(")")),n;if(l.ispower(e)){let i=l.cadr(e),o=l.caddr(e);return n+=yu(i,o),n}if(l.car(e)===se.symbol(l.FUNCTION)){let i=l.cadr(e);if(!l.defs.codeGen){let o=l.caddr(e);n+=S("function "),l.DEBUG&&console.log(`emittedString from print_factor ${l.defs.stringsEmittedByUserPrintouts}`),n+=Xa(o),n+=S(" -> ")}return n+=C(i),n}if(l.car(e)===se.symbol(l.PATTERN))return n+=C(l.caadr(e)),l.defs.printMode===l.PRINTMODE_LATEX?n+=S(" \\rightarrow "):l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag?n+=S(" -> "):n+=S("->"),n+=C(l.car(l.cdr(l.cadr(e)))),n;if(l.car(e)===se.symbol(l.INDEX)&&l.issymbol(l.cadr(e)))return n+=ZU(e),n;if(l.isfactorial(e))return n+=fU(e),n;if(l.car(e)===se.symbol(l.ABS)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=mU(e),n;if(l.car(e)===se.symbol(l.SQRT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=hU(e),n;if(l.isfactorial(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=AU(e),n;if(l.defs.codeGen)return n+=OU(e),n}else if(l.car(e)===se.symbol(l.UNIT)){if(l.defs.codeGen)return n+=MU(e),n}else if(l.isinv(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=TU(e),n;if(l.defs.codeGen)return n+=NU(e),n}else{if(l.car(e)===se.symbol(l.BINOMIAL)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=_U(e),n;if(l.car(e)===se.symbol(l.DEFINT)&&l.defs.printMode===l.PRINTMODE_LATEX)return n+=IU(e),n;if(l.isinnerordot(e)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=bU(e),n;if(l.defs.codeGen)return n+=gU(e),n}else if(l.car(e)===se.symbol(l.SIN)){if(l.defs.codeGen)return n+=yU(e),n}else if(l.car(e)===se.symbol(l.COS)){if(l.defs.codeGen)return n+=vU(e),n}else if(l.car(e)===se.symbol(l.TAN)){if(l.defs.codeGen)return n+=qU(e),n}else if(l.car(e)===se.symbol(l.ARCSIN)){if(l.defs.codeGen)return n+=EU(e),n}else if(l.car(e)===se.symbol(l.ARCCOS)){if(l.defs.codeGen)return n+=xU(e),n}else if(l.car(e)===se.symbol(l.ARCTAN)){if(l.defs.codeGen)return n+=pU(e),n}else if(l.car(e)===se.symbol(l.SUM)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=RU(e),n;if(l.defs.codeGen)return n+=LU(e),n}else if(l.car(e)===se.symbol(l.PRODUCT)){if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=zU(e),n;if(l.defs.codeGen)return n+=YU(e),n}else if(l.car(e)===se.symbol(l.FOR)){if(l.defs.codeGen)return n+=GU(e),n}else if(l.car(e)===se.symbol(l.DO)){if(l.defs.codeGen)return n+=FU(e),n}else if(l.car(e)===se.symbol(l.TEST)){if(l.defs.codeGen)return n+=PU(e),n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=CU(e),n}else if(l.car(e)===se.symbol(l.TESTLT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") < ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=DU(e),n}else if(l.car(e)===se.symbol(l.TESTLE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") <= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=kU(e),n}else if(l.car(e)===se.symbol(l.TESTGT)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") > ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=UU(e),n}else if(l.car(e)===se.symbol(l.TESTGE)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") >= ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=$U(e),n}else if(l.car(e)===se.symbol(l.TESTEQ)){if(l.defs.codeGen)return n+="(("+C(l.cadr(e))+") === ("+C(l.caddr(e))+"))",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=BU(e),n}else if(l.car(e)===se.symbol(l.FLOOR)){if(l.defs.codeGen)return n+="Math.floor("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lfloor {"+C(l.cadr(e))+"} \\rfloor ",n}else if(l.car(e)===se.symbol(l.CEILING)){if(l.defs.codeGen)return n+="Math.ceiling("+C(l.cadr(e))+")",n;if(l.defs.printMode===l.PRINTMODE_LATEX)return n+=" \\lceil {"+C(l.cadr(e))+"} \\rceil ",n}else if(l.car(e)===se.symbol(l.ROUND)){if(l.defs.codeGen)return n+="Math.round("+C(l.cadr(e))+")",n}else if(l.car(e)===se.symbol(l.SETQ))return l.defs.codeGen?(n+=jU(e),n):(n+=C(l.cadr(e)),n+=S("="),n+=C(l.caddr(e)),n)}if(l.iscons(e)){if(n+=En(l.car(e)),e=l.cdr(e),t||(n+=S("(")),l.iscons(e))for(n+=C(l.car(e)),e=l.cdr(e);l.iscons(e);)n+=S(","),n+=C(l.car(e)),e=l.cdr(e);return t||(n+=S(")")),n}return e===se.symbol(l.DERIVATIVE)?n+=zr("d"):e===se.symbol(l.E)?l.defs.codeGen?n+=S("Math.E"):n+=S("e"):e===se.symbol(l.PI)?l.defs.printMode===l.PRINTMODE_LATEX?n+=S("\\pi"):n+=S("pi"):n+=S(se.get_printname(e)),n}function Xa(e){let t="";switch(e.k){case l.CONS:for(t+="(",t+=Xa(l.car(e)),e===l.cdr(e)&&(console.log("oh no recursive!"),l.breakpoint),e=l.cdr(e);l.iscons(e);)t+=" ",t+=Xa(l.car(e)),e=l.cdr(e),e===l.cdr(e)&&e!==se.symbol(l.NIL)&&(console.log("oh no recursive!"),l.breakpoint);e!==se.symbol(l.NIL)&&(t+=" . ",t+=Xa(e)),t+=")";break;case l.STR:t+=e.str;break;case l.NUM:case l.DOUBLE:t+=xf.print_number(e,!0);break;case l.SYM:t+=se.get_printname(e);break;default:t+="<tensor>"}return t}Ot.print_list=Xa;function Bb(){let e="";return l.defs.printMode===l.PRINTMODE_LATEX||(l.defs.printMode===l.PRINTMODE_HUMAN&&!l.defs.test_flag&&!l.defs.codeGen?e+=S(" "):e+=S("*")),e}function hf(e){return l.ispower(e)&&l.cadr(e)!==se.symbol(l.E)&&At.isnegativeterm(l.caddr(e))}function VU(e){for(e=l.cdr(e);l.iscons(e);){let t=l.car(e);if(hf(t))return!0;e=l.cdr(e)}return!1}});var N=A(a=>{"use strict";var XU=a&&a.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0});a.evalFloats=a.evalPolar=a.doexpand=a.noexpand=a.Constants=a.$=a.reset_after_error=a.MEQUAL=a.MZERO=a.MSIGN=a.isidentitymatrix=a.isinv=a.istranspose=a.isinnerordot=a.isfactorial=a.ispower=a.ismultiply=a.isadd=a.caddaddr=a.cdddaddr=a.caddadr=a.cddaddr=a.cadaddr=a.caddddr=a.cddddr=a.cadddr=a.cdaddr=a.caddar=a.cadadr=a.caaddr=a.cdddr=a.cddar=a.cdadr=a.cadar=a.caddr=a.caadr=a.cddr=a.cdar=a.cadr=a.caar=a.cdr=a.car=a.issymbol=a.isNumericAtomOrTensor=a.istensor=a.isstr=a.isNumericAtom=a.isdouble=a.isrational=a.iscons=a.dotprod_unicode=a.transpose_unicode=a.logbuf=a.mtotal=a.primetab=a.parse_time_simplifications=a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=a.MAXDIM=a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=a.MAXPRIMETAB=a.E=a.C6=a.C5=a.C4=a.C3=a.C2=a.C1=a.SYMBOL_X_UNDERSCORE=a.SYMBOL_B_UNDERSCORE=a.SYMBOL_A_UNDERSCORE=a.SYMBOL_IDENTITY_MATRIX=a.SYMBOL_Z=a.SYMBOL_Y=a.SYMBOL_X=a.SYMBOL_T=a.SYMBOL_S=a.SYMBOL_R=a.SYMBOL_N=a.SYMBOL_J=a.SYMBOL_I=a.SYMBOL_D=a.SYMBOL_C=a.SYMBOL_B=a.SYMBOL_A=a.PI=a.VERSION=a.SECRETX=a.METAX=a.METAB=a.METAA=a.DRAWX=a.YYE=a.MAX_FIXED_PRINTOUT_DIGITS=a.FORCE_FIXED_PRINTOUT=a.TRACE=a.ASSUME_REAL_VARIABLES=a.BAKE=a.AUTOEXPAND=a.LAST_PLAIN_PRINT=a.LAST_LIST_PRINT=a.LAST_LATEX_PRINT=a.LAST_FULL_PRINT=a.LAST_2DASCII_PRINT=a.LAST_PRINT=a.LAST=a.NIL=a.ZERO=a.UNIT=a.TRANSPOSE=a.TESTLT=a.TESTLE=a.TESTGT=a.TESTGE=a.TESTEQ=a.TEST=a.TAYLOR=a.TANH=a.TAN=a.SYMBOLSINFO=a.SUM=a.SUBST=a.STOP=a.SQRT=a.SHAPE=a.SINH=a.SIN=a.SIMPLIFY=a.SILENTPATTERN=a.SGN=a.SETQ=a.ROOTS=a.YYRECT=a.ROUND=a.REAL=a.RATIONALIZE=a.RANK=a.QUOTIENT=a.QUOTE=a.PRODUCT=a.PRINTPLAIN=a.PRINTLIST=a.PRINTLATEX=a.PRINTFULL=a.PRINT2DASCII=a.PRINT=a.PRINT_LEAVE_X_ALONE=a.PRINT_LEAVE_E_ALONE=a.PRIME=a.POWER=a.POLAR=a.PATTERNSINFO=a.PATTERN=a.OUTER=a.OR=a.OPERATOR=a.NUMERATOR=a.NUMBER=a.NROOTS=a.NOT=a.MULTIPLY=a.MOD=a.LOOKUP=a.LOG=a.LEGENDRE=a.LEADING=a.LCM=a.LAGUERRE=a.ISPRIME=a.ISINTEGER=a.INVG=a.INV=a.INTEGRAL=a.INNER=a.INDEX=a.IMAG=a.HILBERT=a.HERMITE=a.GCD=a.GAMMA=a.FUNCTION=a.FOR=a.FLOOR=a.FLOATF=a.FILTER=a.FACTORPOLY=a.FACTORIAL=a.FACTOR=a.EXPSIN=a.EXPCOS=a.EXPAND=a.EXP=a.EVAL=a.ERFC=a.ERF=a.EIGENVEC=a.EIGENVAL=a.EIGEN=a.DSOLVE=a.DRAW=a.DOT=a.DO=a.DIVISORS=a.DIRAC=a.DIM=a.DET=a.DERIVATIVE=a.DENOMINATOR=a.DEGREE=a.DEFINT=a.DECOMP=a.COSH=a.COS=a.CONTRACT=a.CONJ=a.CONDENSE=a.COFACTOR=a.COEFF=a.CLOCK=a.CLEARPATTERNS=a.CLEARALL=a.CLEAR=a.CIRCEXP=a.CHOOSE=a.CHECK=a.CEILING=a.BINOMIAL=a.BINDING=a.BESSELY=a.BESSELJ=a.ATOMIZE=a.ARG=a.ARCTANH=a.ARCTAN=a.ARCSINH=a.ARCSIN=a.ARCCOSH=a.ARCCOS=a.APPROXRATIO=a.AND=a.ADJ=a.ADD=a.ABS=a.SYM=a.TENSOR=a.STR=a.DOUBLE=a.NUM=a.CONS=a.Sym=a.Tensor=a.Str=a.Double=a.Num=a.Cons=a.BaseAtom=a.avoidCalculatingPowersIntoArctans=a.do_simplify_nested_radicals=a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=a.defs=a.PRINTMODE_LIST=a.PRINTMODE_HUMAN=a.PRINTMODE_COMPUTER=a.PRINTMODE_2DASCII=a.PRINTMODE_LATEX=a.PRINTOUTRESULT=a.DEBUG=a.NSYM=a.version=a.breakpoint=void 0;var Af=XU(Mi()),Tx=ti(),Yr=$();function Nx(){}a.breakpoint=Nx;a.version="1.3.1";a.NSYM=1e3;a.DEBUG=!1;a.PRINTOUTRESULT=!1;a.PRINTMODE_LATEX="PRINTMODE_LATEX";a.PRINTMODE_2DASCII="PRINTMODE_2DASCII";a.PRINTMODE_COMPUTER="PRINTMODE_COMPUTER";a.PRINTMODE_HUMAN="PRINTMODE_HUMAN";a.PRINTMODE_LIST="PRINTMODE_LIST";var Ix=class{constructor(){this.printMode=a.PRINTMODE_COMPUTER,this.recursionLevelNestedRadicalsRemoval=0,this.errorMessage="",this.symbolsDependencies={},this.symbolsHavingReassignments=[],this.symbolsInExpressionsWithoutAssignments=[],this.patternHasBeenFound=!1,this.inited=!1,this.chainOfUserSymbolsNotFunctionsBeingEvaluated=[],this.stringsEmittedByUserPrintouts="",this.called_from_Algebra_block=!1,this.expanding=!1,this.evaluatingAsFloats=!1,this.evaluatingPolar=!1,this.esc_flag=!1,this.trigmode=0,this.out_count=0,this.test_flag=!1,this.codeGen=!1,this.userSimplificationsInListForm=[],this.userSimplificationsInStringForm=[],this.fullDoubleOutput=!1}};a.defs=new Ix;a.dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0;a.do_simplify_nested_radicals=!0;a.avoidCalculatingPowersIntoArctans=!0;var lo=class{toString(){return Tx.print_expr(this)}toLatexString(){return Tx.collectLatexStringFromReturnValue(this)}};a.BaseAtom=lo;var Of=class extends lo{constructor(t,r){super();this.k=a.CONS,this.cons={car:t,cdr:r}}*[Symbol.iterator](){let t=this;for(;Qa(t);)yield Ce(t),t=ae(t)}tail(){return Qa(this.cons.cdr)?[...this.cons.cdr]:[]}map(t){let r=Ce(this),n=ae(this);return Qa(n)&&(n=n.map(t)),new Of(t(r),n)}};a.Cons=Of;var vu=class extends lo{constructor(t,r=Af.default.one){super();this.a=t,this.b=r,this.q=this,this.k=a.NUM}};a.Num=vu;var Ha=class extends lo{constructor(t){super();this.d=t,this.k=a.DOUBLE}};a.Double=Ha;var Sx=class extends lo{constructor(t){super();this.str=t,this.k=a.STR}};a.Str=Sx;var wx=class extends lo{constructor(){super(...arguments);this.tensor=this,this.k=a.TENSOR,this.ndim=0,this.dim=[],this.elem=[]}get nelem(){return this.elem.length}};a.Tensor=wx;var Rx=class extends lo{constructor(t){super();this.printname=t,this.k=a.SYM}};a.Sym=Rx;a.CONS=0;a.NUM=1;a.DOUBLE=2;a.STR=3;a.TENSOR=4;a.SYM=5;a.ABS="abs";a.ADD="add";a.ADJ="adj";a.AND="and";a.APPROXRATIO="approxratio";a.ARCCOS="arccos";a.ARCCOSH="arccosh";a.ARCSIN="arcsin";a.ARCSINH="arcsinh";a.ARCTAN="arctan";a.ARCTANH="arctanh";a.ARG="arg";a.ATOMIZE="atomize";a.BESSELJ="besselj";a.BESSELY="bessely";a.BINDING="binding";a.BINOMIAL="binomial";a.CEILING="ceiling";a.CHECK="check";a.CHOOSE="choose";a.CIRCEXP="circexp";a.CLEAR="clear";a.CLEARALL="clearall";a.CLEARPATTERNS="clearpatterns";a.CLOCK="clock";a.COEFF="coeff";a.COFACTOR="cofactor";a.CONDENSE="condense";a.CONJ="conj";a.CONTRACT="contract";a.COS="cos";a.COSH="cosh";a.DECOMP="decomp";a.DEFINT="defint";a.DEGREE="deg";a.DENOMINATOR="denominator";a.DERIVATIVE="derivative";a.DET="det";a.DIM="dim";a.DIRAC="dirac";a.DIVISORS="divisors";a.DO="do";a.DOT="dot";a.DRAW="draw";a.DSOLVE="dsolve";a.EIGEN="eigen";a.EIGENVAL="eigenval";a.EIGENVEC="eigenvec";a.ERF="erf";a.ERFC="erfc";a.EVAL="eval";a.EXP="exp";a.EXPAND="expand";a.EXPCOS="expcos";a.EXPSIN="expsin";a.FACTOR="factor";a.FACTORIAL="factorial";a.FACTORPOLY="factorpoly";a.FILTER="filter";a.FLOATF="float";a.FLOOR="floor";a.FOR="for";a.FUNCTION="function";a.GAMMA="Gamma";a.GCD="gcd";a.HERMITE="hermite";a.HILBERT="hilbert";a.IMAG="imag";a.INDEX="component";a.INNER="inner";a.INTEGRAL="integral";a.INV="inv";a.INVG="invg";a.ISINTEGER="isinteger";a.ISPRIME="isprime";a.LAGUERRE="laguerre";a.LCM="lcm";a.LEADING="leading";a.LEGENDRE="legendre";a.LOG="log";a.LOOKUP="lookup";a.MOD="mod";a.MULTIPLY="multiply";a.NOT="not";a.NROOTS="nroots";a.NUMBER="number";a.NUMERATOR="numerator";a.OPERATOR="operator";a.OR="or";a.OUTER="outer";a.PATTERN="pattern";a.PATTERNSINFO="patternsinfo";a.POLAR="polar";a.POWER="power";a.PRIME="prime";a.PRINT_LEAVE_E_ALONE="printLeaveEAlone";a.PRINT_LEAVE_X_ALONE="printLeaveXAlone";a.PRINT="print";a.PRINT2DASCII="print2dascii";a.PRINTFULL="printcomputer";a.PRINTLATEX="printlatex";a.PRINTLIST="printlist";a.PRINTPLAIN="printhuman";a.PRODUCT="product";a.QUOTE="quote";a.QUOTIENT="quotient";a.RANK="rank";a.RATIONALIZE="rationalize";a.REAL="real";a.ROUND="round";a.YYRECT="rect";a.ROOTS="roots";a.SETQ="equals";a.SGN="sgn";a.SILENTPATTERN="silentpattern";a.SIMPLIFY="simplify";a.SIN="sin";a.SINH="sinh";a.SHAPE="shape";a.SQRT="sqrt";a.STOP="stop";a.SUBST="subst";a.SUM="sum";a.SYMBOLSINFO="symbolsinfo";a.TAN="tan";a.TANH="tanh";a.TAYLOR="taylor";a.TEST="test";a.TESTEQ="testeq";a.TESTGE="testge";a.TESTGT="testgt";a.TESTLE="testle";a.TESTLT="testlt";a.TRANSPOSE="transpose";a.UNIT="unit";a.ZERO="zero";a.NIL="nil";a.LAST="last";a.LAST_PRINT="lastprint";a.LAST_2DASCII_PRINT="last2dasciiprint";a.LAST_FULL_PRINT="lastfullprint";a.LAST_LATEX_PRINT="lastlatexprint";a.LAST_LIST_PRINT="lastlistprint";a.LAST_PLAIN_PRINT="lastplainprint";a.AUTOEXPAND="autoexpand";a.BAKE="bake";a.ASSUME_REAL_VARIABLES="assumeRealVariables";a.TRACE="trace";a.FORCE_FIXED_PRINTOUT="forceFixedPrintout";a.MAX_FIXED_PRINTOUT_DIGITS="maxFixedPrintoutDigits";a.YYE="~";a.DRAWX="$DRAWX";a.METAA="$METAA";a.METAB="$METAB";a.METAX="$METAX";a.SECRETX="$SECRETX";a.VERSION="version";a.PI="pi";a.SYMBOL_A="a";a.SYMBOL_B="b";a.SYMBOL_C="c";a.SYMBOL_D="d";a.SYMBOL_I="i";a.SYMBOL_J="j";a.SYMBOL_N="n";a.SYMBOL_R="r";a.SYMBOL_S="s";a.SYMBOL_T="t";a.SYMBOL_X="x";a.SYMBOL_Y="y";a.SYMBOL_Z="z";a.SYMBOL_IDENTITY_MATRIX="I";a.SYMBOL_A_UNDERSCORE="a_";a.SYMBOL_B_UNDERSCORE="b_";a.SYMBOL_X_UNDERSCORE="x_";a.C1="$C1";a.C2="$C2";a.C3="$C3";a.C4="$C4";a.C5="$C5";a.C6="$C6";a.E=a.YYE;a.MAXPRIMETAB=1e4;a.MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5;a.MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10;a.MAXDIM=24;a.predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"];a.parse_time_simplifications=!0;a.primetab=function(){let e=[2],t=3;for(;e.length<a.MAXPRIMETAB;){let r=0,n=Math.sqrt(t);for(;r<e.length&&e[r]<=n;){if(t%e[r]==0){r=-1;break}r++}r!==-1&&e.push(t),t+=2}return e[a.MAXPRIMETAB]=0,e}();var HU=!1;a.mtotal=0;a.logbuf="";a.transpose_unicode=7488;a.dotprod_unicode=183;function Qa(e){return e.k===a.CONS}a.iscons=Qa;function Lx(e){return e.k===a.NUM}a.isrational=Lx;function Cx(e){return e.k===a.DOUBLE}a.isdouble=Cx;function Px(e){return Lx(e)||Cx(e)}a.isNumericAtom=Px;function QU(e){return e.k===a.STR}a.isstr=QU;function Dx(e){return e.k===a.TENSOR}a.istensor=Dx;function kx(e){if(Px(e)||e===Yr.symbol(a.SYMBOL_IDENTITY_MATRIX))return!0;if(!Dx(e))return!1;let t=e.tensor.nelem,r=e.tensor.elem;for(let n=0;n<t;n++)if(!kx(r[n]))return!1;return!0}a.isNumericAtomOrTensor=kx;function WU(e){return e.k===a.SYM}a.issymbol=WU;function Ce(e){return Qa(e)?e.cons.car:Yr.symbol(a.NIL)}a.car=Ce;function ae(e){return Qa(e)?e.cons.cdr:Yr.symbol(a.NIL)}a.cdr=ae;function JU(e){return Ce(Ce(e))}a.caar=JU;function KU(e){return Ce(ae(e))}a.cadr=KU;function e$(e){return ae(Ce(e))}a.cdar=e$;function t$(e){return ae(ae(e))}a.cddr=t$;function r$(e){return Ce(Ce(ae(e)))}a.caadr=r$;function n$(e){return Ce(ae(ae(e)))}a.caddr=n$;function i$(e){return Ce(ae(Ce(e)))}a.cadar=i$;function o$(e){return ae(Ce(ae(e)))}a.cdadr=o$;function s$(e){return ae(ae(Ce(e)))}a.cddar=s$;function a$(e){return ae(ae(ae(e)))}a.cdddr=a$;function l$(e){return Ce(Ce(ae(ae(e))))}a.caaddr=l$;function u$(e){return Ce(ae(Ce(ae(e))))}a.cadadr=u$;function c$(e){return Ce(ae(ae(Ce(e))))}a.caddar=c$;function d$(e){return ae(Ce(ae(ae(e))))}a.cdaddr=d$;function f$(e){return Ce(ae(ae(ae(e))))}a.cadddr=f$;function m$(e){return ae(ae(ae(ae(e))))}a.cddddr=m$;function _$(e){return Ce(ae(ae(ae(ae(e)))))}a.caddddr=_$;function b$(e){return Ce(ae(Ce(ae(ae(e)))))}a.cadaddr=b$;function g$(e){return ae(ae(Ce(ae(ae(e)))))}a.cddaddr=g$;function y$(e){return Ce(ae(ae(Ce(ae(e)))))}a.caddadr=y$;function v$(e){return ae(ae(ae(Ce(ae(ae(e))))))}a.cdddaddr=v$;function q$(e){return Ce(ae(ae(Ce(ae(ae(e))))))}a.caddaddr=q$;function E$(e){return Ce(e)===Yr.symbol(a.ADD)}a.isadd=E$;function x$(e){return Ce(e)===Yr.symbol(a.MULTIPLY)}a.ismultiply=x$;function p$(e){return Ce(e)===Yr.symbol(a.POWER)}a.ispower=p$;function h$(e){return Ce(e)===Yr.symbol(a.FACTORIAL)}a.isfactorial=h$;function A$(e){return Ce(e)===Yr.symbol(a.INNER)||Ce(e)===Yr.symbol(a.DOT)}a.isinnerordot=A$;function O$(e){return Ce(e)===Yr.symbol(a.TRANSPOSE)}a.istranspose=O$;function M$(e){return Ce(e)===Yr.symbol(a.INV)}a.isinv=M$;function T$(e){return e===Yr.symbol(a.SYMBOL_IDENTITY_MATRIX)}a.isidentitymatrix=T$;function N$(e){return e.isPositive()?1:e.isZero()?0:-1}a.MSIGN=N$;function I$(e){return e.isZero()}a.MZERO=I$;function S$(e,t){return e==null,e.equals(t)}a.MEQUAL=S$;function w$(){a.defs.esc_flag=!1,HU=!1,a.defs.evaluatingAsFloats=!1,a.defs.evaluatingPolar=!1}a.reset_after_error=w$;a.$={};var mr=class{static One(){return a.defs.evaluatingAsFloats?mr.oneAsDouble:mr.one}static NegOne(){return a.defs.evaluatingAsFloats?mr.negOneAsDouble:mr.negOne}static Zero(){return a.defs.evaluatingAsFloats?mr.zeroAsDouble:mr.zero}static Pi(){return a.defs.evaluatingAsFloats?mr.piAsDouble:Yr.symbol(a.PI)}};a.Constants=mr;mr.one=new vu(Af.default(1));mr.oneAsDouble=new Ha(1);mr.negOne=new vu(Af.default(-1));mr.negOneAsDouble=new Ha(-1);mr.zero=new vu(Af.default(0));mr.zeroAsDouble=new Ha(0);mr.piAsDouble=new Ha(Math.PI);function R$(e,...t){let r=a.defs.expanding;a.defs.expanding=!1;try{return e(...t)}finally{a.defs.expanding=r}}a.noexpand=R$;function L$(e,...t){let r=a.defs.expanding;a.defs.expanding=!0;try{return e(...t)}finally{a.defs.expanding=r}}a.doexpand=L$;function C$(e,...t){let r=a.defs.evaluatingPolar;a.defs.evaluatingPolar=!0;try{return e(...t)}finally{a.defs.evaluatingPolar=r}}a.evalPolar=C$;function P$(e,...t){let r=a.defs.evaluatingAsFloats;a.defs.evaluatingAsFloats=!0;try{return e(...t)}finally{a.defs.evaluatingAsFloats=r}}a.evalFloats=P$});var Bx=A(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.exec=Wa.parse=void 0;var Mf=Ee(),Ux=j(),D$=ee(),k$=zi(),qu=N(),U$=su(),Gb=$();qu.defs.inited||(qu.defs.inited=!0,U$.init());function $x(e){if(typeof e=="string"){let[,t]=k$.scan(e);return t}else return typeof e=="number"?e%1==0?Ux.integer(e):Ux.double(e):typeof e.k=="number"?e:(console.warn("unknown argument type",e),Gb.symbol(qu.NIL))}function $$(e){let t;try{t=$x(e),Mf.check_stack()}catch(r){throw qu.reset_after_error(),r}return t}Wa.parse=$$;function B$(e,...t){let r,n=Gb.get_binding(Gb.usr_symbol(e));Mf.check_stack();let i=D$.makeList(n,...t.map($x));try{r=Mf.top_level_eval(i),Mf.check_stack()}catch(o){throw qu.reset_after_error(),o}return r}Wa.exec=B$});var Fx=A(Nf=>{"use strict";Object.defineProperty(Nf,"__esModule",{value:!0});var Ne=N(),G$=or(),F$=su(),Ja=$(),Fb=Bx(),Ct=Q(),Gx=Ie(),j$=zi(),Tf=U_(),z$=Gl(),Y$=Ee(),F={};F.version=Ne.version;F.isadd=Ne.isadd;F.ismultiply=Ne.ismultiply;F.ispower=Ne.ispower;F.isfactorial=Ne.isfactorial;F.car=Ne.car;F.cdr=Ne.cdr;F.caar=Ne.caar;F.cadr=Ne.cadr;F.cdar=Ne.cdar;F.cddr=Ne.cddr;F.caadr=Ne.caadr;F.caddr=Ne.caddr;F.cadar=Ne.cadar;F.cdadr=Ne.cdadr;F.cddar=Ne.cddar;F.cdddr=Ne.cdddr;F.caaddr=Ne.caaddr;F.cadadr=Ne.cadadr;F.caddar=Ne.caddar;F.cdaddr=Ne.cdaddr;F.cadddr=Ne.cadddr;F.cddddr=Ne.cddddr;F.caddddr=Ne.caddddr;F.cadaddr=Ne.cadaddr;F.cddaddr=Ne.cddaddr;F.caddadr=Ne.caddadr;F.cdddaddr=Ne.cdddaddr;F.caddaddr=Ne.caddaddr;F.symbol=Ja.symbol;F.iscons=Ne.iscons;F.isrational=Ne.isrational;F.isdouble=Ne.isdouble;F.isNumericAtom=Ne.isNumericAtom;F.isstr=Ne.isstr;F.istensor=Ne.istensor;F.issymbol=Ne.issymbol;F.iskeyword=Ja.iskeyword;F.CONS=Ne.CONS;F.NUM=Ne.NUM;F.DOUBLE=Ne.DOUBLE;F.STR=Ne.STR;F.TENSOR=Ne.TENSOR;F.SYM=Ne.SYM;F.approxRadicals=Tf.approxRadicals;F.approxRationalsOfLogs=Tf.approxRationalsOfLogs;F.approxAll=Tf.approxAll;F.testApprox=Tf.testApprox;F.make_hashed_itab=z$.make_hashed_itab;F.isZeroAtomOrTensor=Ct.isZeroAtomOrTensor;F.isnegativenumber=Ct.isnegativenumber;F.isplusone=Ct.isplusone;F.isminusone=Ct.isminusone;F.isinteger=Ct.isinteger;F.isnonnegativeinteger=Ct.isnonnegativeinteger;F.isposint=Ct.isposint;F.isnegativeterm=Ct.isnegativeterm;F.isimaginarynumber=Ct.isimaginarynumber;F.iscomplexnumber=Ct.iscomplexnumber;F.iseveninteger=Ct.iseveninteger;F.isnegative=Ct.isnegative;F.issymbolic=Ct.issymbolic;F.isintegerfactor=Ct.isintegerfactor;F.isoneover=Ct.isoneover;F.isfraction=Ct.isfraction;F.isoneoversqrttwo=Ct.isoneoversqrttwo;F.isminusoneoversqrttwo=Ct.isminusoneoversqrttwo;F.isfloating=Ct.isfloating;F.isimaginaryunit=Ct.isimaginaryunit;F.isquarterturn=Ct.isquarterturn;F.isnpi=Ct.isnpi;F.equal=Gx.equal;F.length=Gx.length;F.scan=j$.scan;F.Find=G$.Find;F.get_binding=Ja.get_binding;F.set_binding=Ja.set_binding;F.usr_symbol=Ja.usr_symbol;F.collectUserSymbols=Ja.collectUserSymbols;F.init=F$.init;F.exec=Fb.exec;F.parse=Fb.parse;F.run=Y$.run;var Z$=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"];Array.from(Z$).map(e=>F[e]=Fb.exec.bind(Nf,e));Nf.default=F});var jx=r0(Fx());globalThis.Algebrite=jx.default;})();
//# sourceMappingURL=algebrite.bundle-for-browser-min.js.map
